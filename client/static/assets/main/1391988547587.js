if(!this.JSON){JSON=function(){function f(n){return n<10?'0'+n:n;}
Date.prototype.toJSON=function(){return this.getUTCFullYear()+'-'+
f(this.getUTCMonth()+1)+'-'+
f(this.getUTCDate())+'T'+
f(this.getUTCHours())+':'+
f(this.getUTCMinutes())+':'+
f(this.getUTCSeconds())+'Z';};var m={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'};function stringify(value,whitelist){var a,i,k,l,r=/["\\\x00-\x1f\x7f-\x9f]/g,v;switch(typeof value){case'string':return r.test(value)?'"'+value.replace(r,function(a){var c=m[a];if(c){return c;}
c=a.charCodeAt();return'\\u00'+Math.floor(c/16).toString(16)+
(c%16).toString(16);})+'"':'"'+value+'"';case'number':return isFinite(value)?String(value):'null';case'boolean':case'null':return String(value);case'object':if(!value){return'null';}
if(typeof value.toJSON==='function'){return stringify(value.toJSON());}
a=[];if(typeof value.length==='number'&&!(value.propertyIsEnumerable('length'))){l=value.length;for(i=0;i<l;i+=1){a.push(stringify(value[i],whitelist)||'null');}
return'['+a.join(',')+']';} 
if(whitelist){l=whitelist.length;for(i=0;i<l;i+=1){k=whitelist[i];if(typeof k==='string'){v=stringify(value[k],whitelist);if(v){a.push(stringify(k)+':'+v);}}}}else{for(k in value){if(typeof k==='string'){v=stringify(value[k],whitelist);if(v){a.push(stringify(k)+':'+v);}}}}
return'{'+a.join(',')+'}';}}
return{stringify:stringify,parse:function(text,filter){var j;function walk(k,v){var i,n;if(v&&typeof v==='object'){for(i in v){if(Object.prototype.hasOwnProperty.apply(v,[i])){n=walk(i,v[i]);if(n!==undefined){v[i]=n;}}}}
return filter(k,v);}
if(/^[\],:{}\s]*$/.test(text.replace(/\\./g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,''))){j=eval('('+text+')');return typeof filter==='function'?walk('',j):j;}
throw new SyntaxError('parseJSON');}};}();}
window.require=function(e,t){var n=require.resolve(e,t||"/"),r=require.modules[n];if(!r)throw new Error("Failed to resolve module "+e+", tried "+n);var i=r._cached?r._cached:r();return i},require.paths=[],require.modules={},require.extensions=[".js",".coffee",".ls"],require._core={assert:!0,events:!0,fs:!0,path:!0,vm:!0},require.resolve=function(){return function(e,t){function o(e){if(require.modules[e])return e;for(var t=0;t<require.extensions.length;t++){var n=require.extensions[t];if(require.modules[e+n])return e+n}}function u(e){return e=e.replace(/\/+$/,""),o(e+"/index")}function a(e,t){var n=f(t);for(var r=0;r<n.length;r++){var i=n[r],s=o(i+"/"+e);if(s)return s;var a=u(i+"/"+e);if(a)return a}var s=o(e);if(s)return s}function f(e){var t;e==="/"?t=[""]:t=n.normalize(e).split("/");var r=[];for(var i=t.length-1;i>=0;i--){if(t[i]==="node_modules")continue;var s=t.slice(0,i+1).join("/")+"/node_modules";r.push(s)}return r}t||(t="/");if(require._core[e])return e;var n=require.modules.path();t=n.resolve("/",t);var r=t||"/";if(e.match(/^(?:\.\.?\/|\/)/)){var i=o(n.resolve(r,e))||u(n.resolve(r,e));if(i)return i}var s=a(e,r);if(s)return s;throw new Error("Cannot find module '"+e+"'")}}(),require.alias=function(e,t){var n=require.modules.path(),r=null;try{r=require.resolve(e+"/package.json","/")}catch(i){r=require.resolve(e,"/")}var s=n.dirname(r),o=(Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t})(require.modules);for(var u=0;u<o.length;u++){var a=o[u];if(a.slice(0,s.length+1)===s+"/"){var f=a.slice(s.length);require.modules[t+f]=require.modules[s+f]}else a===s&&(require.modules[t]=require.modules[s])}},require.define=function(e,t){var n=require._core[e]?"":require.modules.path().dirname(e),r=function(e){return require(e,n)};r.resolve=function(e){return require.resolve(e,n)},r.modules=require.modules,r.define=require.define;var i={exports:{}};require.modules[e]=function(){return require.modules[e]._cached=i.exports,t.call(i.exports,r,i,i.exports,n,e),require.modules[e]._cached=i.exports,i.exports}},typeof process=="undefined"&&(process={}),process.nextTick||(process.nextTick=function(){var e=[],t=typeof window!="undefined"&&window.postMessage&&window.addEventListener;return t&&window.addEventListener("message",function(t){if(t.source===window&&t.data==="browserify-tick"){t.stopPropagation();if(e.length>0){var n=e.shift();n()}}},!0),function(n){t?(e.push(n),window.postMessage("browserify-tick","*")):setTimeout(n,0)}}()),process.title||(process.title="browser"),process.binding||(process.binding=function(e){if(e==="evals")return require("vm");throw new Error("No such module")}),process.cwd||(process.cwd=function(){return"."}),require.define("path",function(e,t,n,r,i){function s(e,t){var n=[];for(var r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}function o(e,t){var n=0;for(var r=e.length;r>=0;r--){var i=e[r];i=="."?e.splice(r,1):i===".."?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}var u=/^(.+\/(?!$)|\/)?((?:.+?)?(\.[^.]*)?)$/;n.resolve=function(){var e="",t=!1;for(var n=arguments.length;n>=-1&&!t;n--){var r=n>=0?arguments[n]:process.cwd();if(typeof r!="string"||!r)continue;e=r+"/"+e,t=r.charAt(0)==="/"}return e=o(s(e.split("/"),function(e){return!!e}),!t).join("/"),(t?"/":"")+e||"."},n.normalize=function(e){var t=e.charAt(0)==="/",n=e.slice(-1)==="/";return e=o(s(e.split("/"),function(e){return!!e}),!t).join("/"),!e&&!t&&(e="."),e&&n&&(e+="/"),(t?"/":"")+e},n.join=function(){var e=Array.prototype.slice.call(arguments,0);return n.normalize(s(e,function(e,t){return e&&typeof e=="string"}).join("/"))},n.dirname=function(e){var t=u.exec(e)[1]||"",n=!1;return t?t.length===1||n&&t.length<=3&&t.charAt(1)===":"?t:t.substring(0,t.length-1):"."},n.basename=function(e,t){var n=u.exec(e)[2]||"";return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},n.extname=function(e){return u.exec(e)[3]||""}});
!function(e){"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define(e):"undefined"!=typeof window?window.jade=e():"undefined"!=typeof global?global.jade=e():"undefined"!=typeof self&&(self.jade=e())}(function(){var e,t,n;return function r(e,t,n){function i(o,u){if(!t[o]){if(!e[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(s)return s(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=t[o]={exports:{}};e[o][0].call(f.exports,function(t){var n=e[o][1][t];return i(n?n:t)},f,f.exports,r,e,t,n)}return t[o].exports}var s=typeof require=="function"&&require;for(var o=0;o<n.length;o++)i(n[o]);return i}({1:[function(e,t,n){"use strict";function r(e){return e!=null&&e!==""}function i(e){return Array.isArray(e)?e.map(i).filter(r).join(" "):e}n.merge=function s(e,t){if(arguments.length===1){var n=e[0];for(var i=1;i<e.length;i++)n=s(n,e[i]);return n}var o=e["class"],u=t["class"];if(o||u)o=o||[],u=u||[],Array.isArray(o)||(o=[o]),Array.isArray(u)||(u=[u]),e["class"]=o.concat(u).filter(r);for(var a in t)a!="class"&&(e[a]=t[a]);return e},n.joinClasses=i,n.cls=function(t,r){var s=[];for(var o=0;o<t.length;o++)r&&r[o]?s.push(n.escape(i([t[o]]))):s.push(i(t[o]));var u=i(s);return u.length?' class="'+u+'"':""},n.attr=function(t,r,i,s){return"boolean"==typeof r||null==r?r?" "+(s?t:t+'="'+t+'"'):"":0==t.indexOf("data")&&"string"!=typeof r?" "+t+"='"+JSON.stringify(r).replace(/'/g,"&apos;")+"'":i?" "+t+'="'+n.escape(r)+'"':" "+t+'="'+r+'"'},n.attrs=function(t,r){var s=[],o=Object.keys(t);if(o.length)for(var u=0;u<o.length;++u){var a=o[u],f=t[a];"class"==a?(f=i(f))&&s.push(" "+a+'="'+f+'"'):s.push(n.attr(a,f,!1,r))}return s.join("")},n.escape=function(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},n.rethrow=function o(t,n,r,i){if(t instanceof Error){if((typeof window!="undefined"||!n)&&!i)throw t.message+=" on line "+r,t;try{i=i||e("fs").readFileSync(n,"utf8")}catch(s){o(t,null,r)}var u=3,a=i.split("\n"),f=Math.max(r-u,0),l=Math.min(a.length,r+u),u=a.slice(f,l).map(function(e,t){var n=t+f+1;return(n==r?"  > ":"    ")+n+"| "+e}).join("\n");throw t.path=n,t.message=(n||"Jade")+":"+r+"\n"+u+"\n\n"+t.message,t}throw t}},{fs:2}],2:[function(e,t,n){},{}]},{},[1])(1)});
(function(){function t(){return t}function n(t,r){var i=n.resolve(t),s=n.modules[i];if(!s)throw new Error('failed to require "'+t+'" from '+r);return s.exports||(s.exports={},s.call(s.exports,s,s.exports,n.relative(i),e)),s.exports}var e=this;n.modules={},n.resolve=function(e){var t=e,r=e+".js",i=e+"/index.js";return n.modules[r]&&r||n.modules[i]&&i||t},n.register=function(e,t){n.modules[e]=t},n.relative=function(e){return function(r){if("debug"==r)return t;if("."!=r.charAt(0))return n(r);var i=e.split("/"),s=r.split("/");i.pop();for(var o=0;o<s.length;o++){var u=s[o];".."==u?i.pop():"."!=u&&i.push(u)}return n(i.join("/"),e)}},n.register("engine.io-client.js",function(e,t,n,r){t.version="0.3.10",t.protocol=1,t.util=n("./util"),t.parser=n("./parser"),t.Socket=n("./socket"),t.EventEmitter=n("./event-emitter"),t.Transport=n("./transport"),t.transports=n("./transports")}),n.register("event-emitter.js",function(e,t,n,r){function i(){}function s(e){return"[object Array]"==Object.prototype.toString.call(e)}e.exports=i,i.prototype.on=function(e,t){return this.$events||(this.$events={}),this.$events[e]?s(this.$events[e])?this.$events[e].push(t):this.$events[e]=[this.$events[e],t]:this.$events[e]=t,this},i.prototype.addListener=i.prototype.on,i.prototype.once=function(e,t){function r(){n.removeListener(e,r),t.apply(this,arguments)}var n=this;return r.listener=t,this.on(e,r),this},i.prototype.removeListener=function(e,t){if(this.$events&&this.$events[e]){var n=this.$events[e];if(s(n)){var r=-1;for(var i=0,o=n.length;i<o;i++)if(n[i]===t||n[i].listener&&n[i].listener===t){r=i;break}if(r<0)return this;n.splice(r,1),n.length||delete this.$events[e]}else(n===t||n.listener&&n.listener===t)&&delete this.$events[e]}return this},i.prototype.removeAllListeners=function(e){return e===undefined?(this.$events={},this):(this.$events&&this.$events[e]&&(this.$events[e]=null),this)},i.prototype.listeners=function(e){return this.$events||(this.$events={}),this.$events[e]||(this.$events[e]=[]),s(this.$events[e])||(this.$events[e]=[this.$events[e]]),this.$events[e]},i.prototype.emit=function(e){if(!this.$events)return!1;var t=this.$events[e];if(!t)return!1;var n=Array.prototype.slice.call(arguments,1);if("function"==typeof t)t.apply(this,n);else{if(!s(t))return!1;var r=t.slice();for(var i=0,o=r.length;i<o;i++)r[i].apply(this,n)}return!0},i.prototype.addEventListener=i.prototype.on,i.prototype.removeEventListener=i.prototype.removeListener,i.prototype.dispatchEvent=i.prototype.emit}),n.register("parser.js",function(e,t,n,r){var i=n("./util"),s=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},o=i.keys(s),u={type:"error",data:"parser error"};t.encodePacket=function(e){var t=s[e.type];return undefined!==e.data&&(t+=String(e.data)),""+t},t.decodePacket=function(e){var t=e.charAt(0);return isNaN(Number(t))||!o[t]?u:e.length>1?{type:o[t],data:e.substring(1)}:{type:o[t]}},t.encodePayload=function(e){if(!e.length)return"0:";var n="",r;for(var i=0,s=e.length;i<s;i++)r=t.encodePacket(e[i]),n+=r.length+":"+r;return n},t.decodePayload=function(e){if(e=="")return[u];var n=[],r="",i,s,o;for(var a=0,f=e.length;a<f;a++){var l=e.charAt(a);if(":"!=l)r+=l;else{if(""==r||r!=(i=Number(r)))return[u];s=e.substr(a+1,i);if(r!=s.length)return[u];if(s.length){o=t.decodePacket(s);if(u.type==o.type&&u.data==o.data)return[u];n.push(o)}a+=i,r=""}}return r!=""?[u]:n}}),n.register("socket.js",function(e,t,n,r){function a(e){if("string"==typeof e){var t=i.parseUri(e);e=arguments[1]||{},e.host=t.host,e.secure=t.protocol=="https"||t.protocol=="wss",e.port=t.port}e=e||{},this.secure=null!=e.secure?e.secure:r.location&&"https:"==location.protocol,this.host=e.host||e.hostname||(r.location?location.hostname:"localhost"),this.port=e.port||(r.location&&location.port?location.port:""),this.query=e.query||{},this.query.uid=l(),this.upgrade=!1!==e.upgrade,this.resource=e.resource||"default",this.path=(e.path||"/engine.io").replace(/\/$/,""),this.path+="/"+this.resource+"/",this.forceJSONP=!!e.forceJSONP,this.timestampParam=e.timestampParam||"t",this.timestampRequests=!!e.timestampRequests,this.flashPath=e.flashPath||"",this.transports=e.transports||["polling","websocket","flashsocket"],this.readyState="",this.writeBuffer=[],this.policyPort=e.policyPort||843,this.open(),a.sockets.push(this),a.sockets.evs.emit("add",this)}function f(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function l(){return String(Math.random()).substr(5)+String(Math.random()).substr(5)}var i=n("./util"),s=n("./transports"),o=n("debug")("engine-client:socket"),u=n("./event-emitter");e.exports=a,i.inherits(a,u),a.sockets=[],a.sockets.evs=new u,a.prototype.createTransport=function(e){o('creating transport "%s"',e);var t=f(this.query);t.transport=e,this.id&&(t.sid=this.id);var n=new s[e]({host:this.host,port:this.port,secure:this.secure,path:this.path,query:t,forceJSONP:this.forceJSONP,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,flashPath:this.flashPath,policyPort:this.policyPort});return n},a.prototype.open=function(){this.readyState="opening";var e=this.createTransport(this.transports[0]);e.open(),this.setTransport(e)},a.prototype.setTransport=function(e){var t=this;this.transport&&(o("clearing existing transport"),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.flush()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},a.prototype.probe=function(e){function i(i){if(n)return;n=!0;var s=new Error("probe error: "+i);s.transport=t.name,t.close(),t=null,o('probe transport "%s" failed because of error: %s',e,i),r.emit("error",s)}o('probing transport "%s"',e);var t=this.createTransport(e,{probe:1}),n=!1,r=this;t.once("open",function(){if(n)return;o('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",function(s){if(n)return;if("pong"==s.type&&"probe"==s.data)o('probe transport "%s" pong',e),r.upgrading=!0,r.emit("upgrading",t),o('pausing current transport "%s"',r.transport.name),r.transport.pause(function(){if(n)return;if("closed"==r.readyState||"closing"==r.readyState)return;o("changing transport and sending upgrade packet"),t.removeListener("error",i),r.emit("upgrade",t),r.setTransport(t),t.send([{type:"upgrade"}]),t=null,r.upgrading=!1,r.flush()});else{o('probe transport "%s" failed',e);var u=new Error("probe error");u.transport=t.name,r.emit("error",u)}})}),t.once("error",i),t.open(),this.once("close",function(){t&&(o("socket closed prematurely - aborting probe"),n=!0,t.close(),t=null)}),this.once("upgrading",function(e){t&&e.name!=t.name&&(o('"%s" works - aborting "%s"',e.name,t.name),t.close(),t=null)})},a.prototype.onOpen=function(){o("socket open"),this.readyState="open",this.emit("open"),this.onopen&&this.onopen.call(this),this.flush();if("open"==this.readyState&&this.upgrade&&this.transport.pause){o("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},a.prototype.onPacket=function(e){if("opening"==this.readyState||"open"==this.readyState){o('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat");switch(e.type){case"open":this.onHandshake(i.parseJSON(e.data));break;case"pong":this.ping();break;case"error":var t=new Error("server error");t.code=e.data,this.emit("error",t);break;case"message":this.emit("message",e.data);var n={data:e.data};n.toString=function(){return e.data},this.onmessage&&this.onmessage.call(this,n)}}else o('packet received with socket readyState "%s"',this.readyState)},a.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=e.upgrades,this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),this.ping(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat)},a.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){if("closed"==t.readyState)return;t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},a.prototype.ping=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){o("writing ping packet - expecting pong within %sms",e.pingTimeout),e.sendPacket("ping"),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},a.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(o("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.writeBuffer=[])},a.prototype.write=a.prototype.send=function(e){return this.sendPacket("message",e),this},a.prototype.sendPacket=function(e,t){var n={type:e,data:t};this.emit("packetCreate",n),this.writeBuffer.push(n),this.flush()},a.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState)this.onClose("forced close"),o("socket closing - telling transport to close"),this.transport.close(),this.transport.removeAllListeners();return this},a.prototype.onError=function(e){this.emit("error",e),this.onClose("transport error",e)},a.prototype.onClose=function(e,t){"closed"!=this.readyState&&(o('socket close with reason: "%s"',e),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.readyState="closed",this.emit("close",e,t),this.onclose&&this.onclose.call(this),this.id=null)}}),n.register("transport.js",function(e,t,n,r){function u(e){this.path=e.path,this.host=e.host,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState=""}var i=n("./util"),s=n("./parser"),o=n("./event-emitter");e.exports=u,i.inherits(u,o),u.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},u.prototype.open=function(){if("closed"==this.readyState||""==this.readyState)this.readyState="opening",this.doOpen();return this},u.prototype.close=function(){if("opening"==this.readyState||"open"==this.readyState)this.doClose(),this.onClose();return this},u.prototype.send=function(e){if("open"!=this.readyState)throw new Error("Transport not open");this.write(e)},u.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},u.prototype.onData=function(e){this.onPacket(s.decodePacket(e))},u.prototype.onPacket=function(e){this.emit("packet",e)},u.prototype.onClose=function(){this.readyState="closed",this.emit("close")}}),n.register("transports/flashsocket.js",function(e,t,n,r){function u(e){i.call(this,e),this.flashPath=e.flashPath,this.policyPort=e.policyPort}function f(e,t){if(a[e])return t();var n=document.createElement("script"),r=!1;n.onload=n.onreadystatechange=function(){if(r||a[e])return;var i=n.readyState;if(!i||"loaded"==i||"complete"==i)n.onload=n.onreadystatechange=null,r=!0,a[e]=!0,t()},n.async=1,n.src=e;var i=document.getElementsByTagName("head")[0];i.insertBefore(n,i.firstChild)}function l(e,t){function n(r){if(!e[r])return t();f(e[r],function(){n(++r)})}n(0)}var i=n("./websocket"),s=n("../util");e.exports=u;var o=r[["Active"].concat("Object").join("X")];s.inherits(u,i),u.prototype.name="flashsocket",u.prototype.doOpen=function(){function e(e){return function(){var e=Array.prototype.join.call(arguments," ")}}if(!this.check())return;WEB_SOCKET_LOGGER={log:e("debug"),error:e("error")},WEB_SOCKET_SUPPRESS_CROSS_DOMAIN_SWF_ERROR=!0,WEB_SOCKET_DISABLE_AUTO_INITIALIZATION=!0,"undefined"==typeof WEB_SOCKET_SWF_LOCATION&&(WEB_SOCKET_SWF_LOCATION=this.flashPath+"WebSocketMainInsecure.swf");var t=[this.flashPath+"web_socket.js"];"undefined"==typeof swfobject&&t.unshift(this.flashPath+"swfobject.js");var n=this;l(t,function(){n.ready(function(){WebSocket.__addTask(function(){i.prototype.doOpen.call(n)})})})},u.prototype.doClose=function(){if(!this.socket)return;var e=this;WebSocket.__addTask(function(){i.prototype.doClose.call(e)})},u.prototype.write=function(){var e=this,t=arguments;WebSocket.__addTask(function(){i.prototype.write.apply(e,t)})},u.prototype.ready=function(e){function t(){u.loaded||(843!=n.policyPort&&WebSocket.loadFlashPolicyFile("xmlsocket://"+n.host+":"+n.policyPort),WebSocket.__initialize(),u.loaded=!0),e.call(n)}if(!(typeof WebSocket!="undefined"&&"__initialize"in WebSocket)||!swfobject)return;if(swfobject.getFlashPlayerVersion().major<10)return;var n=this;if(document.body)return t();s.load(t)},u.prototype.check=function(){if(typeof WebSocket=="undefined"||"__initialize"in WebSocket){if(o){var e=null;try{e=new o("ShockwaveFlash.ShockwaveFlash")}catch(t){}if(e)return!0}else for(var n=0,r=navigator.plugins.length;n<r;n++)for(var i=0,s=navigator.plugins[n].length;i<s;i++)if(navigator.plugins[n][i].description=="Shockwave Flash")return!0;return!1}return!1};var a={}}),n.register("transports/index.js",function(e,t,n,r){function f(e){var t,n=!1,o=!1;if(r.location){var u="https:"==location.protocol,f=location.port;n=e.host!=location.hostname||f!=e.port,o=e.secure!=u}return t=a.request(n),o&&r.XDomainRequest&&t instanceof r.XDomainRequest?new s(e):t&&!e.forceJSONP?new i(e):new s(e)}var i=n("./polling-xhr"),s=n("./polling-jsonp"),o=n("./websocket"),u=n("./flashsocket"),a=n("../util");t.polling=f,t.websocket=o,t.flashsocket=u}),n.register("transports/polling-jsonp.js",function(e,t,n,r){function f(){}function l(e){i.call(this,e),u||(r.___eio||(r.___eio=[]),u=r.___eio),this.index=u.length;var t=this;u.push(function(e){t.onData(e)}),this.query.j=this.index}var i=n("./polling"),s=n("../util");e.exports=l;var o=/\n/g,u,a=0;s.inherits(l,i),l.prototype.doOpen=function(){var e=this;s.defer(function(){i.prototype.doOpen.call(e)})},l.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null),i.prototype.doClose.call(this)},l.prototype.doPoll=function(){var e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri();var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t),this.script=e,s.ua.gecko&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},l.prototype.doWrite=function(e,t){function a(){f(),t()}function f(){n.iframe&&n.form.removeChild(n.iframe);try{u=document.createElement('<iframe name="'+n.iframeId+'">')}catch(e){u=document.createElement("iframe"),u.name=n.iframeId}u.id=n.iframeId,n.form.appendChild(u),n.iframe=u}var n=this;if(!this.form){var r=document.createElement("form"),i=document.createElement("textarea"),s=this.iframeId="eio_iframe_"+this.index,u;r.className="socketio",r.style.position="absolute",r.style.top="-1000px",r.style.left="-1000px",r.target=s,r.method="POST",r.setAttribute("accept-charset","utf-8"),i.name="d",r.appendChild(i),document.body.appendChild(r),this.form=r,this.area=i}this.form.action=this.uri(),f(),this.area.value=e.replace(o,"\\n");try{this.form.submit()}catch(l){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){n.iframe.readyState=="complete"&&a()}:this.iframe.onload=a}}),n.register("transports/polling-xhr.js",function(e,t,n,r){function a(){}function f(e){i.call(this,e),r.location&&(this.xd=e.host!=r.location.hostname||r.location.port!=e.port)}function l(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.async=!1!==e.async,this.data=undefined!=e.data?e.data:null,this.create()}var i=n("./polling"),s=n("../event-emitter"),o=n("../util");e.exports=f,e.exports.Request=l;var u=r[["Active"].concat("Object").join("X")];o.inherits(f,i),f.prototype.doOpen=function(){var e=this;o.defer(function(){i.prototype.doOpen.call(e)})},f.prototype.request=function(e){return e=e||{},e.uri=this.uri(),e.xd=this.xd,new l(e)},f.prototype.doWrite=function(e,t){var n=this.request({method:"POST",data:e}),r=this;n.on("success",t),n.on("error",function(e){r.onError("xhr post error",e)}),this.sendXhr=n},f.prototype.doPoll=function(){var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},o.inherits(l,s),l.prototype.create=function(){var e=this.xhr=o.request(this.xd),t=this;e.open(this.method,this.uri,this.async);if("POST"==this.method)try{e.setRequestHeader?e.setRequestHeader("Content-type","text/plain;charset=UTF-8"):e.contentType="text/plain"}catch(n){}this.xd&&r.XDomainRequest&&e instanceof XDomainRequest?(e.onerror=function(e){t.onError(e)},e.onload=function(){t.onData(e.responseText)},e.onprogress=a):("withCredentials"in e&&(e.withCredentials=!0),e.onreadystatechange=function(){var n;try{if(4!=e.readyState)return;200==e.status||1223==e.status?n=e.responseText:t.onError(e.status)}catch(r){t.onError(r)}undefined!==n&&t.onData(n)}),e.send(this.data),u&&(this.index=l.requestsCount++,l.requests[this.index]=this)},l.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},l.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},l.prototype.onError=function(e){this.emit("error",e),this.cleanup()},l.prototype.cleanup=function(){this.xhr.onreadystatechange=a,this.xhr.onload=this.xhr.onerror=a;try{this.xhr.abort()}catch(e){}u&&delete l.requests[this.index],this.xhr=null},l.prototype.abort=function(){this.cleanup()},u&&(l.requestsCount=0,l.requests={},r.attachEvent("onunload",function(){for(var e in l.requests)l.requests.hasOwnProperty(e)&&l.requests[e].abort()}))}),n.register("transports/polling.js",function(e,t,n,r){function u(e){i.call(this,e)}var i=n("../transport"),s=n("../util"),o=n("../parser");e.exports=u,s.inherits(u,i),u.prototype.name="polling",u.prototype.doOpen=function(){this.poll()},u.prototype.pause=function(e){function r(){n.readyState="paused",e()}var t=0,n=this;this.readyState="pausing";if(this.polling||!this.writable){var i=0;this.polling&&(i++,this.once("pollComplete",function(){--i||r()})),this.writable||(i++,this.once("drain",function(){--i||r()}))}else r()},u.prototype.poll=function(){this.polling=!0,this.doPoll(),this.emit("poll")},u.prototype.onData=function(e){var t=o.decodePayload(e);for(var n=0,r=t.length;n<r;n++){"opening"==this.readyState&&this.onOpen();if("close"==t[n].type){this.onClose();return}this.onPacket(t[n])}this.polling=!1,this.emit("pollComplete"),"open"==this.readyState&&this.poll()},u.prototype.doClose=function(){this.send([{type:"close"}])},u.prototype.write=function(e){var t=this;this.writable=!1,this.doWrite(o.encodePayload(e),function(){t.writable=!0,t.emit("drain")})},u.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";if(r.ActiveXObject||s.ua.android||s.ua.ios6||this.timestampRequests)e[this.timestampParam]=+(new Date);return e=s.qs(e),this.port&&("https"==t&&this.port!=443||"http"==t&&this.port!=80)&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+this.host+n+this.path+e}}),n.register("transports/websocket.js",function(e,t,n,r){function u(e){i.call(this,e)}function a(){return r.WebSocket||r.MozWebSocket}var i=n("../transport"),s=n("../parser"),o=n("../util");e.exports=u,o.inherits(u,i),u.prototype.name="websocket",u.prototype.doOpen=function(){if(!this.check())return;var e=this;this.socket=new(a())(this.uri()),this.socket.onopen=function(){e.onOpen()},this.socket.onclose=function(){e.onClose()},this.socket.onmessage=function(t){e.onData(t.data)},this.socket.onerror=function(t){e.onError("websocket error",t)}},u.prototype.write=function(e){for(var t=0,n=e.length;t<n;t++)this.socket.send(s.encodePacket(e[t]))},u.prototype.doClose=function(){typeof this.socket!="undefined"&&this.socket.close()},u.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"==t&&this.port!=443||"ws"==t&&this.port!=80)&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=+(new Date)),e=o.qs(e),e.length&&(e="?"+e),t+"://"+this.host+n+this.path+e},u.prototype.check=function(){var e=a();return!!e&&!("__initialize"in e&&this.name===u.prototype.name)}}),n.register("util.js",function(e,t,n,r){var i=!1;t.inherits=function(t,n){function r(){}r.prototype=n.prototype,t.prototype=new r},t.keys=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var r in e)n.call(e,r)&&t.push(r);return t},t.on=function(e,t,n,r){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener&&e.addEventListener(t,n,r)},t.load=function(e){if(r.document&&document.readyState==="complete"||i)return e();t.on(r,"load",e,!1)},"undefined"!=typeof window&&t.load(function(){i=!0}),t.defer=function(e){if(!t.ua.webkit||"undefined"!=typeof importScripts)return e();t.load(function(){setTimeout(e,100)})};var s=/^[\],:{}\s]*$/,o=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,u=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,a=/(?:^|:|,)(?:\s*\[)+/g,f=/^\s+/,l=/\s+$/;t.parseJSON=function(e){if("string"!=typeof e||!e)return null;e=e.replace(f,"").replace(l,"");if(r.JSON&&JSON.parse)return JSON.parse(e);if(s.test(e.replace(o,"@").replace(u,"]").replace(a,"")))return(new Function("return "+e))()},t.ua={},t.ua.hasCORS="undefined"!=typeof XMLHttpRequest&&function(){try{var e=new XMLHttpRequest}catch(t){return!1}return e.withCredentials!=undefined}(),t.ua.webkit="undefined"!=typeof navigator&&/webkit/i.test(navigator.userAgent),t.ua.gecko="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent),t.ua.android="undefined"!=typeof navigator&&/android/i.test(navigator.userAgent),t.ua.ios="undefined"!=typeof navigator&&/^(iPad|iPhone|iPod)$/.test(navigator.platform),t.ua.ios6=t.ua.ios&&/OS 6_/.test(navigator.userAgent),t.request=function(n){if(n&&"undefined"!=typeof XDomainRequest&&!t.ua.hasCORS)return new XDomainRequest;try{if("undefined"!=typeof XMLHttpRequest&&(!n||t.ua.hasCORS))return new XMLHttpRequest}catch(r){}if(!n)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(r){}};var c=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,h=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.parseUri=function(e){var t=c.exec(e||""),n={},r=14;while(r--)n[h[r]]=t[r]||"";return n},t.qs=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=n+"="+encodeURIComponent(e[n]));return t}});var r=n("engine.io-client");"undefined"!=typeof module?module.exports=r:eio=r})();
require.define("eventemitter2.js",function(e,t,n,r,i){!function(e,t){function i(){this._events=new Object}function s(e){e&&(this.wildcard=e.wildcard,this.delimiter=e.delimiter||".",this.wildcard&&(this.listenerTree=new Object))}function o(e){this._events=new Object,s.call(this,e)}function u(e,t,n,r){if(!n)return;var i;if(r===t.length&&n._listeners){if(typeof n._listeners=="function")return e&&e.push(n._listeners),n;for(var s=0,o=n._listeners.length;s<o;s++)e&&e.push(n._listeners[s]);return n}if(t[r]==="*"||n[t[r]]){if(t[r]==="*"){for(var a in n)a!=="_listeners"&&n.hasOwnProperty(a)&&(i=u(e,t,n[a],r+1));return i}i=u(e,t,n[t[r]],r+1)}return n["*"]&&u(e,t,n["*"],r+1),i}function a(e,t){e=typeof e=="string"?e.split(this.delimiter):e.slice();var i=this.listenerTree,s=e.shift();while(s){i[s]||(i[s]=new Object),i=i[s];if(e.length===0){if(!i._listeners)i._listeners=t;else if(typeof i._listeners=="function")i._listeners=[i._listeners,t];else if(n(i._listeners)){i._listeners.push(t);if(!i._listeners.warned){var o=r;o>0&&i._listeners.length>o&&(i._listeners.warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",i._listeners.length),console.trace())}}return!0}s=e.shift()}return!0}var n=Array.isArray?Array.isArray:function(t){return Object.prototype.toString.call(t)==="[object Array]"},r=10;o.prototype.setMaxListeners=function(e){this._events||i.call(this),this._events.maxListeners=e},o.prototype.event="",o.prototype.once=function(e,t){return this.many(e,1,t),this},o.prototype.many=function(e,t,n){function i(){--t===0&&r.off(e,i),n.apply(null,arguments)}var r=this;if(typeof n!="function")throw new Error("many only accepts instances of Function");return i._origin=n,this.on(e,i),r},o.prototype.emit=function(){this._events||i.call(this);var e=arguments[0];if(e==="newListener"&&!this._events.newListener)return!1;if(this._all){var t=arguments.length,n=new Array(t-1);for(var r=1;r<t;r++)n[r-1]=arguments[r];for(r=0,t=this._all.length;r<t;r++)this.event=e,this._all[r].apply(this,n)}if(e==="error"&&!this._all&&!this._events.error&&(!this.wildcard||!this.listenerTree.error))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");var s;if(this.wildcard){s=[];var o=typeof e=="string"?e.split(this.delimiter):e.slice();u.call(this,s,o,this.listenerTree,0)}else s=this._events[e];if(typeof s=="function"){this.event=e;if(arguments.length===1)s.call(this);else if(arguments.length>1)switch(arguments.length){case 2:s.call(this,arguments[1]);break;case 3:s.call(this,arguments[1],arguments[2]);break;default:var t=arguments.length,n=new Array(t-1);for(var r=1;r<t;r++)n[r-1]=arguments[r];s.apply(this,n)}return!0}if(s){var t=arguments.length,n=new Array(t-1);for(var r=1;r<t;r++)n[r-1]=arguments[r];var a=s.slice();for(var r=0,t=a.length;r<t;r++)this.event=e,a[r].apply(this,n);return!0}},o.prototype.on=function(e,s){this._events||i.call(this),this.emit("newListener",e,s);if(this.wildcard)return a.call(this,e,s),this;if(!this._events[e])this._events[e]=s;else if(typeof this._events[e]=="function")this._events[e]=[this._events[e],s];else if(n(this._events[e])){this._events[e].push(s);if(!this._events[e].warned){var o;this._events.maxListeners!==t?o=this._events.maxListeners:o=r,o&&o>0&&this._events[e].length>o&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),console.trace())}}return this},o.prototype.onAny=function(e){this._all||(this._all=[]);if(typeof e!="function")throw new Error("onAny only accepts instances of Function");return this._all.push(e),this},o.prototype.addListener=o.prototype.on,o.prototype.off=function(e,t){if(typeof t!="function")throw new Error("removeListener only takes instances of Function");var r;if(this.wildcard){var i=typeof e=="string"?e.split(this.delimiter):e.slice(),s=u.call(this,null,i,this.listenerTree,0);if("undefined"==typeof s)return this;r=s._listeners}else{if(!this._events[e])return this;r=this._events[e]}if(n(r)){var o=-1;for(var a=0,f=r.length;a<f;a++)if(r[a]===t||r[a].listener&&r[a].listener===t||r[a]._origin&&r[a]._origin===t){o=a;break}if(o<0)return this;this.wildcard?s._listeners.splice(o,1):this._events[e].splice(o,1),r.length===0&&(this.wildcard?delete s._listeners:delete this._events[e])}else if(r===t||r.listener&&r.listener===t||r._origin&&r._origin===t)this.wildcard?delete s._listeners:delete this._events[e];return this},o.prototype.offAny=function(e){var t=0,n=0,r;if(e&&this._all&&this._all.length>0){r=this._all;for(t=0,n=r.length;t<n;t++)if(e===r[t])return r.splice(t,1),this}else this._all=[];return this},o.prototype.removeListener=o.prototype.off,o.prototype.removeAllListeners=function(e){if(arguments.length===0)return!this._events||i.call(this),this;if(this.wildcard){var t=typeof e=="string"?e.split(this.delimiter):e.slice(),n=u.call(this,null,t,this.listenerTree,0);if("undefined"==typeof n)return this;n._listeners=null}else{if(!this._events[e])return this;this._events[e]=null}return this},o.prototype.listeners=function(e){if(this.wildcard){var t=[],r=typeof e=="string"?e.split(this.delimiter):e.slice();return u.call(this,t,r,this.listenerTree,0),t}return this._events||i.call(this),this._events[e]||(this._events[e]=[]),n(this._events[e])||(this._events[e]=[this._events[e]]),this._events[e]},o.prototype.listenersAny=function(){return this._all?this._all:[]},e.EventEmitter2=o}(typeof n=="undefined"?window:n)});
require.define("socketstream.js",function(e,t,n,r,i){var s,o,u,a,f;s=e("eventemitter2").EventEmitter2,a=n.server=new s,u=n.message=new s,n.tmpl={},f=null,n.assignTransport=function(t){return f=e("socketstream-transport")(a,u,t),f.send=f.connect()},n.registerApi=function(e,t){var r;return r=n[e],r?console.error("SocketStream Error: Unable to register the 'ss."+e+"' responder as this name has already been taken"):n[e]=t},n.send=function(e){return function(t){return f.send(e+"|"+t)}},o={loaded:{},loading:new s},n.load={code:function(e,t){var n,r,i;e&&e.substr(0,1)==="/"&&(e=e.substr(1)),n="SocketStream Error: The ss.load.code() command ";if(!jQuery)return console.error(n+"requires jQuery to be present");if(!e)return console.error(n+"requires a directory to load. Specify it as the first argument. E.g. The ss.load.code('/mail',cb) will load code in /client/code/mail");if(!t)return console.error(n+"requires a callback. Specify it as the last argument");if(o.loaded[e])return t();o.loading.once(e,t);if(o.loading.listeners(e).length===1)return r=function(){return console.error("SocketStream Error: Could not asynchronously load "+e),console.log(arguments)},i=function(){return o.loaded[e]=!0,o.loading.emit(e)},$.ajax({url:"/_serve/code?"+e,type:"GET",cache:!1,dataType:"script",success:i,error:r})},worker:function(e){return new Worker("/_serve/worker?"+e)}},a.on("__ss:reload",function(){return window.location.reload()}),a.on("__ss:updateCSS",function(){var e,t,n,r,i;i=document.getElementsByTagName("link");for(n=0,r=i.length;n<r;n++)t=i[n],t.rel.toLowerCase().indexOf("stylesheet")>=0&&t.href&&(e=t.href.replace(/(&|%5C?)\d+/,""),t.href=e+(e.indexOf("?")>=0?"&":"?")+(new Date).valueOf());return console.log("CSS updated")})});
require.define("events-responder",function(e,t,n,r,i){var s,o;s=e("eventemitter2").EventEmitter2,o=e("socketstream"),t.exports=function(e,t,n){var r;return r=new s,o.registerApi("event",r),o.message.on(e,function(e,t){var n,i,s;return s=JSON.parse(e),n=[s.e],n=n.concat(s.p),t!=null&&n.push(t),i=s.e&&s.e.substr(0,5)==="__ss:"&&o.server||r,i.emit.apply(i,n)})}});
require.define("socketstream-rpc",function(e,t,n,r,i){var s,o,u,a;a=e("socketstream"),u=0,s={},o=function(e){return console.log(e)},t.exports=function(e,t,n){return a.registerApi("rpc",function(){var e,t,r,i,a;return e=Array.prototype.slice.call(arguments),a={},a.m=e[0],a.id=++u,r=e[e.length-1],typeof r=="function"?(a.p=e.slice(1,e.length-1),t=r):(a.p=e.slice(1),t=o),s[a.id]=t,i=JSON.stringify(a),n(i),void 0}),a.message.on(e,function(e){var t,n;n=JSON.parse(e);if(n.id&&(t=s[n.id]))return n.e?console.error("SocketStream RPC server error:",n.e.message):t.apply(t,n.p),delete s[n.id]})}});
require.define("socketstream-transport",function(e,t,n,r,i){var s=!1,o=1e3;t.exports=function(t,n,r){return JSON.stringify(r)==="{}"&&(r={secure:document.location.protocol==="https:",host:document.location.hostname,port:document.location.port}),{connect:function(){var i=new eio.Socket(r);i.onmessage=function(e){var r,i,u=e.data;if((r=u.indexOf("|"))>0){var a=u.substr(0,r),f=u.substr(r+1);switch(a){case"X":s===!1?t.emit("ready"):(o=1e3,t.emit("reconnect"));break;case"0":if((i=f.lastIndexOf("|"))>0){var l=f.substr(0,i),c=f.substr(i+1);n.emit(a,l,c)}else console.error("Invalid event message received:",u);break;default:n.emit(a,f)}}else console.error("Invalid websocket message received:",u)};var u=function(t){setTimeout(function(){var t=e("socketstream");t.assignTransport(r),t.server.event!="reconnect"&&(o*=1.5)},t)};return i.onclose=function(){s=!0,t.emit("disconnect"),u(o)},function(e){i.send(e)}}}};var u=function(e){var t,n;if(document.cookie.length>0){n=document.cookie.indexOf(e+"=");if(n!==-1)return n=n+e.length+1,t=document.cookie.indexOf(";",n),t===-1&&(t=document.cookie.length),unescape(document.cookie.substring(n,t))}return""}});(function(e,undefined){function j(e){var t=e.length,n=x.type(e);return x.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}function A(e){var t=D[e]={};return x.each(e.match(w)||[],function(e,n){t[n]=!0}),t}function F(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=x.expando+Math.random()}function P(e,t,n){var r;if(n===undefined&&1===e.nodeType)if(r="data-"+t.replace(O,"-$1").toLowerCase(),n=e.getAttribute(r),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:H.test(n)?JSON.parse(n):n}catch(i){}L.set(e,t,n)}else n=undefined;return n}function U(){return!0}function Y(){return!1}function V(){try{return o.activeElement}catch(e){}}function Z(e,t){while((e=e[t])&&1!==e.nodeType);return e}function et(e,t,n){if(x.isFunction(t))return x.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return x.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(G.test(t))return x.filter(t,e,n);t=x.filter(t,e)}return x.grep(e,function(e){return g.call(t,e)>=0!==n})}function pt(e,t){return x.nodeName(e,"table")&&x.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function ft(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function ht(e){var t=ut.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function dt(e,t){var n=e.length,r=0;for(;n>r;r++)q.set(e[r],"globalEval",!t||q.get(t[r],"globalEval"))}function gt(e,t){var n,r,i,s,o,u,a,f;if(1===t.nodeType){if(q.hasData(e)&&(s=q.access(e),o=q.set(t,s),f=s.events)){delete o.handle,o.events={};for(i in f)for(n=0,r=f[i].length;r>n;n++)x.event.add(t,i,f[i][n])}L.hasData(e)&&(u=L.access(e),a=x.extend({},u),L.set(t,a))}}function mt(e,t){var n=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return t===undefined||t&&x.nodeName(e,t)?x.merge([e],n):n}function yt(e,t){var n=t.nodeName.toLowerCase();"input"===n&&ot.test(e.type)?t.checked=e.checked:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}function At(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=Dt.length;while(i--)if(t=Dt[i]+n,t in e)return t;return r}function Lt(e,t){return e=t||e,"none"===x.css(e,"display")||!x.contains(e.ownerDocument,e)}function qt(t){return e.getComputedStyle(t,null)}function Ht(e,t){var n,r,i,s=[],o=0,u=e.length;for(;u>o;o++)r=e[o],r.style&&(s[o]=q.get(r,"olddisplay"),n=r.style.display,t?(s[o]||"none"!==n||(r.style.display=""),""===r.style.display&&Lt(r)&&(s[o]=q.access(r,"olddisplay",Rt(r.nodeName)))):s[o]||(i=Lt(r),(n&&"none"!==n||!i)&&q.set(r,"olddisplay",i?n:x.css(r,"display"))));for(o=0;u>o;o++)r=e[o],r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?s[o]||"":"none"));return e}function Ot(e,t,n){var r=Tt.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function Ft(e,t,n,r,i){var s=n===(r?"border":"content")?4:"width"===t?1:0,o=0;for(;4>s;s+=2)"margin"===n&&(o+=x.css(e,n+jt[s],!0,i)),r?("content"===n&&(o-=x.css(e,"padding"+jt[s],!0,i)),"margin"!==n&&(o-=x.css(e,"border"+jt[s]+"Width",!0,i))):(o+=x.css(e,"padding"+jt[s],!0,i),"padding"!==n&&(o+=x.css(e,"border"+jt[s]+"Width",!0,i)));return o}function Pt(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,s=qt(e),o=x.support.boxSizing&&"border-box"===x.css(e,"boxSizing",!1,s);if(0>=i||null==i){if(i=vt(e,t,s),(0>i||null==i)&&(i=e.style[t]),Ct.test(i))return i;r=o&&(x.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+Ft(e,t,n||(o?"border":"content"),r,s)+"px"}function Rt(e){var t=o,n=Nt[e];return n||(n=Mt(e,t),"none"!==n&&n||(xt=(xt||x("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(xt[0].contentWindow||xt[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=Mt(e,t),xt.detach()),Nt[e]=n),n}function Mt(e,t){var n=x(t.createElement(e)).appendTo(t.body),r=x.css(n[0],"display");return n.remove(),r}function _t(e,t,n,r){var i;if(x.isArray(t))x.each(t,function(t,i){n||$t.test(e)?r(e,i):_t(e+"["+("object"==typeof i?t:"")+"]",i,n,r)});else if(n||"object"!==x.type(t))r(e,t);else for(i in t)_t(e+"["+i+"]",t[i],n,r)}function un(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,s=t.toLowerCase().match(w)||[];if(x.isFunction(n))while(r=s[i++])"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function ln(e,t,n,r){function o(u){var a;return i[u]=!0,x.each(e[u]||[],function(e,u){var f=u(t,n,r);return"string"!=typeof f||s||i[f]?s?!(a=f):undefined:(t.dataTypes.unshift(f),o(f),!1)}),a}var i={},s=e===on;return o(t.dataTypes[0])||!i["*"]&&o("*")}function cn(e,t){var n,r,i=x.ajaxSettings.flatOptions||{};for(n in t)t[n]!==undefined&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&x.extend(!0,e,r),e}function pn(e,t,n){var r,i,s,o,u=e.contents,a=e.dataTypes;while("*"===a[0])a.shift(),r===undefined&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in u)if(u[i]&&u[i].test(r)){a.unshift(i);break}if(a[0]in n)s=a[0];else{for(i in n){if(!a[0]||e.converters[i+" "+a[0]]){s=i;break}o||(o=i)}s=s||o}return s?(s!==a[0]&&a.unshift(s),n[s]):undefined}function fn(e,t,n,r){var i,s,o,u,a,f={},l=e.dataTypes.slice();if(l[1])for(o in e.converters)f[o.toLowerCase()]=e.converters[o];s=l.shift();while(s)if(e.responseFields[s]&&(n[e.responseFields[s]]=t),!a&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),a=s,s=l.shift())if("*"===s)s=a;else if("*"!==a&&a!==s){if(o=f[a+" "+s]||f["* "+s],!o)for(i in f)if(u=i.split(" "),u[1]===s&&(o=f[a+" "+u[0]]||f["* "+u[0]])){o===!0?o=f[i]:f[i]!==!0&&(s=u[0],l.unshift(u[1]));break}if(o!==!0)if(o&&e["throws"])t=o(t);else try{t=o(t)}catch(c){return{state:"parsererror",error:o?c:"No conversion from "+a+" to "+s}}}return{state:"success",data:t}}function En(){return setTimeout(function(){xn=undefined}),xn=x.now()}function Sn(e,t,n){var r,i=(Nn[t]||[]).concat(Nn["*"]),s=0,o=i.length;for(;o>s;s++)if(r=i[s].call(n,t,e))return r}function jn(e,t,n){var r,i,s=0,o=kn.length,u=x.Deferred().always(function(){delete a.elem}),a=function(){if(i)return!1;var t=xn||En(),n=Math.max(0,f.startTime+f.duration-t),r=n/f.duration||0,s=1-r,o=0,a=f.tweens.length;for(;a>o;o++)f.tweens[o].run(s);return u.notifyWith(e,[f,s,n]),1>s&&a?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:x.extend({},t),opts:x.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:xn||En(),duration:n.duration,tweens:[],createTween:function(t,n){var r=x.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(r),r},stop:function(t){var n=0,r=t?f.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;for(Dn(l,f.opts.specialEasing);o>s;s++)if(r=kn[s].call(f,e,l,f.opts))return r;return x.map(l,Sn,f),x.isFunction(f.opts.start)&&f.opts.start.call(e,f),x.fx.timer(x.extend(a,{elem:e,anim:f,queue:f.opts.queue})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function Dn(e,t){var n,r,i,s,o;for(n in e)if(r=x.camelCase(n),i=t[r],s=e[n],x.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=x.cssHooks[r],o&&"expand"in o){s=o.expand(s),delete e[r];for(n in s)n in e||(e[n]=s[n],t[n]=i)}else t[r]=i}function An(e,t,n){var r,i,s,o,u,a,f=this,l={},c=e.style,h=e.nodeType&&Lt(e),p=q.get(e,"fxshow");n.queue||(u=x._queueHooks(e,"fx"),null==u.unqueued&&(u.unqueued=0,a=u.empty.fire,u.empty.fire=function(){u.unqueued||a()}),u.unqueued++,f.always(function(){f.always(function(){u.unqueued--,x.queue(e,"fx").length||u.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[c.overflow,c.overflowX,c.overflowY],"inline"===x.css(e,"display")&&"none"===x.css(e,"float")&&(c.display="inline-block")),n.overflow&&(c.overflow="hidden",f.always(function(){c.overflow=n.overflow[0],c.overflowX=n.overflow[1],c.overflowY=n.overflow[2]}));for(r in t)if(i=t[r],wn.exec(i)){if(delete t[r],s=s||"toggle"===i,i===(h?"hide":"show")){if("show"!==i||!p||p[r]===undefined)continue;h=!0}l[r]=p&&p[r]||x.style(e,r)}if(!x.isEmptyObject(l)){p?"hidden"in p&&(h=p.hidden):p=q.access(e,"fxshow",{}),s&&(p.hidden=!h),h?x(e).show():f.done(function(){x(e).hide()}),f.done(function(){var t;q.remove(e,"fxshow");for(t in l)x.style(e,t,l[t])});for(r in l)o=Sn(h?p[r]:0,r,f),r in p||(p[r]=o.start,h&&(o.end=o.start,o.start="width"===r||"height"===r?1:0))}}function Ln(e,t,n,r,i){return new Ln.prototype.init(e,t,n,r,i)}function qn(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=jt[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function Hn(e){return x.isWindow(e)?e:9===e.nodeType&&e.defaultView}var t,n,r=typeof undefined,i=e.location,o=e.document,s=o.documentElement,a=e.jQuery,u=e.$,l={},c=[],p="2.0.3",f=c.concat,h=c.push,d=c.slice,g=c.indexOf,m=l.toString,y=l.hasOwnProperty,v=p.trim,x=function(e,n){return new x.fn.init(e,n,t)},b=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,w=/\S+/g,T=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,C=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,k=/^-ms-/,N=/-([\da-z])/gi,E=function(e,t){return t.toUpperCase()},S=function(){o.removeEventListener("DOMContentLoaded",S,!1),e.removeEventListener("load",S,!1),x.ready()};x.fn=x.prototype={jquery:p,constructor:x,init:function(e,t,n){var r,i;if(!e)return this;if("string"==typeof e){if(r="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:T.exec(e),!r||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof x?t[0]:t,x.merge(this,x.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:o,!0)),C.test(r[1])&&x.isPlainObject(t))for(r in t)x.isFunction(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return i=o.getElementById(r[2]),i&&i.parentNode&&(this.length=1,this[0]=i),this.context=o,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):x.isFunction(e)?n.ready(e):(e.selector!==undefined&&(this.selector=e.selector,this.context=e.context),x.makeArray(e,this))},selector:"",length:0,toArray:function(){return d.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=x.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return x.each(this,e,t)},ready:function(e){return x.ready.promise().done(e),this},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(x.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:h,sort:[].sort,splice:[].splice},x.fn.init.prototype=x.fn,x.extend=x.fn.extend=function(){var e,t,n,r,i,s,o=arguments[0]||{},u=1,a=arguments.length,f=!1;for("boolean"==typeof o&&(f=o,o=arguments[1]||{},u=2),"object"==typeof o||x.isFunction(o)||(o={}),a===u&&(o=this,--u);a>u;u++)if(null!=(e=arguments[u]))for(t in e)n=o[t],r=e[t],o!==r&&(f&&r&&(x.isPlainObject(r)||(i=x.isArray(r)))?(i?(i=!1,s=n&&x.isArray(n)?n:[]):s=n&&x.isPlainObject(n)?n:{},o[t]=x.extend(f,s,r)):r!==undefined&&(o[t]=r));return o},x.extend({expando:"jQuery"+(p+Math.random()).replace(/\D/g,""),noConflict:function(t){return e.$===x&&(e.$=u),t&&e.jQuery===x&&(e.jQuery=a),x},isReady:!1,readyWait:1,holdReady:function(e){e?x.readyWait++:x.ready(!0)},ready:function(e){(e===!0?--x.readyWait:x.isReady)||(x.isReady=!0,e!==!0&&--x.readyWait>0||(n.resolveWith(o,[x]),x.fn.trigger&&x(o).trigger("ready").off("ready")))},isFunction:function(e){return"function"===x.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[m.call(e)]||"object":typeof e},isPlainObject:function(e){if("object"!==x.type(e)||e.nodeType||x.isWindow(e))return!1;try{if(e.constructor&&!y.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||o;var r=C.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=x.buildFragment([e],t,i),i&&x(i).remove(),x.merge([],r.childNodes))},parseJSON:JSON.parse,parseXML:function(e){var t,n;if(!e||"string"!=typeof e)return null;try{n=new DOMParser,t=n.parseFromString(e,"text/xml")}catch(r){t=undefined}return(!t||t.getElementsByTagName("parsererror").length)&&x.error("Invalid XML: "+e),t},noop:function(){},globalEval:function(e){var t,n=eval;e=x.trim(e),e&&(1===e.indexOf("use strict")?(t=o.createElement("script"),t.text=e,o.head.appendChild(t).parentNode.removeChild(t)):n(e))},camelCase:function(e){return e.replace(k,"ms-").replace(N,E)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,s=e.length,o=j(e);if(n){if(o){for(;s>i;i++)if(r=t.apply(e[i],n),r===!1)break}else for(i in e)if(r=t.apply(e[i],n),r===!1)break}else if(o){for(;s>i;i++)if(r=t.call(e[i],i,e[i]),r===!1)break}else for(i in e)if(r=t.call(e[i],i,e[i]),r===!1)break;return e},trim:function(e){return null==e?"":v.call(e)},makeArray:function(e,t){var n=t||[];return null!=e&&(j(Object(e))?x.merge(n,"string"==typeof e?[e]:e):h.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:g.call(t,e,n)},merge:function(e,t){var n=t.length,r=e.length,i=0;if("number"==typeof n)for(;n>i;i++)e[r++]=t[i];else while(t[i]!==undefined)e[r++]=t[i++];return e.length=r,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length;for(n=!!n;o>s;s++)r=!!t(e[s],s),n!==r&&i.push(e[s]);return i},map:function(e,t,n){var r,i=0,s=e.length,o=j(e),u=[];if(o)for(;s>i;i++)r=t(e[i],i,n),null!=r&&(u[u.length]=r);else for(i in e)r=t(e[i],i,n),null!=r&&(u[u.length]=r);return f.apply([],u)},guid:1,proxy:function(e,t){var n,r,i;return"string"==typeof t&&(n=e[t],t=e,e=n),x.isFunction(e)?(r=d.call(arguments,2),i=function(){return e.apply(t||this,r.concat(d.call(arguments)))},i.guid=e.guid=e.guid||x.guid++,i):undefined},access:function(e,t,n,r,i,s,o){var u=0,a=e.length,f=null==n;if("object"===x.type(n)){i=!0;for(u in n)x.access(e,t,u,n[u],!0,s,o)}else if(r!==undefined&&(i=!0,x.isFunction(r)||(o=!0),f&&(o?(t.call(e,r),t=null):(f=t,t=function(e,t,n){return f.call(x(e),n)})),t))for(;a>u;u++)t(e[u],n,o?r:r.call(e[u],u,t(e[u],n)));return i?e:f?t.call(e):a?t(e[0],n):s},now:Date.now,swap:function(e,t,n,r){var i,s,o={};for(s in t)o[s]=e.style[s],e.style[s]=t[s];i=n.apply(e,r||[]);for(s in t)e.style[s]=o[s];return i}}),x.ready.promise=function(t){return n||(n=x.Deferred(),"complete"===o.readyState?setTimeout(x.ready):(o.addEventListener("DOMContentLoaded",S,!1),e.addEventListener("load",S,!1))),n.promise(t)},x.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){l["[object "+t+"]"]=t.toLowerCase()}),t=x(o),function(e,t){function ot(e,t,n,i){var s,o,u,a,f,l,p,m,g,E;if((t?t.ownerDocument||t:w)!==h&&c(t),t=t||h,n=n||[],!e||"string"!=typeof e)return n;if(1!==(a=t.nodeType)&&9!==a)return[];if(d&&!i){if(s=Z.exec(e))if(u=s[1]){if(9===a){if(o=t.getElementById(u),!o||!o.parentNode)return n;if(o.id===u)return n.push(o),n}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(u))&&y(t,o)&&o.id===u)return n.push(o),n}else{if(s[2])return H.apply(n,t.getElementsByTagName(e)),n;if((u=s[3])&&r.getElementsByClassName&&t.getElementsByClassName)return H.apply(n,t.getElementsByClassName(u)),n}if(r.qsa&&(!v||!v.test(e))){if(m=p=b,g=t,E=9===a&&e,1===a&&"object"!==t.nodeName.toLowerCase()){l=mt(e),(p=t.getAttribute("id"))?m=p.replace(nt,"\\$&"):t.setAttribute("id",m),m="[id='"+m+"'] ",f=l.length;while(f--)l[f]=m+gt(l[f]);g=$.test(e)&&t.parentNode||t,E=l.join(",")}if(E)try{return H.apply(n,g.querySelectorAll(E)),n}catch(S){}finally{p||t.removeAttribute("id")}}}return Nt(e.replace(W,"$1"),t,n,i)}function ut(){function t(n,r){return e.push(n+=" ")>s.cacheLength&&delete t[e.shift()],t[n]=r}var e=[];return t}function at(e){return e[b]=!0,e}function ft(e){var t=h.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function lt(e,t){var n=e.split("|"),r=e.length;while(r--)s.attrHandle[n[r]]=t}function ct(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||O)-(~e.sourceIndex||O);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function ht(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function pt(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function dt(e){return at(function(t){return t=+t,at(function(n,r){var i,s=e([],n.length,t),o=s.length;while(o--)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function vt(){}function mt(e,t){var n,r,i,o,u,a,f,l=N[e+" "];if(l)return t?0:l.slice(0);u=e,a=[],f=s.preFilter;while(u){(!n||(r=X.exec(u)))&&(r&&(u=u.slice(r[0].length)||u),a.push(i=[])),n=!1,(r=V.exec(u))&&(n=r.shift(),i.push({value:n,type:r[0].replace(W," ")}),u=u.slice(n.length));for(o in s.filter)!(r=G[o].exec(u))||f[o]&&!(r=f[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),u=u.slice(n.length));if(!n)break}return t?u.length:u?ot.error(e):N(e,a).slice(0)}function gt(e){var t=0,n=e.length,r="";for(;n>t;t++)r+=e[t].value;return r}function yt(e,t,n){var r=t.dir,s=n&&"parentNode"===r,o=S++;return t.first?function(t,n,i){while(t=t[r])if(1===t.nodeType||s)return e(t,n,i)}:function(t,n,u){var a,f,l,c=E+" "+o;if(u){while(t=t[r])if((1===t.nodeType||s)&&e(t,n,u))return!0}else while(t=t[r])if(1===t.nodeType||s)if(l=t[b]||(t[b]={}),(f=l[r])&&f[0]===c){if((a=f[1])===!0||a===i)return a===!0}else if(f=l[r]=[c],f[1]=e(t,n,u)||i,f[1]===!0)return!0}}function bt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function wt(e,t,n,r,i){var s,o=[],u=0,a=e.length,f=null!=t;for(;a>u;u++)(s=e[u])&&(!n||n(s,r,i))&&(o.push(s),f&&t.push(u));return o}function Et(e,t,n,r,i,s){return r&&!r[b]&&(r=Et(r)),i&&!i[b]&&(i=Et(i,s)),at(function(s,o,u,a){var f,l,c,h=[],p=[],d=o.length,v=s||Tt(t||"*",u.nodeType?[u]:u,[]),m=!e||!s&&t?v:wt(v,h,e,u,a),g=n?i||(s?e:d||r)?[]:o:m;if(n&&n(m,g,u,a),r){f=wt(g,p),r(f,[],u,a),l=f.length;while(l--)(c=f[l])&&(g[p[l]]=!(m[p[l]]=c))}if(s){if(i||e){if(i){f=[],l=g.length;while(l--)(c=g[l])&&f.push(m[l]=c);i(null,g=[],f,a)}l=g.length;while(l--)(c=g[l])&&(f=i?j.call(s,c):h[l])>-1&&(s[f]=!(o[f]=c))}}else g=wt(g===o?g.splice(d,g.length):g),i?i(null,o,g,a):H.apply(o,g)})}function St(e){var t,n,r,i=e.length,o=s.relative[e[0].type],u=o||s.relative[" "],a=o?1:0,l=yt(function(e){return e===t},u,!0),c=yt(function(e){return j.call(t,e)>-1},u,!0),h=[function(e,n,r){return!o&&(r||n!==f)||((t=n).nodeType?l(e,n,r):c(e,n,r))}];for(;i>a;a++)if(n=s.relative[e[a].type])h=[yt(bt(h),n)];else{if(n=s.filter[e[a].type].apply(null,e[a].matches),n[b]){for(r=++a;i>r;r++)if(s.relative[e[r].type])break;return Et(a>1&&bt(h),a>1&&gt(e.slice(0,a-1).concat({value:" "===e[a-2].type?"*":""})).replace(W,"$1"),n,r>a&&St(e.slice(a,r)),i>r&&St(e=e.slice(r)),i>r&&gt(e))}h.push(n)}return bt(h)}function xt(e,t){var n=0,r=t.length>0,o=e.length>0,u=function(u,a,l,c,p){var d,v,m,g=[],y=0,b="0",w=u&&[],S=null!=p,x=f,T=u||o&&s.find.TAG("*",p&&a.parentNode||a),N=E+=null==x?1:Math.random()||.1;for(S&&(f=a!==h&&a,i=n);null!=(d=T[b]);b++){if(o&&d){v=0;while(m=e[v++])if(m(d,a,l)){c.push(d);break}S&&(E=N,i=++n)}r&&((d=!m&&d)&&y--,u&&w.push(d))}if(y+=b,r&&b!==y){v=0;while(m=t[v++])m(w,g,a,l);if(u){if(y>0)while(b--)w[b]||g[b]||(g[b]=D.call(c));g=wt(g)}H.apply(c,g),S&&!u&&g.length>0&&y+t.length>1&&ot.uniqueSort(c)}return S&&(E=N,f=x),w};return r?at(u):u}function Tt(e,t,n){var r=0,i=t.length;for(;i>r;r++)ot(e,t[r],n);return n}function Nt(e,t,n,i){var o,u,f,l,c,h=mt(e);if(!i&&1===h.length){if(u=h[0]=h[0].slice(0),u.length>2&&"ID"===(f=u[0]).type&&r.getById&&9===t.nodeType&&d&&s.relative[u[1].type]){if(t=(s.find.ID(f.matches[0].replace(rt,it),t)||[])[0],!t)return n;e=e.slice(u.shift().value.length)}o=G.needsContext.test(e)?0:u.length;while(o--){if(f=u[o],s.relative[l=f.type])break;if((c=s.find[l])&&(i=c(f.matches[0].replace(rt,it),$.test(u[0].type)&&t.parentNode||t))){if(u.splice(o,1),e=i.length&&gt(u),!e)return H.apply(n,i),n;break}}}return a(e,h)(i,t,!d,n,$.test(e)),n}var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b="sizzle"+ -(new Date),w=e.document,E=0,S=0,T=ut(),N=ut(),C=ut(),k=!1,L=function(e,t){return e===t?(k=!0,0):0},A=typeof t,O=1<<31,M={}.hasOwnProperty,_=[],D=_.pop,P=_.push,H=_.push,B=_.slice,j=_.indexOf||function(e){var t=0,n=this.length;for(;n>t;t++)if(this[t]===e)return t;return-1},F="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",I="[\\x20\\t\\r\\n\\f]",q="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",R=q.replace("w","w#"),U="\\["+I+"*("+q+")"+I+"*(?:([*^$|!~]?=)"+I+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+R+")|)|)"+I+"*\\]",z=":("+q+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+U.replace(3,8)+")*)|.*)\\)|)",W=RegExp("^"+I+"+|((?:^|[^\\\\])(?:\\\\.)*)"+I+"+$","g"),X=RegExp("^"+I+"*,"+I+"*"),V=RegExp("^"+I+"*([>+~]|"+I+")"+I+"*"),$=RegExp(I+"*[+~]"),J=RegExp("="+I+"*([^\\]'\"]*)"+I+"*\\]","g"),K=RegExp(z),Q=RegExp("^"+R+"$"),G={ID:RegExp("^#("+q+")"),CLASS:RegExp("^\\.("+q+")"),TAG:RegExp("^("+q.replace("w","w*")+")"),ATTR:RegExp("^"+U),PSEUDO:RegExp("^"+z),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+I+"*(even|odd|(([+-]|)(\\d*)n|)"+I+"*(?:([+-]|)"+I+"*(\\d+)|))"+I+"*\\)|)","i"),bool:RegExp("^(?:"+F+")$","i"),needsContext:RegExp("^"+I+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+I+"*((?:-\\d)?\\d*)"+I+"*\\)|)(?=[^-]|$)","i")},Y=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,et=/^(?:input|select|textarea|button)$/i,tt=/^h\d$/i,nt=/'|\\/g,rt=RegExp("\\\\([\\da-f]{1,6}"+I+"?|("+I+")|.)","ig"),it=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:0>r?String.fromCharCode(r+65536):String.fromCharCode(55296|r>>10,56320|1023&r)};try{H.apply(_=B.call(w.childNodes),w.childNodes),_[w.childNodes.length].nodeType}catch(st){H={apply:_.length?function(e,t){P.apply(e,B.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}u=ot.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},r=ot.support={},c=ot.setDocument=function(e){var n=e?e.ownerDocument||e:w,i=n.defaultView;return n!==h&&9===n.nodeType&&n.documentElement?(h=n,p=n.documentElement,d=!u(n),i&&i.attachEvent&&i!==i.top&&i.attachEvent("onbeforeunload",function(){c()}),r.attributes=ft(function(e){return e.className="i",!e.getAttribute("className")}),r.getElementsByTagName=ft(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),r.getElementsByClassName=ft(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),r.getById=ft(function(e){return p.appendChild(e).id=b,!n.getElementsByName||!n.getElementsByName(b).length}),r.getById?(s.find.ID=function(e,t){if(typeof t.getElementById!==A&&d){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},s.filter.ID=function(e){var t=e.replace(rt,it);return function(e){return e.getAttribute("id")===t}}):(delete s.find.ID,s.filter.ID=function(e){var t=e.replace(rt,it);return function(e){var n=typeof e.getAttributeNode!==A&&e.getAttributeNode("id");return n&&n.value===t}}),s.find.TAG=r.getElementsByTagName?function(e,n){return typeof n.getElementsByTagName!==A?n.getElementsByTagName(e):t}:function(e,t){var n,r=[],i=0,s=t.getElementsByTagName(e);if("*"===e){while(n=s[i++])1===n.nodeType&&r.push(n);return r}return s},s.find.CLASS=r.getElementsByClassName&&function(e,n){return typeof n.getElementsByClassName!==A&&d?n.getElementsByClassName(e):t},m=[],v=[],(r.qsa=Y.test(n.querySelectorAll))&&(ft(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||v.push("\\["+I+"*(?:value|"+F+")"),e.querySelectorAll(":checked").length||v.push(":checked")}),ft(function(e){var t=n.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&v.push("[*^$]="+I+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||v.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),v.push(",.*:")})),(r.matchesSelector=Y.test(g=p.webkitMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector||p.msMatchesSelector))&&ft(function(e){r.disconnectedMatch=g.call(e,"div"),g.call(e,"[s!='']:x"),m.push("!=",z)}),v=v.length&&RegExp(v.join("|")),m=m.length&&RegExp(m.join("|")),y=Y.test(p.contains)||p.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!!r&&1===r.nodeType&&!!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},L=p.compareDocumentPosition?function(e,t){if(e===t)return k=!0,0;var i=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t);return i?1&i||!r.sortDetached&&t.compareDocumentPosition(e)===i?e===n||y(w,e)?-1:t===n||y(w,t)?1:l?j.call(l,e)-j.call(l,t):0:4&i?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var r,i=0,s=e.parentNode,o=t.parentNode,u=[e],a=[t];if(e===t)return k=!0,0;if(!s||!o)return e===n?-1:t===n?1:s?-1:o?1:l?j.call(l,e)-j.call(l,t):0;if(s===o)return ct(e,t);r=e;while(r=r.parentNode)u.unshift(r);r=t;while(r=r.parentNode)a.unshift(r);while(u[i]===a[i])i++;return i?ct(u[i],a[i]):u[i]===w?-1:a[i]===w?1:0},n):h},ot.matches=function(e,t){return ot(e,null,null,t)},ot.matchesSelector=function(e,t){if((e.ownerDocument||e)!==h&&c(e),t=t.replace(J,"='$1']"),!(!r.matchesSelector||!d||m&&m.test(t)||v&&v.test(t)))try{var n=g.call(e,t);if(n||r.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(i){}return ot(t,h,null,[e]).length>0},ot.contains=function(e,t){return(e.ownerDocument||e)!==h&&c(e),y(e,t)},ot.attr=function(e,n){(e.ownerDocument||e)!==h&&c(e);var i=s.attrHandle[n.toLowerCase()],o=i&&M.call(s.attrHandle,n.toLowerCase())?i(e,n,!d):t;return o===t?r.attributes||!d?e.getAttribute(n):(o=e.getAttributeNode(n))&&o.specified?o.value:null:o},ot.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},ot.uniqueSort=function(e){var t,n=[],i=0,s=0;if(k=!r.detectDuplicates,l=!r.sortStable&&e.slice(0),e.sort(L),k){while(t=e[s++])t===e[s]&&(i=n.push(s));while(i--)e.splice(n[i],1)}return e},o=ot.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r];r++)n+=o(t);return n},s=ot.selectors={cacheLength:50,createPseudo:at,match:G,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(rt,it),e[3]=(e[4]||e[5]||"").replace(rt,it),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ot.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ot.error(e[0]),e},PSEUDO:function(e){var n,r=!e[5]&&e[2];return G.CHILD.test(e[0])?null:(e[3]&&e[4]!==t?e[2]=e[4]:r&&K.test(r)&&(n=mt(r,!0))&&(n=r.indexOf(")",r.length-n)-r.length)&&(e[0]=e[0].slice(0,n),e[2]=r.slice(0,n)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(rt,it).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=T[e+" "];return t||(t=RegExp("(^|"+I+")"+e+"("+I+"|$)"))&&T(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==A&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=ot.attr(r,e);return null==i?"!="===t:t?(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i+" ").indexOf(n)>-1:"|="===t?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var s="nth"!==e.slice(0,3),o="last"!==e.slice(-4),u="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,a){var f,l,c,h,p,d,v=s!==o?"nextSibling":"previousSibling",m=t.parentNode,g=u&&t.nodeName.toLowerCase(),y=!a&&!u;if(m){if(s){while(v){c=t;while(c=c[v])if(u?c.nodeName.toLowerCase()===g:1===c.nodeType)return!1;d=v="only"===e&&!d&&"nextSibling"}return!0}if(d=[o?m.firstChild:m.lastChild],o&&y){l=m[b]||(m[b]={}),f=l[e]||[],p=f[0]===E&&f[1],h=f[0]===E&&f[2],c=p&&m.childNodes[p];while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if(1===c.nodeType&&++h&&c===t){l[e]=[E,p,h];break}}else if(y&&(f=(t[b]||(t[b]={}))[e])&&f[0]===E)h=f[1];else while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if((u?c.nodeName.toLowerCase()===g:1===c.nodeType)&&++h&&(y&&((c[b]||(c[b]={}))[e]=[E,h]),c===t))break;return h-=i,h===r||0===h%r&&h/r>=0}}},PSEUDO:function(e,t){var n,r=s.pseudos[e]||s.setFilters[e.toLowerCase()]||ot.error("unsupported pseudo: "+e);return r[b]?r(t):r.length>1?(n=[e,e,"",t],s.setFilters.hasOwnProperty(e.toLowerCase())?at(function(e,n){var i,s=r(e,t),o=s.length;while(o--)i=j.call(e,s[o]),e[i]=!(n[i]=s[o])}):function(e){return r(e,0,n)}):r}},pseudos:{not:at(function(e){var t=[],n=[],r=a(e.replace(W,"$1"));return r[b]?at(function(e,t,n,i){var s,o=r(e,null,i,[]),u=e.length;while(u--)(s=o[u])&&(e[u]=!(t[u]=s))}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:at(function(e){return function(t){return ot(e,t).length>0}}),contains:at(function(e){return function(t){return(t.textContent||t.innerText||o(t)).indexOf(e)>-1}}),lang:at(function(e){return Q.test(e||"")||ot.error("unsupported lang: "+e),e=e.replace(rt,it).toLowerCase(),function(t){var n;do if(n=d?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===p},focus:function(e){return e===h.activeElement&&(!h.hasFocus||h.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!s.pseudos.empty(e)},header:function(e){return tt.test(e.nodeName)},input:function(e){return et.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:dt(function(){return[0]}),last:dt(function(e,t){return[t-1]}),eq:dt(function(e,t,n){return[0>n?n+t:n]}),even:dt(function(e,t){var n=0;for(;t>n;n+=2)e.push(n);return e}),odd:dt(function(e,t){var n=1;for(;t>n;n+=2)e.push(n);return e}),lt:dt(function(e,t,n){var r=0>n?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:dt(function(e,t,n){var r=0>n?n+t:n;for(;t>++r;)e.push(r);return e})}},s.pseudos.nth=s.pseudos.eq;for(n in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})s.pseudos[n]=ht(n);for(n in{submit:!0,reset:!0})s.pseudos[n]=pt(n);vt.prototype=s.filters=s.pseudos,s.setFilters=new vt,a=ot.compile=function(e,t){var n,r=[],i=[],s=C[e+" "];if(!s){t||(t=mt(e)),n=t.length;while(n--)s=St(t[n]),s[b]?r.push(s):i.push(s);s=C(e,xt(i,r))}return s},r.sortStable=b.split("").sort(L).join("")===b,r.detectDuplicates=k,c(),r.sortDetached=ft(function(e){return 1&e.compareDocumentPosition(h.createElement("div"))}),ft(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||lt("type|href|height|width",function(e,n,r){return r?t:e.getAttribute(n,"type"===n.toLowerCase()?1:2)}),r.attributes&&ft(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||lt("value",function(e,n,r){return r||"input"!==e.nodeName.toLowerCase()?t:e.defaultValue}),ft(function(e){return null==e.getAttribute("disabled")})||lt(F,function(e,n,r){var i;return r?t:(i=e.getAttributeNode(n))&&i.specified?i.value:e[n]===!0?n.toLowerCase():null}),x.find=ot,x.expr=ot.selectors,x.expr[":"]=x.expr.pseudos,x.unique=ot.uniqueSort,x.text=ot.getText,x.isXMLDoc=ot.isXML,x.contains=ot.contains}(e);var D={};x.Callbacks=function(e){e="string"==typeof e?D[e]||A(e):x.extend({},e);var t,n,r,i,s,o,u=[],a=!e.once&&[],f=function(h){for(t=e.memory&&h,n=!0,o=i||0,i=0,s=u.length,r=!0;u&&s>o;o++)if(u[o].apply(h[0],h[1])===!1&&e.stopOnFalse){t=!1;break}r=!1,u&&(a?a.length&&f(a.shift()):t?u=[]:l.disable())},l={add:function(){if(u){var n=u.length;(function o(t){x.each(t,function(t,n){var r=x.type(n);"function"===r?e.unique&&l.has(n)||u.push(n):n&&n.length&&"string"!==r&&o(n)})})(arguments),r?s=u.length:t&&(i=n,f(t))}return this},remove:function(){return u&&x.each(arguments,function(e,t){var n;while((n=x.inArray(t,u,n))>-1)u.splice(n,1),r&&(s>=n&&s--,o>=n&&o--)}),this},has:function(e){return e?x.inArray(e,u)>-1:!!u&&!!u.length},empty:function(){return u=[],s=0,this},disable:function(){return u=a=t=undefined,this},disabled:function(){return!u},lock:function(){return a=undefined,t||l.disable(),this},locked:function(){return!a},fireWith:function(e,t){return!u||n&&!a||(t=t||[],t=[e,t.slice?t.slice():t],r?a.push(t):f(t)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!n}};return l},x.extend({Deferred:function(e){var t=[["resolve","done",x.Callbacks("once memory"),"resolved"],["reject","fail",x.Callbacks("once memory"),"rejected"],["notify","progress",x.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return x.Deferred(function(n){x.each(t,function(t,s){var o=s[0],u=x.isFunction(e[t])&&e[t];i[s[1]](function(){var e=u&&u.apply(this,arguments);e&&x.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[o+"With"](this===r?n.promise():this,u?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?x.extend(e,r):r}},i={};return r.pipe=r.then,x.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[1^e][2].disable,t[2][2].lock),i[s[0]]=function(){return i[s[0]+"With"](this===i?r:this,arguments),this},i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=d.call(arguments),r=n.length,i=1!==r||e&&x.isFunction(e.promise)?r:0,s=1===i?e:x.Deferred(),o=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?d.call(arguments):r,n===u?s.notifyWith(t,n):--i||s.resolveWith(t,n)}},u,a,f;if(r>1)for(u=Array(r),a=Array(r),f=Array(r);r>t;t++)n[t]&&x.isFunction(n[t].promise)?n[t].promise().done(o(t,f,n)).fail(s.reject).progress(o(t,a,u)):--i;return i||s.resolveWith(f,n),s.promise()}}),x.support=function(t){var n=o.createElement("input"),r=o.createDocumentFragment(),i=o.createElement("div"),s=o.createElement("select"),u=s.appendChild(o.createElement("option"));return n.type?(n.type="checkbox",t.checkOn=""!==n.value,t.optSelected=u.selected,t.reliableMarginRight=!0,t.boxSizingReliable=!0,t.pixelPosition=!1,n.checked=!0,t.noCloneChecked=n.cloneNode(!0).checked,s.disabled=!0,t.optDisabled=!u.disabled,n=o.createElement("input"),n.value="t",n.type="radio",t.radioValue="t"===n.value,n.setAttribute("checked","t"),n.setAttribute("name","t"),r.appendChild(n),t.checkClone=r.cloneNode(!0).cloneNode(!0).lastChild.checked,t.focusinBubbles="onfocusin"in e,i.style.backgroundClip="content-box",i.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===i.style.backgroundClip,x(function(){var n,r,s="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",u=o.getElementsByTagName("body")[0];u&&(n=o.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",u.appendChild(n).appendChild(i),i.innerHTML="",i.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",x.swap(u,null!=u.style.zoom?{zoom:1}:{},function(){t.boxSizing=4===i.offsetWidth}),e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(i,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(i,null)||{width:"4px"}).width,r=i.appendChild(o.createElement("div")),r.style.cssText=i.style.cssText=s,r.style.marginRight=r.style.width="0",i.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),u.removeChild(n))}),t):t}({});var L,q,H=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,O=/([A-Z])/g;F.uid=1,F.accepts=function(e){return e.nodeType?1===e.nodeType||9===e.nodeType:!0},F.prototype={key:function(e){if(!F.accepts(e))return 0;var t={},n=e[this.expando];if(!n){n=F.uid++;try{t[this.expando]={value:n},Object.defineProperties(e,t)}catch(r){t[this.expando]=n,x.extend(e,t)}}return this.cache[n]||(this.cache[n]={}),n},set:function(e,t,n){var r,i=this.key(e),s=this.cache[i];if("string"==typeof t)s[t]=n;else if(x.isEmptyObject(s))x.extend(this.cache[i],t);else for(r in t)s[r]=t[r];return s},get:function(e,t){var n=this.cache[this.key(e)];return t===undefined?n:n[t]},access:function(e,t,n){var r;return t===undefined||t&&"string"==typeof t&&n===undefined?(r=this.get(e,t),r!==undefined?r:this.get(e,x.camelCase(t))):(this.set(e,t,n),n!==undefined?n:t)},remove:function(e,t){var n,r,i,s=this.key(e),o=this.cache[s];if(t===undefined)this.cache[s]={};else{x.isArray(t)?r=t.concat(t.map(x.camelCase)):(i=x.camelCase(t),t in o?r=[t,i]:(r=i,r=r in o?[r]:r.match(w)||[])),n=r.length;while(n--)delete o[r[n]]}},hasData:function(e){return!x.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}},L=new F,q=new F,x.extend({acceptData:F.accepts,hasData:function(e){return L.hasData(e)||q.hasData(e)},data:function(e,t,n){return L.access(e,t,n)},removeData:function(e,t){L.remove(e,t)},_data:function(e,t,n){return q.access(e,t,n)},_removeData:function(e,t){q.remove(e,t)}}),x.fn.extend({data:function(e,t){var n,r,i=this[0],s=0,o=null;if(e===undefined){if(this.length&&(o=L.get(i),1===i.nodeType&&!q.get(i,"hasDataAttrs"))){for(n=i.attributes;n.length>s;s++)r=n[s].name,0===r.indexOf("data-")&&(r=x.camelCase(r.slice(5)),P(i,r,o[r]));q.set(i,"hasDataAttrs",!0)}return o}return"object"==typeof e?this.each(function(){L.set(this,e)}):x.access(this,function(t){var n,r=x.camelCase(e);if(i&&t===undefined){if(n=L.get(i,e),n!==undefined)return n;if(n=L.get(i,r),n!==undefined)return n;if(n=P(i,r,undefined),n!==undefined)return n}else this.each(function(){var n=L.get(this,r);L.set(this,r,t),-1!==e.indexOf("-")&&n!==undefined&&L.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){L.remove(this,e)})}}),x.extend({queue:function(e,t,n){var r;return e?(t=(t||"fx")+"queue",r=q.get(e,t),n&&(!r||x.isArray(n)?r=q.access(e,t,x.makeArray(n)):r.push(n)),r||[]):undefined},dequeue:function(e,t){t=t||"fx";var n=x.queue(e,t),r=n.length,i=n.shift(),s=x._queueHooks(e,t),o=function(){x.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return q.get(e,n)||q.access(e,n,{empty:x.Callbacks("once memory").add(function(){q.remove(e,[t+"queue",n])})})}}),x.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),n>arguments.length?x.queue(this[0],e):t===undefined?this:this.each(function(){var n=x.queue(this,e,t);x._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&x.dequeue(this,e)})},dequeue:function(e){return this.each(function(){x.dequeue(this,e)})},delay:function(e,t){return e=x.fx?x.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=x.Deferred(),s=this,o=this.length,u=function(){--r||i.resolveWith(s,[s])};"string"!=typeof e&&(t=e,e=undefined),e=e||"fx";while(o--)n=q.get(s[o],e+"queueHooks"),n&&n.empty&&(r++,n.empty.add(u));return u(),i.promise(t)}});var R,M,W=/[\t\r\n\f]/g,$=/\r/g,B=/^(?:input|select|textarea|button)$/i;x.fn.extend({attr:function(e,t){return x.access(this,x.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){x.removeAttr(this,e)})},prop:function(e,t){return x.access(this,x.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[x.propFix[e]||e]})},addClass:function(e){var t,n,r,i,s,o=0,u=this.length,a="string"==typeof e&&e;if(x.isFunction(e))return this.each(function(t){x(this).addClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(w)||[];u>o;o++)if(n=this[o],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(W," "):" ")){s=0;while(i=t[s++])0>r.indexOf(" "+i+" ")&&(r+=i+" ");n.className=x.trim(r)}return this},removeClass:function(e){var t,n,r,i,s,o=0,u=this.length,a=0===arguments.length||"string"==typeof e&&e;if(x.isFunction(e))return this.each(function(t){x(this).removeClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(w)||[];u>o;o++)if(n=this[o],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(W," "):"")){s=0;while(i=t[s++])while(r.indexOf(" "+i+" ")>=0)r=r.replace(" "+i+" "," ");n.className=e?x.trim(r):""}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):x.isFunction(e)?this.each(function(n){x(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n){var t,i=0,s=x(this),o=e.match(w)||[];while(t=o[i++])s.hasClass(t)?s.removeClass(t):s.addClass(t)}else(n===r||"boolean"===n)&&(this.className&&q.set(this,"__className__",this.className),this.className=this.className||e===!1?"":q.get(this,"__className__")||"")})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(W," ").indexOf(t)>=0)return!0;return!1},val:function(e){var t,n,r,i=this[0];if(arguments.length)return r=x.isFunction(e),this.each(function(n){var i;1===this.nodeType&&(i=r?e.call(this,n,x(this).val()):e,null==i?i="":"number"==typeof i?i+="":x.isArray(i)&&(i=x.map(i,function(e){return null==e?"":e+""})),t=x.valHooks[this.type]||x.valHooks[this.nodeName.toLowerCase()],t&&"set"in t&&t.set(this,i,"value")!==undefined||(this.value=i))});if(i)return t=x.valHooks[i.type]||x.valHooks[i.nodeName.toLowerCase()],t&&"get"in t&&(n=t.get(i,"value"))!==undefined?n:(n=i.value,"string"==typeof n?n.replace($,""):null==n?"":n)}}),x.extend({valHooks:{option:{get:function(e){var t=e.attributes.value;return!t||t.specified?e.value:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,s="select-one"===e.type||0>i,o=s?null:[],u=s?i+1:r.length,a=0>i?u:s?i:0;for(;u>a;a++)if(n=r[a],!(!n.selected&&a!==i||(x.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&x.nodeName(n.parentNode,"optgroup"))){if(t=x(n).val(),s)return t;o.push(t)}return o},set:function(e,t){var n,r,i=e.options,s=x.makeArray(t),o=i.length;while(o--)r=i[o],(r.selected=x.inArray(x(r).val(),s)>=0)&&(n=!0);return n||(e.selectedIndex=-1),s}}},attr:function(e,t,n){var i,s,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return typeof e.getAttribute===r?x.prop(e,t,n):(1===o&&x.isXMLDoc(e)||(t=t.toLowerCase(),i=x.attrHooks[t]||(x.expr.match.bool.test(t)?M:R)),n===undefined?i&&"get"in i&&null!==(s=i.get(e,t))?s:(s=x.find.attr(e,t),null==s?undefined:s):null!==n?i&&"set"in i&&(s=i.set(e,n,t))!==undefined?s:(e.setAttribute(t,n+""),n):(x.removeAttr(e,t),undefined))},removeAttr:function(e,t){var n,r,i=0,s=t&&t.match(w);if(s&&1===e.nodeType)while(n=s[i++])r=x.propFix[n]||n,x.expr.match.bool.test(n)&&(e[r]=!1),e.removeAttribute(n)},attrHooks:{type:{set:function(e,t){if(!x.support.radioValue&&"radio"===t&&x.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,t,n){var r,i,s,o=e.nodeType;if(e&&3!==o&&8!==o&&2!==o)return s=1!==o||!x.isXMLDoc(e),s&&(t=x.propFix[t]||t,i=x.propHooks[t]),n!==undefined?i&&"set"in i&&(r=i.set(e,n,t))!==undefined?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||B.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),M={set:function(e,t,n){return t===!1?x.removeAttr(e,n):e.setAttribute(n,n),n}},x.each(x.expr.match.bool.source.match(/\w+/g),function(e,t){var n=x.expr.attrHandle[t]||x.find.attr;x.expr.attrHandle[t]=function(e,t,r){var i=x.expr.attrHandle[t],s=r?undefined:(x.expr.attrHandle[t]=undefined)!=n(e,t,r)?t.toLowerCase():null;return x.expr.attrHandle[t]=i,s}}),x.support.optSelected||(x.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),x.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){x.propFix[this.toLowerCase()]=this}),x.each(["radio","checkbox"],function(){x.valHooks[this]={set:function(e,t){return x.isArray(t)?e.checked=x.inArray(x(e).val(),t)>=0:undefined}},x.support.checkOn||(x.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var I=/^key/,z=/^(?:mouse|contextmenu)|click/,_=/^(?:focusinfocus|focusoutblur)$/,X=/^([^.]*)(?:\.(.+)|)$/;x.event={global:{},add:function(e,t,n,i,s){var o,u,a,f,l,c,h,p,d,v,m,g=q.get(e);if(g){n.handler&&(o=n,n=o.handler,s=o.selector),n.guid||(n.guid=x.guid++),(f=g.events)||(f=g.events={}),(u=g.handle)||(u=g.handle=function(e){return typeof x===r||e&&x.event.triggered===e.type?undefined:x.event.dispatch.apply(u.elem,arguments)},u.elem=e),t=(t||"").match(w)||[""],l=t.length;while(l--)a=X.exec(t[l])||[],d=m=a[1],v=(a[2]||"").split(".").sort(),d&&(h=x.event.special[d]||{},d=(s?h.delegateType:h.bindType)||d,h=x.event.special[d]||{},c=x.extend({type:d,origType:m,data:i,handler:n,guid:n.guid,selector:s,needsContext:s&&x.expr.match.needsContext.test(s),namespace:v.join(".")},o),(p=f[d])||(p=f[d]=[],p.delegateCount=0,h.setup&&h.setup.call(e,i,v,u)!==!1||e.addEventListener&&e.addEventListener(d,u,!1)),h.add&&(h.add.call(e,c),c.handler.guid||(c.handler.guid=n.guid)),s?p.splice(p.delegateCount++,0,c):p.push(c),x.event.global[d]=!0);e=null}},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m=q.hasData(e)&&q.get(e);if(m&&(a=m.events)){t=(t||"").match(w)||[""],f=t.length;while(f--)if(u=X.exec(t[f])||[],p=v=u[1],d=(u[2]||"").split(".").sort(),p){c=x.event.special[p]||{},p=(r?c.delegateType:c.bindType)||p,h=a[p]||[],u=u[2]&&RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=s=h.length;while(s--)l=h[s],!i&&v!==l.origType||n&&n.guid!==l.guid||u&&!u.test(l.namespace)||r&&r!==l.selector&&("**"!==r||!l.selector)||(h.splice(s,1),l.selector&&h.delegateCount--,c.remove&&c.remove.call(e,l));o&&!h.length&&(c.teardown&&c.teardown.call(e,d,m.handle)!==!1||x.removeEvent(e,p,m.handle),delete a[p])}else for(p in a)x.event.remove(e,p+t[f],n,r,!0);x.isEmptyObject(a)&&(delete m.handle,q.remove(e,"events"))}},trigger:function(t,n,r,i){var s,u,a,f,l,c,h,p=[r||o],d=y.call(t,"type")?t.type:t,v=y.call(t,"namespace")?t.namespace.split("."):[];if(u=a=r=r||o,3!==r.nodeType&&8!==r.nodeType&&!_.test(d+x.event.triggered)&&(d.indexOf(".")>=0&&(v=d.split("."),d=v.shift(),v.sort()),l=0>d.indexOf(":")&&"on"+d,t=t[x.expando]?t:new x.Event(d,"object"==typeof t&&t),t.isTrigger=i?2:3,t.namespace=v.join("."),t.namespace_re=t.namespace?RegExp("(^|\\.)"+v.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=undefined,t.target||(t.target=r),n=null==n?[t]:x.makeArray(n,[t]),h=x.event.special[d]||{},i||!h.trigger||h.trigger.apply(r,n)!==!1)){if(!i&&!h.noBubble&&!x.isWindow(r)){for(f=h.delegateType||d,_.test(f+d)||(u=u.parentNode);u;u=u.parentNode)p.push(u),a=u;a===(r.ownerDocument||o)&&p.push(a.defaultView||a.parentWindow||e)}s=0;while((u=p[s++])&&!t.isPropagationStopped())t.type=s>1?f:h.bindType||d,c=(q.get(u,"events")||{})[t.type]&&q.get(u,"handle"),c&&c.apply(u,n),c=l&&u[l],c&&x.acceptData(u)&&c.apply&&c.apply(u,n)===!1&&t.preventDefault();return t.type=d,i||t.isDefaultPrevented()||h._default&&h._default.apply(p.pop(),n)!==!1||!x.acceptData(r)||l&&x.isFunction(r[d])&&!x.isWindow(r)&&(a=r[l],a&&(r[l]=null),x.event.triggered=d,r[d](),x.event.triggered=undefined,a&&(r[l]=a)),t.result}},dispatch:function(e){e=x.event.fix(e);var t,n,r,i,s,o=[],u=d.call(arguments),a=(q.get(this,"events")||{})[e.type]||[],f=x.event.special[e.type]||{};if(u[0]=e,e.delegateTarget=this,!f.preDispatch||f.preDispatch.call(this,e)!==!1){o=x.event.handlers.call(this,e,a),t=0;while((i=o[t++])&&!e.isPropagationStopped()){e.currentTarget=i.elem,n=0;while((s=i.handlers[n++])&&!e.isImmediatePropagationStopped())(!e.namespace_re||e.namespace_re.test(s.namespace))&&(e.handleObj=s,e.data=s.data,r=((x.event.special[s.origType]||{}).handle||s.handler).apply(i.elem,u),r!==undefined&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()))}return f.postDispatch&&f.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,r,i,s,o=[],u=t.delegateCount,a=e.target;if(u&&a.nodeType&&(!e.button||"click"!==e.type))for(;a!==this;a=a.parentNode||this)if(a.disabled!==!0||"click"!==e.type){for(r=[],n=0;u>n;n++)s=t[n],i=s.selector+" ",r[i]===undefined&&(r[i]=s.needsContext?x(i,this).index(a)>=0:x.find(i,this,null,[a]).length),r[i]&&r.push(s);r.length&&o.push({elem:a,handlers:r})}return t.length>u&&o.push({elem:this,handlers:t.slice(u)}),o},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,r,i,s=t.button;return null==e.pageX&&null!=t.clientX&&(n=e.target.ownerDocument||o,r=n.documentElement,i=n.body,e.pageX=t.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),e.which||s===undefined||(e.which=1&s?1:2&s?3:4&s?2:0),e}},fix:function(e){if(e[x.expando])return e;var t,n,r,i=e.type,s=e,u=this.fixHooks[i];u||(this.fixHooks[i]=u=z.test(i)?this.mouseHooks:I.test(i)?this.keyHooks:{}),r=u.props?this.props.concat(u.props):this.props,e=new x.Event(s),t=r.length;while(t--)n=r[t],e[n]=s[n];return e.target||(e.target=o),3===e.target.nodeType&&(e.target=e.target.parentNode),u.filter?u.filter(e,s):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==V()&&this.focus?(this.focus(),!1):undefined},delegateType:"focusin"},blur:{trigger:function(){return this===V()&&this.blur?(this.blur(),!1):undefined},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&x.nodeName(this,"input")?(this.click(),!1):undefined},_default:function(e){return x.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==undefined&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=x.extend(new x.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?x.event.trigger(i,null,t):x.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},x.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},x.Event=function(e,t){return this instanceof x.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.getPreventDefault&&e.getPreventDefault()?U:Y):this.type=e,t&&x.extend(this,t),this.timeStamp=e&&e.timeStamp||x.now(),this[x.expando]=!0,undefined):new x.Event(e,t)},x.Event.prototype={isDefaultPrevented:Y,isPropagationStopped:Y,isImmediatePropagationStopped:Y,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=U,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=U,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=U,this.stopPropagation()}},x.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){x.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj;return(!i||i!==r&&!x.contains(r,i))&&(e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t),n}}}),x.support.focusinBubbles||x.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){x.event.simulate(t,e.target,x.event.fix(e),!0)};x.event.special[t]={setup:function(){0===n++&&o.addEventListener(e,r,!0)},teardown:function(){0===--n&&o.removeEventListener(e,r,!0)}}}),x.fn.extend({on:function(e,t,n,r,i){var s,o;if("object"==typeof e){"string"!=typeof t&&(n=n||t,t=undefined);for(o in e)this.on(o,t,n,e[o],i);return this}if(null==n&&null==r?(r=t,n=t=undefined):null==r&&("string"==typeof t?(r=n,n=undefined):(r=n,n=t,t=undefined)),r===!1)r=Y;else if(!r)return this;return 1===i&&(s=r,r=function(e){return x().off(e),s.apply(this,arguments)},r.guid=s.guid||(s.guid=x.guid++)),this.each(function(){x.event.add(this,e,r,n,t)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,x(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return(t===!1||"function"==typeof t)&&(n=t,t=undefined),n===!1&&(n=Y),this.each(function(){x.event.remove(this,e,n,t)})},trigger:function(e,t){return this.each(function(){x.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];return n?x.event.trigger(e,t,n,!0):undefined}});var G=/^.[^:#\[\.,]*$/,J=/^(?:parents|prev(?:Until|All))/,Q=x.expr.match.needsContext,K={children:!0,contents:!0,next:!0,prev:!0};x.fn.extend({find:function(e){var t,n=[],r=this,i=r.length;if("string"!=typeof e)return this.pushStack(x(e).filter(function(){for(t=0;i>t;t++)if(x.contains(r[t],this))return!0}));for(t=0;i>t;t++)x.find(e,r[t],n);return n=this.pushStack(i>1?x.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},has:function(e){var t=x(e,this),n=t.length;return this.filter(function(){var e=0;for(;n>e;e++)if(x.contains(this,t[e]))return!0})},not:function(e){return this.pushStack(et(this,e||[],!0))},filter:function(e){return this.pushStack(et(this,e||[],!1))},is:function(e){return!!et(this,"string"==typeof e&&Q.test(e)?x(e):e||[],!1).length},closest:function(e,t){var n,r=0,i=this.length,s=[],o=Q.test(e)||"string"!=typeof e?x(e,t||this.context):0;for(;i>r;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(11>n.nodeType&&(o?o.index(n)>-1:1===n.nodeType&&x.find.matchesSelector(n,e))){n=s.push(n);break}return this.pushStack(s.length>1?x.unique(s):s)},index:function(e){return e?"string"==typeof e?g.call(x(e),this[0]):g.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?x(e,t):x.makeArray(e&&e.nodeType?[e]:e),r=x.merge(this.get(),n);return this.pushStack(x.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),x.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return x.dir(e,"parentNode")},parentsUntil:function(e,t,n){return x.dir(e,"parentNode",n)},next:function(e){return Z(e,"nextSibling")},prev:function(e){return Z(e,"previousSibling")},nextAll:function(e){return x.dir(e,"nextSibling")},prevAll:function(e){return x.dir(e,"previousSibling")},nextUntil:function(e,t,n){return x.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return x.dir(e,"previousSibling",n)},siblings:function(e){return x.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return x.sibling(e.firstChild)},contents:function(e){return e.contentDocument||x.merge([],e.childNodes)}},function(e,t){x.fn[e]=function(n,r){var i=x.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=x.filter(r,i)),this.length>1&&(K[e]||x.unique(i),J.test(e)&&i.reverse()),this.pushStack(i)}}),x.extend({filter:function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?x.find.matchesSelector(r,e)?[r]:[]:x.find.matches(e,x.grep(t,function(e){return 1===e.nodeType}))},dir:function(e,t,n){var r=[],i=n!==undefined;while((e=e[t])&&9!==e.nodeType)if(1===e.nodeType){if(i&&x(e).is(n))break;r.push(e)}return r},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});var tt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,nt=/<([\w:]+)/,rt=/<|&#?\w+;/,it=/<(?:script|style|link)/i,ot=/^(?:checkbox|radio)$/i,st=/checked\s*(?:[^=]|=\s*.checked.)/i,at=/^$|\/(?:java|ecma)script/i,ut=/^true\/(.*)/,lt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,ct={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ct.optgroup=ct.option,ct.tbody=ct.tfoot=ct.colgroup=ct.caption=ct.thead,ct.th=ct.td,x.fn.extend({text:function(e){return x.access(this,function(e){return e===undefined?x.text(this):this.empty().append((this[0]&&this[0].ownerDocument||o).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=pt(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=pt(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=e?x.filter(e,this):this,i=0;for(;null!=(n=r[i]);i++)t||1!==n.nodeType||x.cleanData(mt(n)),n.parentNode&&(t&&x.contains(n.ownerDocument,n)&&dt(mt(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){var e,t=0;for(;null!=(e=this[t]);t++)1===e.nodeType&&(x.cleanData(mt(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return x.clone(this,e,t)})},html:function(e){return x.access(this,function(e){var t=this[0]||{},n=0,r=this.length;if(e===undefined&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!it.test(e)&&!ct[(nt.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(tt,"<$1></$2>");try{for(;r>n;n++)t=this[n]||{},1===t.nodeType&&(x.cleanData(mt(t,!1)),t.innerHTML=e);t=0}catch(i){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=x.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(n){var r=e[t++],i=e[t++];i&&(r&&r.parentNode!==i&&(r=this.nextSibling),x(this).remove(),i.insertBefore(n,r))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,n){e=f.apply([],e);var r,i,s,o,u,a,l=0,c=this.length,h=this,p=c-1,d=e[0],v=x.isFunction(d);if(v||!(1>=c||"string"!=typeof d||x.support.checkClone)&&st.test(d))return this.each(function(r){var i=h.eq(r);v&&(e[0]=d.call(this,r,i.html())),i.domManip(e,t,n)});if(c&&(r=x.buildFragment(e,this[0].ownerDocument,!1,!n&&this),i=r.firstChild,1===r.childNodes.length&&(r=i),i)){for(s=x.map(mt(r,"script"),ft),o=s.length;c>l;l++)u=r,l!==p&&(u=x.clone(u,!0,!0),o&&x.merge(s,mt(u,"script"))),t.call(this[l],u,l);if(o)for(a=s[s.length-1].ownerDocument,x.map(s,ht),l=0;o>l;l++)u=s[l],at.test(u.type||"")&&!q.access(u,"globalEval")&&x.contains(a,u)&&(u.src?x._evalUrl(u.src):x.globalEval(u.textContent.replace(lt,"")))}return this}}),x.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){x.fn[e]=function(e){var n,r=[],i=x(e),s=i.length-1,o=0;for(;s>=o;o++)n=o===s?this:this.clone(!0),x(i[o])[t](n),h.apply(r,n.get());return this.pushStack(r)}}),x.extend({clone:function(e,t,n){var r,i,s,o,u=e.cloneNode(!0),a=x.contains(e.ownerDocument,e);if(!(x.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||x.isXMLDoc(e)))for(o=mt(u),s=mt(e),r=0,i=s.length;i>r;r++)yt(s[r],o[r]);if(t)if(n)for(s=s||mt(e),o=o||mt(u),r=0,i=s.length;i>r;r++)gt(s[r],o[r]);else gt(e,u);return o=mt(u,"script"),o.length>0&&dt(o,!a&&mt(e,"script")),u},buildFragment:function(e,t,n,r){var i,s,o,u,a,f,l=0,c=e.length,h=t.createDocumentFragment(),p=[];for(;c>l;l++)if(i=e[l],i||0===i)if("object"===x.type(i))x.merge(p,i.nodeType?[i]:i);else if(rt.test(i)){s=s||h.appendChild(t.createElement("div")),o=(nt.exec(i)||["",""])[1].toLowerCase(),u=ct[o]||ct._default,s.innerHTML=u[1]+i.replace(tt,"<$1></$2>")+u[2],f=u[0];while(f--)s=s.lastChild;x.merge(p,s.childNodes),s=h.firstChild,s.textContent=""}else p.push(t.createTextNode(i));h.textContent="",l=0;while(i=p[l++])if((!r||-1===x.inArray(i,r))&&(a=x.contains(i.ownerDocument,i),s=mt(h.appendChild(i),"script"),a&&dt(s),n)){f=0;while(i=s[f++])at.test(i.type||"")&&n.push(i)}return h},cleanData:function(e){var t,n,r,i,s,o,u=x.event.special,a=0;for(;(n=e[a])!==undefined;a++){if(F.accepts(n)&&(s=n[q.expando],s&&(t=q.cache[s]))){if(r=Object.keys(t.events||{}),r.length)for(o=0;(i=r[o])!==undefined;o++)u[i]?x.event.remove(n,i):x.removeEvent(n,i,t.handle);q.cache[s]&&delete q.cache[s]}delete L.cache[n[L.expando]]}},_evalUrl:function(e){return x.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}}),x.fn.extend({wrapAll:function(e){var t;return x.isFunction(e)?this.each(function(t){x(this).wrapAll(e.call(this,t))}):(this[0]&&(t=x(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this)},wrapInner:function(e){return x.isFunction(e)?this.each(function(t){x(this).wrapInner(e.call(this,t))}):this.each(function(){var t=x(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=x.isFunction(e);return this.each(function(n){x(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){x.nodeName(this,"body")||x(this).replaceWith(this.childNodes)}).end()}});var vt,xt,bt=/^(none|table(?!-c[ea]).+)/,wt=/^margin/,Tt=RegExp("^("+b+")(.*)$","i"),Ct=RegExp("^("+b+")(?!px)[a-z%]+$","i"),kt=RegExp("^([+-])=("+b+")","i"),Nt={BODY:"block"},Et={position:"absolute",visibility:"hidden",display:"block"},St={letterSpacing:0,fontWeight:400},jt=["Top","Right","Bottom","Left"],Dt=["Webkit","O","Moz","ms"];x.fn.extend({css:function(e,t){return x.access(this,function(e,t,n){var r,i,s={},o=0;if(x.isArray(t)){for(r=qt(e),i=t.length;i>o;o++)s[t[o]]=x.css(e,t[o],!1,r);return s}return n!==undefined?x.style(e,t,n):x.css(e,t)},e,t,arguments.length>1)},show:function(){return Ht(this,!0)},hide:function(){return Ht(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Lt(this)?x(this).show():x(this).hide()})}}),x.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=vt(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var i,s,o,u=x.camelCase(t),a=e.style;return t=x.cssProps[u]||(x.cssProps[u]=At(a,u)),o=x.cssHooks[t]||x.cssHooks[u],n===undefined?o&&"get"in o&&(i=o.get(e,!1,r))!==undefined?i:a[t]:(s=typeof n,"string"===s&&(i=kt.exec(n))&&(n=(i[1]+1)*i[2]+parseFloat(x.css(e,t)),s="number"),null==n||"number"===s&&isNaN(n)||("number"!==s||x.cssNumber[u]||(n+="px"),x.support.clearCloneStyle||""!==n||0!==t.indexOf("background")||(a[t]="inherit"),o&&"set"in o&&(n=o.set(e,n,r))===undefined||(a[t]=n)),undefined)}},css:function(e,t,n,r){var i,s,o,u=x.camelCase(t);return t=x.cssProps[u]||(x.cssProps[u]=At(e.style,u)),o=x.cssHooks[t]||x.cssHooks[u],o&&"get"in o&&(i=o.get(e,!0,n)),i===undefined&&(i=vt(e,t,r)),"normal"===i&&t in St&&(i=St[t]),""===n||n?(s=parseFloat(i),n===!0||x.isNumeric(s)?s||0:i):i}}),vt=function(e,t,n){var r,i,s,o=n||qt(e),u=o?o.getPropertyValue(t)||o[t]:undefined,a=e.style;return o&&(""!==u||x.contains(e.ownerDocument,e)||(u=x.style(e,t)),Ct.test(u)&&wt.test(t)&&(r=a.width,i=a.minWidth,s=a.maxWidth,a.minWidth=a.maxWidth=a.width=u,u=o.width,a.width=r,a.minWidth=i,a.maxWidth=s)),u},x.each(["height","width"],function(e,t){x.cssHooks[t]={get:function(e,n,r){return n?0===e.offsetWidth&&bt.test(x.css(e,"display"))?x.swap(e,Et,function(){return Pt(e,t,r)}):Pt(e,t,r):undefined},set:function(e,n,r){var i=r&&qt(e);return Ot(e,n,r?Ft(e,t,r,x.support.boxSizing&&"border-box"===x.css(e,"boxSizing",!1,i),i):0)}}}),x(function(){x.support.reliableMarginRight||(x.cssHooks.marginRight={get:function(e,t){return t?x.swap(e,{display:"inline-block"},vt,[e,"marginRight"]):undefined}}),!x.support.pixelPosition&&x.fn.position&&x.each(["top","left"],function(e,t){x.cssHooks[t]={get:function(e,n){return n?(n=vt(e,t),Ct.test(n)?x(e).position()[t]+"px":n):undefined}}})}),x.expr&&x.expr.filters&&(x.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight},x.expr.filters.visible=function(e){return!x.expr.filters.hidden(e)}),x.each({margin:"",padding:"",border:"Width"},function(e,t){x.cssHooks[e+t]={expand:function(n){var r=0,i={},s="string"==typeof n?n.split(" "):[n];for(;4>r;r++)i[e+jt[r]+t]=s[r]||s[r-2]||s[0];return i}},wt.test(e)||(x.cssHooks[e+t].set=Ot)});var Wt=/%20/g,$t=/\[\]$/,Bt=/\r?\n/g,It=/^(?:submit|button|image|reset|file)$/i,zt=/^(?:input|select|textarea|keygen)/i;x.fn.extend({serialize:function(){return x.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=x.prop(this,"elements");return e?x.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!x(this).is(":disabled")&&zt.test(this.nodeName)&&!It.test(e)&&(this.checked||!ot.test(e))}).map(function(e,t){var n=x(this).val();return null==n?null:x.isArray(n)?x.map(n,function(e){return{name:t.name,value:e.replace(Bt,"\r\n")}}):{name:t.name,value:n.replace(Bt,"\r\n")}}).get()}}),x.param=function(e,t){var n,r=[],i=function(e,t){t=x.isFunction(t)?t():null==t?"":t,r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(t===undefined&&(t=x.ajaxSettings&&x.ajaxSettings.traditional),x.isArray(e)||e.jquery&&!x.isPlainObject(e))x.each(e,function(){i(this.name,this.value)});else for(n in e)_t(n,e[n],t,i);return r.join("&").replace(Wt,"+")},x.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){x.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),x.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var Xt,Ut,Yt=x.now(),Vt=/\?/,Gt=/#.*$/,Jt=/([?&])_=[^&]*/,Qt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Kt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Zt=/^(?:GET|HEAD)$/,en=/^\/\//,tn=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,nn=x.fn.load,rn={},on={},sn="*/".concat("*");try{Ut=i.href}catch(an){Ut=o.createElement("a"),Ut.href="",Ut=Ut.href}Xt=tn.exec(Ut.toLowerCase())||[],x.fn.load=function(e,t,n){if("string"!=typeof e&&nn)return nn.apply(this,arguments);var r,i,s,o=this,u=e.indexOf(" ");return u>=0&&(r=e.slice(u),e=e.slice(0,u)),x.isFunction(t)?(n=t,t=undefined):t&&"object"==typeof t&&(i="POST"),o.length>0&&x.ajax({url:e,type:i,dataType:"html",data:t}).done(function(e){s=arguments,o.html(r?x("<div>").append(x.parseHTML(e)).find(r):e)}).complete(n&&function(e,t){o.each(n,s||[e.responseText,t,e])}),this},x.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){x.fn[t]=function(e){return this.on(t,e)}}),x.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ut,type:"GET",isLocal:Kt.test(Xt[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":sn,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":x.parseJSON,"text xml":x.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?cn(cn(e,x.ajaxSettings),t):cn(x.ajaxSettings,e)},ajaxPrefilter:un(rn),ajaxTransport:un(on),ajax:function(e,t){function T(e,t,s,u){var f,m,g,b,w,S=t;2!==y&&(y=2,o&&clearTimeout(o),n=undefined,i=u||"",E.readyState=e>0?4:0,f=e>=200&&300>e||304===e,s&&(b=pn(l,E,s)),b=fn(l,b,E,f),f?(l.ifModified&&(w=E.getResponseHeader("Last-Modified"),w&&(x.lastModified[r]=w),w=E.getResponseHeader("etag"),w&&(x.etag[r]=w)),204===e||"HEAD"===l.type?S="nocontent":304===e?S="notmodified":(S=b.state,m=b.data,g=b.error,f=!g)):(g=S,(e||!S)&&(S="error",0>e&&(e=0))),E.status=e,E.statusText=(t||S)+"",f?p.resolveWith(c,[m,S,E]):p.rejectWith(c,[E,S,g]),E.statusCode(v),v=undefined,a&&h.trigger(f?"ajaxSuccess":"ajaxError",[E,l,f?m:g]),d.fireWith(c,[E,S]),a&&(h.trigger("ajaxComplete",[E,l]),--x.active||x.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=undefined),t=t||{};var n,r,i,s,o,u,a,f,l=x.ajaxSetup({},t),c=l.context||l,h=l.context&&(c.nodeType||c.jquery)?x(c):x.event,p=x.Deferred(),d=x.Callbacks("once memory"),v=l.statusCode||{},m={},g={},y=0,b="canceled",E={readyState:0,getResponseHeader:function(e){var t;if(2===y){if(!s){s={};while(t=Qt.exec(i))s[t[1].toLowerCase()]=t[2]}t=s[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===y?i:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return y||(e=g[n]=g[n]||e,m[e]=t),this},overrideMimeType:function(e){return y||(l.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>y)for(t in e)v[t]=[v[t],e[t]];else E.always(e[E.status]);return this},abort:function(e){var t=e||b;return n&&n.abort(t),T(0,t),this}};if(p.promise(E).complete=d.add,E.success=E.done,E.error=E.fail,l.url=((e||l.url||Ut)+"").replace(Gt,"").replace(en,Xt[1]+"//"),l.type=t.method||t.type||l.method||l.type,l.dataTypes=x.trim(l.dataType||"*").toLowerCase().match(w)||[""],null==l.crossDomain&&(u=tn.exec(l.url.toLowerCase()),l.crossDomain=!(!u||u[1]===Xt[1]&&u[2]===Xt[2]&&(u[3]||("http:"===u[1]?"80":"443"))===(Xt[3]||("http:"===Xt[1]?"80":"443")))),l.data&&l.processData&&"string"!=typeof l.data&&(l.data=x.param(l.data,l.traditional)),ln(rn,l,t,E),2===y)return E;a=l.global,a&&0===x.active++&&x.event.trigger("ajaxStart"),l.type=l.type.toUpperCase(),l.hasContent=!Zt.test(l.type),r=l.url,l.hasContent||(l.data&&(r=l.url+=(Vt.test(r)?"&":"?")+l.data,delete l.data),l.cache===!1&&(l.url=Jt.test(r)?r.replace(Jt,"$1_="+Yt++):r+(Vt.test(r)?"&":"?")+"_="+Yt++)),l.ifModified&&(x.lastModified[r]&&E.setRequestHeader("If-Modified-Since",x.lastModified[r]),x.etag[r]&&E.setRequestHeader("If-None-Match",x.etag[r])),(l.data&&l.hasContent&&l.contentType!==!1||t.contentType)&&E.setRequestHeader("Content-Type",l.contentType),E.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+("*"!==l.dataTypes[0]?", "+sn+"; q=0.01":""):l.accepts["*"]);for(f in l.headers)E.setRequestHeader(f,l.headers[f]);if(!l.beforeSend||l.beforeSend.call(c,E,l)!==!1&&2!==y){b="abort";for(f in{success:1,error:1,complete:1})E[f](l[f]);if(n=ln(on,l,t,E)){E.readyState=1,a&&h.trigger("ajaxSend",[E,l]),l.async&&l.timeout>0&&(o=setTimeout(function(){E.abort("timeout")},l.timeout));try{y=1,n.send(m,T)}catch(S){if(!(2>y))throw S;T(-1,S)}}else T(-1,"No Transport");return E}return E.abort()},getJSON:function(e,t,n){return x.get(e,t,n,"json")},getScript:function(e,t){return x.get(e,undefined,t,"script")}}),x.each(["get","post"],function(e,t){x[t]=function(e,n,r,i){return x.isFunction(n)&&(i=i||r,r=n,n=undefined),x.ajax({url:e,type:t,dataType:i,data:n,success:r})}}),x.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return x.globalEval(e),e}}}),x.ajaxPrefilter("script",function(e){e.cache===undefined&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),x.ajaxTransport("script",function(e){if(e.crossDomain){var t,n;return{send:function(r,i){t=x("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&i("error"===e.type?404:200,e.type)}),o.head.appendChild(t[0])},abort:function(){n&&n()}}}});var hn=[],dn=/(=)\?(?=&|$)|\?\?/;x.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=hn.pop()||x.expando+"_"+Yt++;return this[e]=!0,e}}),x.ajaxPrefilter("json jsonp",function(t,n,r){var i,s,o,u=t.jsonp!==!1&&(dn.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&dn.test(t.data)&&"data");return u||"jsonp"===t.dataTypes[0]?(i=t.jsonpCallback=x.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,u?t[u]=t[u].replace(dn,"$1"+i):t.jsonp!==!1&&(t.url+=(Vt.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return o||x.error(i+" was not called"),o[0]},t.dataTypes[0]="json",s=e[i],e[i]=function(){o=arguments},r.always(function(){e[i]=s,t[i]&&(t.jsonpCallback=n.jsonpCallback,hn.push(i)),o&&x.isFunction(s)&&s(o[0]),o=s=undefined}),"script"):undefined}),x.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var gn=x.ajaxSettings.xhr(),mn={0:200,1223:204},yn=0,vn={};e.ActiveXObject&&x(e).on("unload",function(){for(var e in vn)vn[e]();vn=undefined}),x.support.cors=!!gn&&"withCredentials"in gn,x.support.ajax=gn=!!gn,x.ajaxTransport(function(e){var t;return x.support.cors||gn&&!e.crossDomain?{send:function(n,r){var i,s,o=e.xhr();if(o.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(i in e.xhrFields)o[i]=e.xhrFields[i];e.mimeType&&o.overrideMimeType&&o.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");for(i in n)o.setRequestHeader(i,n[i]);t=function(e){return function(){t&&(delete vn[s],t=o.onload=o.onerror=null,"abort"===e?o.abort():"error"===e?r(o.status||404,o.statusText):r(mn[o.status]||o.status,o.statusText,"string"==typeof o.responseText?{text:o.responseText}:undefined,o.getAllResponseHeaders()))}},o.onload=t(),o.onerror=t("error"),t=vn[s=yn++]=t("abort"),o.send(e.hasContent&&e.data||null)},abort:function(){t&&t()}}:undefined});var xn,bn,wn=/^(?:toggle|show|hide)$/,Tn=RegExp("^(?:([+-])=|)("+b+")([a-z%]*)$","i"),Cn=/queueHooks$/,kn=[An],Nn={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),i=Tn.exec(t),s=i&&i[3]||(x.cssNumber[e]?"":"px"),o=(x.cssNumber[e]||"px"!==s&&+r)&&Tn.exec(x.css(n.elem,e)),u=1,a=20;if(o&&o[3]!==s){s=s||o[3],i=i||[],o=+r||1;do u=u||".5",o/=u,x.style(n.elem,e,o+s);while(u!==(u=n.cur()/r)&&1!==u&&--a)}return i&&(o=n.start=+o||+r||0,n.unit=s,n.end=i[1]?o+(i[1]+1)*i[2]:+i[2]),n}]};x.Animation=x.extend(jn,{tweener:function(e,t){x.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;i>r;r++)n=e[r],Nn[n]=Nn[n]||[],Nn[n].unshift(t)},prefilter:function(e,t){t?kn.unshift(e):kn.push(e)}}),x.Tween=Ln,Ln.prototype={constructor:Ln,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(x.cssNumber[n]?"":"px")},cur:function(){var e=Ln.propHooks[this.prop];return e&&e.get?e.get(this):Ln.propHooks._default.get(this)},run:function(e){var t,n=Ln.propHooks[this.prop];return this.pos=t=this.options.duration?x.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Ln.propHooks._default.set(this),this}},Ln.prototype.init.prototype=Ln.prototype,Ln.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=x.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){x.fx.step[e.prop]?x.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[x.cssProps[e.prop]]||x.cssHooks[e.prop])?x.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},Ln.propHooks.scrollTop=Ln.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},x.each(["toggle","show","hide"],function(e,t){var n=x.fn[t];x.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(qn(t,!0),e,r,i)}}),x.fn.extend({fadeTo:function(e,t,n,r){return this.filter(Lt).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=x.isEmptyObject(e),s=x.speed(t,n,r),o=function(){var t=jn(this,x.extend({},e),s);(i||q.get(this,"finish"))&&t.stop(!0)};return o.finish=o,i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=undefined),t&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,i=null!=e&&e+"queueHooks",s=x.timers,o=q.get(this);if(i)o[i]&&o[i].stop&&r(o[i]);else for(i in o)o[i]&&o[i].stop&&Cn.test(i)&&r(o[i]);for(i=s.length;i--;)s[i].elem!==this||null!=e&&s[i].queue!==e||(s[i].anim.stop(n),t=!1,s.splice(i,1));(t||!n)&&x.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=q.get(this),r=n[e+"queue"],i=n[e+"queueHooks"],s=x.timers,o=r?r.length:0;for(n.finish=!0,x.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;o>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),x.each({slideDown:qn("show"),slideUp:qn("hide"),slideToggle:qn("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){x.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),x.speed=function(e,t,n){var r=e&&"object"==typeof e?x.extend({},e):{complete:n||!n&&t||x.isFunction(e)&&e,duration:e,easing:n&&t||t&&!x.isFunction(t)&&t};return r.duration=x.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in x.fx.speeds?x.fx.speeds[r.duration]:x.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){x.isFunction(r.old)&&r.old.call(this),r.queue&&x.dequeue(this,r.queue)},r},x.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},x.timers=[],x.fx=Ln.prototype.init,x.fx.tick=function(){var e,t=x.timers,n=0;for(xn=x.now();t.length>n;n++)e=t[n],e()||t[n]!==e||t.splice(n--,1);t.length||x.fx.stop(),xn=undefined},x.fx.timer=function(e){e()&&x.timers.push(e)&&x.fx.start()},x.fx.interval=13,x.fx.start=function(){bn||(bn=setInterval(x.fx.tick,x.fx.interval))},x.fx.stop=function(){clearInterval(bn),bn=null},x.fx.speeds={slow:600,fast:200,_default:400},x.fx.step={},x.expr&&x.expr.filters&&(x.expr.filters.animated=function(e){return x.grep(x.timers,function(t){return e===t.elem}).length}),x.fn.offset=function(e){if(arguments.length)return e===undefined?this:this.each(function(t){x.offset.setOffset(this,e,t)});var t,n,i=this[0],s={top:0,left:0},o=i&&i.ownerDocument;if(o)return t=o.documentElement,x.contains(t,i)?(typeof i.getBoundingClientRect!==r&&(s=i.getBoundingClientRect()),n=Hn(o),{top:s.top+n.pageYOffset-t.clientTop,left:s.left+n.pageXOffset-t.clientLeft}):s},x.offset={setOffset:function(e,t,n){var r,i,s,o,u,a,f,l=x.css(e,"position"),c=x(e),h={};"static"===l&&(e.style.position="relative"),u=c.offset(),s=x.css(e,"top"),a=x.css(e,"left"),f=("absolute"===l||"fixed"===l)&&(s+a).indexOf("auto")>-1,f?(r=c.position(),o=r.top,i=r.left):(o=parseFloat(s)||0,i=parseFloat(a)||0),x.isFunction(t)&&(t=t.call(e,n,u)),null!=t.top&&(h.top=t.top-u.top+o),null!=t.left&&(h.left=t.left-u.left+i),"using"in t?t.using.call(e,h):c.css(h)}},x.fn.extend({position:function(){if(this[0]){var e,t,n=this[0],r={top:0,left:0};return"fixed"===x.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),x.nodeName(e[0],"html")||(r=e.offset()),r.top+=x.css(e[0],"borderTopWidth",!0),r.left+=x.css(e[0],"borderLeftWidth",!0)),{top:t.top-r.top-x.css(n,"marginTop",!0),left:t.left-r.left-x.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||s;while(e&&!x.nodeName(e,"html")&&"static"===x.css(e,"position"))e=e.offsetParent;return e||s})}}),x.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,n){var r="pageYOffset"===n;x.fn[t]=function(i){return x.access(this,function(t,i,s){var o=Hn(t);return s===undefined?o?o[n]:t[i]:(o?o.scrollTo(r?e.pageXOffset:s,r?s:e.pageYOffset):t[i]=s,undefined)},t,i,arguments.length,null)}}),x.each({Height:"height",Width:"width"},function(e,t){x.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){x.fn[r]=function(r,i){var s=arguments.length&&(n||"boolean"!=typeof r),o=n||(r===!0||i===!0?"margin":"border");return x.access(this,function(t,n,r){var i;return x.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(i=t.documentElement,Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])):r===undefined?x.css(t,n,o):x.style(t,n,r,o)},t,s?r:undefined,s,null)}})}),x.fn.size=function(){return this.length},x.fn.andSelf=x.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=x:"function"==typeof define&&define.amd&&define("jquery",[],function(){return x}),"object"==typeof e&&"object"==typeof e.document&&(e.jQuery=e.$=x)})(window);Davis=function(e){var t=new Davis.App;return e&&e.call(t),Davis.$(function(){t.start()}),t},window.jQuery?Davis.$=jQuery:Davis.$=null,Davis.supported=function(){return typeof window.history.pushState=="function"},Davis.noop=function(){},Davis.extend=function(e){e(Davis)},Davis.version="0.9.6",Davis.utils=function(){if(Array.prototype.every)var e=function(e,t){return e.every(t,arguments[2])};else var e=function(e,t){if(e===void 0||e===null)throw new TypeError;var n=Object(e),r=n.length>>>0;if(typeof t!="function")throw new TypeError;var i=arguments[2];for(var s=0;s<r;s++)if(s in n&&!t.call(i,n[s],s,n))return!1;return!0};if(Array.prototype.forEach)var t=function(e,t){return e.forEach(t,arguments[2])};else var t=function(e,t){if(e===void 0||e===null)throw new TypeError;var n=Object(e),r=n.length>>>0;if(typeof t!="function")throw new TypeError;var i=arguments[2];for(var s=0;s<r;s++)s in n&&t.call(i,n[s],s,n)};if(Array.prototype.filter)var n=function(e,t){return e.filter(t,arguments[2])};else var n=function(e,t){if(e===void 0||e===null)throw new TypeError;var n=Object(e),r=n.length>>>0;if(typeof t!="function")throw new TypeError;var i=[],s=arguments[2];for(var o=0;o<r;o++)if(o in n){var u=n[o];t.call(s,u,o,n)&&i.push(u)}return i};if(Array.prototype.map)var r=function(e,t){return e.map(t,arguments[2])};else var r=function(e,t){if(e===void 0||e===null)throw new TypeError;var n=Object(e),r=n.length>>>0;if(typeof t!="function")throw new TypeError;var i=new Array(r),s=arguments[2];for(var o=0;o<r;o++)o in n&&(i[o]=t.call(s,n[o],o,n));return i};var i=function(e,t){return Array.prototype.slice.call(e,t||0)};return{every:e,forEach:t,filter:n,toArray:i,map:r}}(),Davis.listener=function(){var e={A:function(e){return e.host!==window.location.host||e.protocol!==window.location.protocol},FORM:function(e){var t=document.createElement("a");return t.href=e.action,this.A(t)}},t=function(t){return e[t.nodeName.toUpperCase()]?e[t.nodeName.toUpperCase()](t):!0},n=function(e){return e.altKey||e.ctrlKey||e.metaKey||e.shiftKey},r=function(e){return function(r){if(n(r))return!0;if(t(this))return!0;var i=new Davis.Request(e.call(Davis.$(this)));return Davis.location.assign(i),r.stopPropagation(),r.preventDefault(),!1}},i=r(function(){var e=this;return{method:"get",fullPath:this.prop("href"),title:this.attr("title"),delegateToServer:function(){window.location=e.prop("href")}}}),s=function(e){return decodeURIComponent(e.replace(/\+/g,"%20"))},o=r(function(){var e=this;return{method:this.attr("method"),fullPath:s(this.serialize()?[this.prop("action"),this.serialize()].join("?"):this.prop("action")),title:this.attr("title"),delegateToServer:function(){e.submit()}}});this.listen=function(){Davis.$(document).delegate(this.settings.formSelector,"submit",o),Davis.$(document).delegate(this.settings.linkSelector,"click",i)},this.unlisten=function(){Davis.$(document).undelegate(this.settings.linkSelector,"click",i),Davis.$(document).undelegate(this.settings.formSelector,"submit",o)}},Davis.event=function(){var e={};this.bind=function(t,n){return(e[t]=e[t]||[]).push(n),this},this.trigger=function(t){var n=Davis.utils.toArray(arguments,1),r=e[t];if(!r)return this;for(var i=0,s=r.length;i<s;++i)r[i].apply(this,n);return this}},Davis.logger=function(){function e(){return"["+Date()+"]"}function t(t){var n=Davis.utils.toArray(t);return n.unshift(e()),n.join(" ")}var n=function(e){return function(){window.console&&console[e](t(arguments))}},r=n("error"),i=n("info"),s=n("warn");this.logger={error:r,info:i,warn:s}},Davis.Route=function(){var e=/:([\w\d]+)/g,t="([^/]+)",n=/\*([\w\d]+)/g,r="(.*)",i=/[:|\*]([\w\d]+)/g,s=function(s,o,u){var f=function(){if(o instanceof RegExp)return o;var i=o.replace(e,t).replace(n,r);return o.lastIndex=0,new RegExp("^"+i+"$","gi")},l=function(){return s instanceof RegExp?s:new RegExp("^"+s+"$","i")},h=function(){var e=[],t;while(t=i.exec(o))e.push(t[1]);return e};this.paramNames=h(),this.path=f(),this.method=l(),typeof u=="function"?this.handlers=[u]:this.handlers=u};return s.prototype.match=function(e,t){return this.reset(),this.method.test(e)&&this.path.test(t)},s.prototype.reset=function(){this.method.lastIndex=0,this.path.lastIndex=0},s.prototype.run=function(e){this.reset();var t=this.path.exec(e.path);if(t){t.shift();for(var n=0;n<t.length;n++)e.params[this.paramNames[n]]=t[n]}var r=Davis.utils.map(this.handlers,function(e,t){return function(n){return e.call(n,n,r[t+1])}});return r[0](e)},s.prototype.toString=function(){return[this.method,this.path].join(" ")},s}(),Davis.router=function(){this.route=function(t,r){var i=function(r){var i=Davis.utils.toArray(arguments,1),s=n.join(""),o,u;return typeof r=="string"?o=s+r:o=r,u=new Davis.Route(t,o,i),e.push(u),u};return arguments.length==1?i:i.apply(this,Davis.utils.toArray(arguments,1))},this.get=this.route("get"),this.post=this.route("post"),this.put=this.route("put"),this.del=this.route("delete"),this.state=this.route("state"),this.scope=function(e,t){n.push(e);if(arguments.length==1)return;t.call(this,this),n.pop()},this.trans=function(e,t){if(t)var n=[e,decodeURIComponent(Davis.$.param(t))].join("?");else var n=e;var r=new Davis.Request({method:"state",fullPath:n,title:""});Davis.location.assign(r)},this.filter=function(e){return function(){var r=/.+/;if(arguments.length==1)var i=/.+/,s=arguments[0];else if(arguments.length==2)var i=n.join("")+arguments[0],s=arguments[1];var o=new Davis.Route(r,i,s);return t[e].push(o),o}},this.lookupFilter=function(e){return function(n,r){return Davis.utils.filter(t[e],function(e){return e.match(n,r)})}},this.before=this.filter("before"),this.after=this.filter("after"),this.lookupBeforeFilter=this.lookupFilter("before"),this.lookupAfterFilter=this.lookupFilter("after");var e=[],t={before:[],after:[]},n=[];this.lookupRoute=function(t,n){return Davis.utils.filter(e,function(e){return e.match(t,n)})[0]}},Davis.history=function(){function e(e){u.push(e)}function t(e){window.addEventListener("popstate",e,!0)}function n(e){return function(t){t.state&&t.state._davis?e(new Davis.Request(t.state._davis)):a&&e(Davis.Request.forPageLoad()),a=!0}}function r(e){return{_davis:e}}function i(r){e(r),t(n(r))}function s(e){return function(t,n){a=!0,history[e](r(t.toJSON()),t.title,t.location());if(n&&n.silent)return;Davis.utils.forEach(u,function(e){e(t)})}}function o(){return window.location.pathname+(window.location.search?window.location.search:"")}var u=[],a=!1,f=s("pushState"),l=s("replaceState");return{onChange:i,current:o,assign:f,replace:l}}(),Davis.location=function(){function e(e){i=e}function t(){return i.current()}function n(e){return function(t){typeof t=="string"&&(t=new Davis.Request(t)),i[e](t)}}function r(e){i.onChange(e)}var i=Davis.history,s=n("assign"),o=n("replace");return{setLocationDelegate:e,current:t,assign:s,replace:o,onChange:r}}(),Davis.Request=function(){var e=function(t,n){typeof t=="object"&&(n=t,t=n.fullPath,delete n.fullPath);var r=Davis.$.extend({},{title:"",fullPath:t,method:"get",timestamp:+(new Date)},n),i=this;this.raw=r,this.params={},this.title=r.title,this.queryString=r.fullPath.split("?")[1],this.timestamp=r.timestamp,this._staleCallback=function(){},this.queryString&&Davis.utils.forEach(this.queryString.split("&"),function(e){var t=e.split("=")[0],n=e.split("=")[1],r=/^(\w+)\[(\w+)?\](\[\])?/,s;if(s=r.exec(t)){var o=s[1],t=s[2],u=!!s[3],a=i.params[o]||{};u?(a[t]=a[t]||[],a[t].push(decodeURIComponent(n)),i.params[o]=a):!t&&!u?(a=i.params[o]||[],a.push(decodeURIComponent(n)),i.params[o]=a):(a[t]=decodeURIComponent(n),i.params[o]=a)}else i.params[t]=decodeURIComponent(n)}),r.fullPath=r.fullPath.replace(/^https?:\/\/.+?\//,"/"),this.method=(this.params._method||r.method).toLowerCase(),this.path=r.fullPath.replace(/\?.+$/,"").replace(/^https?:\/\/[^\/]+/,""),this.fullPath=r.fullPath,this.delegateToServer=r.delegateToServer||Davis.noop,this.isForPageLoad=r.forPageLoad||!1,e.prev&&e.prev.makeStale(this),e.prev=this};return e.prototype.redirect=function(t){Davis.location.replace(new e({method:"get",fullPath:t,title:this.title}))},e.prototype.whenStale=function(e){this._staleCallback=e},e.prototype.makeStale=function(e){this._staleCallback.call(e,e)},e.prototype.location=function(){return this.method==="get"?this.fullPath:""},e.prototype.toString=function(){return[this.method.toUpperCase(),this.path].join(" ")},e.prototype.toJSON=function(){return{title:this.raw.title,fullPath:this.raw.fullPath,method:this.raw.method,timestamp:this.raw.timestamp}},e.forPageLoad=function(){return new this({method:"get",fullPath:Davis.location.current(),title:document.title,forPageLoad:!0})},e.prev=null,e}(),Davis.App=function(){function e(){this.running=!1,this.boundToInternalEvents=!1,this.use(Davis.listener),this.use(Davis.event),this.use(Davis.router),this.use(Davis.logger)}return e.prototype.configure=function(e){e.call(this.settings,this.settings)},e.prototype.use=function(e){e.apply(this,Davis.utils.toArray(arguments,1))},e.prototype.helpers=function(e){for(property in e)e.hasOwnProperty(property)&&(Davis.Request.prototype[property]=e[property])},e.prototype.settings={linkSelector:"a",formSelector:"form",throwErrors:!0,handleRouteNotFound:!1,generateRequestOnPageLoad:!1},e.prototype.start=function(){var e=this;if(this.running)return;if(!Davis.supported()){this.trigger("unsupported");return}var t=function(e){return function(t){var n=t.run(e,e);return typeof n=="undefined"||n}},n=function(n){return Davis.utils.every(e.lookupBeforeFilter(n.method,n.path),t(n))},r=function(r){if(n(r)){e.trigger("lookupRoute",r);var i=e.lookupRoute(r.method,r.path);if(i){e.trigger("runRoute",r,i);try{i.run(r),e.trigger("routeComplete",r,i)}catch(s){e.trigger("routeError",r,i,s)}Davis.utils.every(e.lookupAfterFilter(r.method,r.path),t(r))}else e.trigger("routeNotFound",r)}else e.trigger("requestHalted",r)},i=function(){e.bind("runRoute",function(t){e.logger.info("runRoute: "+t.toString())}).bind("routeNotFound",function(t){!e.settings.handleRouteNotFound&&!t.isForPageLoad&&(e.stop(),t.delegateToServer()),e.logger.warn("routeNotFound: "+t.toString())}).bind("start",function(){e.logger.info("application started")}).bind("stop",function(){e.logger.info("application stopped")}).bind("routeError",function(t,n,r){if(e.settings.throwErrors)throw r;e.logger.error(r.message,r.stack)}),Davis.location.onChange(function(e){r(e)}),e.boundToInternalEvents=!0};this.boundToInternalEvents||i(),this.listen(),this.trigger("start"),this.running=!0,this.settings.generateRequestOnPageLoad&&r(Davis.Request.forPageLoad())},e.prototype.stop=function(){this.unlisten(),this.trigger("stop"),this.running=!1},e}();(function(){var e=this,t=e._,n={},r=Array.prototype,i=Object.prototype,s=Function.prototype,o=r.push,u=r.slice,a=r.concat,f=i.toString,l=i.hasOwnProperty,c=r.forEach,h=r.map,p=r.reduce,d=r.reduceRight,v=r.filter,m=r.every,g=r.some,y=r.indexOf,b=r.lastIndexOf,w=Array.isArray,E=Object.keys,S=s.bind,x=function(e){if(e instanceof x)return e;if(!(this instanceof x))return new x(e);this._wrapped=e};typeof exports!="undefined"?(typeof module!="undefined"&&module.exports&&(exports=module.exports=x),exports._=x):e._=x,x.VERSION="1.5.2";var T=x.each=x.forEach=function(e,t,r){if(e==null)return;if(c&&e.forEach===c)e.forEach(t,r);else if(e.length===+e.length){for(var i=0,s=e.length;i<s;i++)if(t.call(r,e[i],i,e)===n)return}else{var o=x.keys(e);for(var i=0,s=o.length;i<s;i++)if(t.call(r,e[o[i]],o[i],e)===n)return}};x.map=x.collect=function(e,t,n){var r=[];return e==null?r:h&&e.map===h?e.map(t,n):(T(e,function(e,i,s){r.push(t.call(n,e,i,s))}),r)};var N="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(p&&e.reduce===p)return r&&(t=x.bind(t,r)),i?e.reduce(t,n):e.reduce(t);T(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)});if(!i)throw new TypeError(N);return n},x.reduceRight=x.foldr=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(d&&e.reduceRight===d)return r&&(t=x.bind(t,r)),i?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=x.keys(e);s=o.length}T(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)});if(!i)throw new TypeError(N);return n},x.find=x.detect=function(e,t,n){var r;return C(e,function(e,i,s){if(t.call(n,e,i,s))return r=e,!0}),r},x.filter=x.select=function(e,t,n){var r=[];return e==null?r:v&&e.filter===v?e.filter(t,n):(T(e,function(e,i,s){t.call(n,e,i,s)&&r.push(e)}),r)},x.reject=function(e,t,n){return x.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)},x.every=x.all=function(e,t,r){t||(t=x.identity);var i=!0;return e==null?i:m&&e.every===m?e.every(t,r):(T(e,function(e,s,o){if(!(i=i&&t.call(r,e,s,o)))return n}),!!i)};var C=x.some=x.any=function(e,t,r){t||(t=x.identity);var i=!1;return e==null?i:g&&e.some===g?e.some(t,r):(T(e,function(e,s,o){if(i||(i=t.call(r,e,s,o)))return n}),!!i)};x.contains=x.include=function(e,t){return e==null?!1:y&&e.indexOf===y?e.indexOf(t)!=-1:C(e,function(e){return e===t})},x.invoke=function(e,t){var n=u.call(arguments,2),r=x.isFunction(t);return x.map(e,function(e){return(r?t:e[t]).apply(e,n)})},x.pluck=function(e,t){return x.map(e,function(e){return e[t]})},x.where=function(e,t,n){return x.isEmpty(t)?n?void 0:[]:x[n?"find":"filter"](e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},x.findWhere=function(e,t){return x.where(e,t,!0)},x.max=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&x.isEmpty(e))return-Infinity;var r={computed:-Infinity,value:-Infinity};return T(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o>r.computed&&(r={value:e,computed:o})}),r.value},x.min=function(e,t,n){if(!t&&x.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&x.isEmpty(e))return Infinity;var r={computed:Infinity,value:Infinity};return T(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o<r.computed&&(r={value:e,computed:o})}),r.value},x.shuffle=function(e){var t,n=0,r=[];return T(e,function(e){t=x.random(n++),r[n-1]=r[t],r[t]=e}),r},x.sample=function(e,t,n){return arguments.length<2||n?e[x.random(e.length-1)]:x.shuffle(e).slice(0,Math.max(0,t))};var k=function(e){return x.isFunction(e)?e:function(t){return t[e]}};x.sortBy=function(e,t,n){var r=k(t);return x.pluck(x.map(e,function(e,t,i){return{value:e,index:t,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(n<r||r===void 0)return-1}return e.index-t.index}),"value")};var L=function(e){return function(t,n,r){var i={},s=n==null?x.identity:k(n);return T(t,function(n,o){var u=s.call(r,n,o,t);e(i,u,n)}),i}};x.groupBy=L(function(e,t,n){(x.has(e,t)?e[t]:e[t]=[]).push(n)}),x.indexBy=L(function(e,t,n){e[t]=n}),x.countBy=L(function(e,t){x.has(e,t)?e[t]++:e[t]=1}),x.sortedIndex=function(e,t,n,r){n=n==null?x.identity:k(n);var i=n.call(r,t),s=0,o=e.length;while(s<o){var u=s+o>>>1;n.call(r,e[u])<i?s=u+1:o=u}return s},x.toArray=function(e){return e?x.isArray(e)?u.call(e):e.length===+e.length?x.map(e,x.identity):x.values(e):[]},x.size=function(e){return e==null?0:e.length===+e.length?e.length:x.keys(e).length},x.first=x.head=x.take=function(e,t,n){return e==null?void 0:t==null||n?e[0]:u.call(e,0,t)},x.initial=function(e,t,n){return u.call(e,0,e.length-(t==null||n?1:t))},x.last=function(e,t,n){return e==null?void 0:t==null||n?e[e.length-1]:u.call(e,Math.max(e.length-t,0))},x.rest=x.tail=x.drop=function(e,t,n){return u.call(e,t==null||n?1:t)},x.compact=function(e){return x.filter(e,x.identity)};var A=function(e,t,n){return t&&x.every(e,x.isArray)?a.apply(n,e):(T(e,function(e){x.isArray(e)||x.isArguments(e)?t?o.apply(n,e):A(e,t,n):n.push(e)}),n)};x.flatten=function(e,t){return A(e,t,[])},x.without=function(e){return x.difference(e,u.call(arguments,1))},x.uniq=x.unique=function(e,t,n,r){x.isFunction(t)&&(r=n,n=t,t=!1);var i=n?x.map(e,n,r):e,s=[],o=[];return T(i,function(n,r){if(t?!r||o[o.length-1]!==n:!x.contains(o,n))o.push(n),s.push(e[r])}),s},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(e){var t=u.call(arguments,1);return x.filter(x.uniq(e),function(e){return x.every(t,function(t){return x.indexOf(t,e)>=0})})},x.difference=function(e){var t=a.apply(r,u.call(arguments,1));return x.filter(e,function(e){return!x.contains(t,e)})},x.zip=function(){var e=x.max(x.pluck(arguments,"length").concat(0)),t=new Array(e);for(var n=0;n<e;n++)t[n]=x.pluck(arguments,""+n);return t},x.object=function(e,t){if(e==null)return{};var n={};for(var r=0,i=e.length;r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},x.indexOf=function(e,t,n){if(e==null)return-1;var r=0,i=e.length;if(n){if(typeof n!="number")return r=x.sortedIndex(e,t),e[r]===t?r:-1;r=n<0?Math.max(0,i+n):n}if(y&&e.indexOf===y)return e.indexOf(t,n);for(;r<i;r++)if(e[r]===t)return r;return-1},x.lastIndexOf=function(e,t,n){if(e==null)return-1;var r=n!=null;if(b&&e.lastIndexOf===b)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);var i=r?n:e.length;while(i--)if(e[i]===t)return i;return-1},x.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);while(i<r)s[i++]=e,e+=n;return s};var O=function(){};x.bind=function(e,t){var n,r;if(S&&e.bind===S)return S.apply(e,u.call(arguments,1));if(!x.isFunction(e))throw new TypeError;return n=u.call(arguments,2),r=function(){if(this instanceof r){O.prototype=e.prototype;var i=new O;O.prototype=null;var s=e.apply(i,n.concat(u.call(arguments)));return Object(s)===s?s:i}return e.apply(t,n.concat(u.call(arguments)))}},x.partial=function(e){var t=u.call(arguments,1);return function(){return e.apply(this,t.concat(u.call(arguments)))}},x.bindAll=function(e){var t=u.call(arguments,1);if(t.length===0)throw new Error("bindAll must be passed function names");return T(t,function(t){e[t]=x.bind(e[t],e)}),e},x.memoize=function(e,t){var n={};return t||(t=x.identity),function(){var r=t.apply(this,arguments);return x.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},x.delay=function(e,t){var n=u.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},x.defer=function(e){return x.delay.apply(x,[e,1].concat(u.call(arguments,1)))},x.throttle=function(e,t,n){var r,i,s,o=null,u=0;n||(n={});var a=function(){u=n.leading===!1?0:new Date,o=null,s=e.apply(r,i)};return function(){var f=new Date;!u&&n.leading===!1&&(u=f);var l=t-(f-u);return r=this,i=arguments,l<=0?(clearTimeout(o),o=null,u=f,s=e.apply(r,i)):!o&&n.trailing!==!1&&(o=setTimeout(a,l)),s}},x.debounce=function(e,t,n){var r,i,s,o,u;return function(){s=this,i=arguments,o=new Date;var a=function(){var f=new Date-o;f<t?r=setTimeout(a,t-f):(r=null,n||(u=e.apply(s,i)))},f=n&&!r;return r||(r=setTimeout(a,t)),f&&(u=e.apply(s,i)),u}},x.once=function(e){var t=!1,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}},x.wrap=function(e,t){return function(){var n=[e];return o.apply(n,arguments),t.apply(this,n)}},x.compose=function(){var e=arguments;return function(){var t=arguments;for(var n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},x.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},x.keys=E||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)x.has(e,n)&&t.push(n);return t},x.values=function(e){var t=x.keys(e),n=t.length,r=new Array(n);for(var i=0;i<n;i++)r[i]=e[t[i]];return r},x.pairs=function(e){var t=x.keys(e),n=t.length,r=new Array(n);for(var i=0;i<n;i++)r[i]=[t[i],e[t[i]]];return r},x.invert=function(e){var t={},n=x.keys(e);for(var r=0,i=n.length;r<i;r++)t[e[n[r]]]=n[r];return t},x.functions=x.methods=function(e){var t=[];for(var n in e)x.isFunction(e[n])&&t.push(n);return t.sort()},x.extend=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},x.pick=function(e){var t={},n=a.apply(r,u.call(arguments,1));return T(n,function(n){n in e&&(t[n]=e[n])}),t},x.omit=function(e){var t={},n=a.apply(r,u.call(arguments,1));for(var i in e)x.contains(n,i)||(t[i]=e[i]);return t},x.defaults=function(e){return T(u.call(arguments,1),function(t){if(t)for(var n in t)e[n]===void 0&&(e[n]=t[n])}),e},x.clone=function(e){return x.isObject(e)?x.isArray(e)?e.slice():x.extend({},e):e},x.tap=function(e,t){return t(e),e};var M=function(e,t,n,r){if(e===t)return e!==0||1/e==1/t;if(e==null||t==null)return e===t;e instanceof x&&(e=e._wrapped),t instanceof x&&(t=t._wrapped);var i=f.call(e);if(i!=f.call(t))return!1;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if(typeof e!="object"||typeof t!="object")return!1;var s=n.length;while(s--)if(n[s]==e)return r[s]==t;var o=e.constructor,u=t.constructor;if(o!==u&&!(x.isFunction(o)&&o instanceof o&&x.isFunction(u)&&u instanceof u))return!1;n.push(e),r.push(t);var a=0,l=!0;if(i=="[object Array]"){a=e.length,l=a==t.length;if(l)while(a--)if(!(l=M(e[a],t[a],n,r)))break}else{for(var c in e)if(x.has(e,c)){a++;if(!(l=x.has(t,c)&&M(e[c],t[c],n,r)))break}if(l){for(c in t)if(x.has(t,c)&&!(a--))break;l=!a}}return n.pop(),r.pop(),l};x.isEqual=function(e,t){return M(e,t,[],[])},x.isEmpty=function(e){if(e==null)return!0;if(x.isArray(e)||x.isString(e))return e.length===0;for(var t in e)if(x.has(e,t))return!1;return!0},x.isElement=function(e){return!!e&&e.nodeType===1},x.isArray=w||function(e){return f.call(e)=="[object Array]"},x.isObject=function(e){return e===Object(e)},T(["Arguments","Function","String","Number","Date","RegExp"],function(e){x["is"+e]=function(t){return f.call(t)=="[object "+e+"]"}}),x.isArguments(arguments)||(x.isArguments=function(e){return!!e&&!!x.has(e,"callee")}),typeof /./!="function"&&(x.isFunction=function(e){return typeof e=="function"}),x.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},x.isNaN=function(e){return x.isNumber(e)&&e!=+e},x.isBoolean=function(e){return e===!0||e===!1||f.call(e)=="[object Boolean]"},x.isNull=function(e){return e===null},x.isUndefined=function(e){return e===void 0},x.has=function(e,t){return l.call(e,t)},x.noConflict=function(){return e._=t,this},x.identity=function(e){return e},x.times=function(e,t,n){var r=Array(Math.max(0,e));for(var i=0;i<e;i++)r[i]=t.call(n,i);return r},x.random=function(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var _={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};_.unescape=x.invert(_.escape);var D={escape:new RegExp("["+x.keys(_.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(_.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(e){x[e]=function(t){return t==null?"":(""+t).replace(D[e],function(t){return _[e][t]})}}),x.result=function(e,t){if(e==null)return void 0;var n=e[t];return x.isFunction(n)?n.call(e):n},x.mixin=function(e){T(x.functions(e),function(t){var n=x[t]=e[t];x.prototype[t]=function(){var e=[this._wrapped];return o.apply(e,arguments),F.call(this,n.apply(x,e))}})};var P=0;x.uniqueId=function(e){var t=++P+"";return e?e+t:t},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var H=/(.)^/,B={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},j=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(e,t,n){var r;n=x.defaults({},n,x.templateSettings);var i=new RegExp([(n.escape||H).source,(n.interpolate||H).source,(n.evaluate||H).source].join("|")+"|$","g"),s=0,o="__p+='";e.replace(i,function(t,n,r,i,u){return o+=e.slice(s,u).replace(j,function(e){return"\\"+B[e]}),n&&(o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(o+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(o+="';\n"+i+"\n__p+='"),s=u+t.length,t}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{r=new Function(n.variable||"obj","_",o)}catch(u){throw u.source=o,u}if(t)return r(t,x);var a=function(e){return r.call(this,e,x)};return a.source="function("+(n.variable||"obj")+"){\n"+o+"}",a},x.chain=function(e){return x(e).chain()};var F=function(e){return this._chain?x(e).chain():e};x.mixin(x),T(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=r[e];x.prototype[e]=function(){var n=this._wrapped;return t.apply(n,arguments),(e=="shift"||e=="splice")&&n.length===0&&delete n[0],F.call(this,n)}}),T(["concat","join","slice"],function(e){var t=r[e];x.prototype[e]=function(){return F.call(this,t.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}).call(this);!function(e){e(function(){"use strict",e.support.transition=function(){var e=function(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},n;for(n in t)if(e.style[n]!==undefined)return t[n]}();return e&&{end:e}}()})}(window.jQuery),!function(e){"use strict";var t='[data-dismiss="alert"]',n=function(n){e(n).on("click",t,this.close)};n.prototype.close=function(t){function n(){s.trigger("closed").remove()}var r=e(this),i=r.attr("data-target"),s;i||(i=r.attr("href"),i=i&&i.replace(/.*(?=#[^\s]*$)/,"")),s=e(i),t&&t.preventDefault(),s.length||(s=r.hasClass("alert")?r:r.parent()),s.trigger(t=e.Event("close"));if(t.isDefaultPrevented())return;s.removeClass("in"),e.support.transition&&s.hasClass("fade")?s.on(e.support.transition.end,n):n()},e.fn.alert=function(t){return this.each(function(){var r=e(this),i=r.data("alert");i||r.data("alert",i=new n(this)),typeof t=="string"&&i[t].call(r)})},e.fn.alert.Constructor=n,e(function(){e("body").on("click.alert.data-api",t,n.prototype.close)})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.button.defaults,n)};t.prototype.setState=function(e){var t="disabled",n=this.$element,r=n.data(),i=n.is("input")?"val":"html";e+="Text",r.resetText||n.data("resetText",n[i]()),n[i](r[e]||this.options[e]),setTimeout(function(){e=="loadingText"?n.addClass(t).attr(t,t):n.removeClass(t).removeAttr(t)},0)},t.prototype.toggle=function(){var e=this.$element.parent('[data-toggle="buttons-radio"]');e&&e.find(".active").removeClass("active"),this.$element.toggleClass("active")},e.fn.button=function(n){return this.each(function(){var r=e(this),i=r.data("button"),s=typeof n=="object"&&n;i||r.data("button",i=new t(this,s)),n=="toggle"?i.toggle():n&&i.setState(n)})},e.fn.button.defaults={loadingText:"loading..."},e.fn.button.Constructor=t,e(function(){e("body").on("click.button.data-api","[data-toggle^=button]",function(t){var n=e(t.target);n.hasClass("btn")||(n=n.closest(".btn")),n.button("toggle")})})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=n,this.options.slide&&this.slide(this.options.slide),this.options.pause=="hover"&&this.$element.on("mouseenter",e.proxy(this.pause,this)).on("mouseleave",e.proxy(this.cycle,this))};t.prototype={cycle:function(t){return t||(this.paused=!1),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},to:function(t){var n=this.$element.find(".active"),r=n.parent().children(),i=r.index(n),s=this;if(t>r.length-1||t<0)return;return this.sliding?this.$element.one("slid",function(){s.to(t)}):i==t?this.pause().cycle():this.slide(t>i?"next":"prev",e(r[t]))},pause:function(e){return e||(this.paused=!0),clearInterval(this.interval),this.interval=null,this},next:function(){if(this.sliding)return;return this.slide("next")},prev:function(){if(this.sliding)return;return this.slide("prev")},slide:function(t,n){var r=this.$element.find(".active"),i=n||r[t](),s=this.interval,o=t=="next"?"left":"right",u=t=="next"?"first":"last",f=this,l=e.Event("slide");this.sliding=!0,s&&this.pause(),i=i.length?i:this.$element.find(".item")[u]();if(i.hasClass("active"))return;if(e.support.transition&&this.$element.hasClass("slide")){this.$element.trigger(l);if(l.isDefaultPrevented())return;i.addClass(t),i[0].offsetWidth,r.addClass(o),i.addClass(o),this.$element.one(e.support.transition.end,function(){i.removeClass([t,o].join(" ")).addClass("active"),r.removeClass(["active",o].join(" ")),f.sliding=!1,setTimeout(function(){f.$element.trigger("slid")},0)})}else{this.$element.trigger(l);if(l.isDefaultPrevented())return;r.removeClass("active"),i.addClass("active"),this.sliding=!1,this.$element.trigger("slid")}return s&&this.cycle(),this}},e.fn.carousel=function(n){return this.each(function(){var r=e(this),i=r.data("carousel"),s=e.extend({},e.fn.carousel.defaults,typeof n=="object"&&n);i||r.data("carousel",i=new t(this,s)),typeof n=="number"?i.to(n):typeof n=="string"||(n=s.slide)?i[n]():s.interval&&i.cycle()})},e.fn.carousel.defaults={interval:5e3,pause:"hover"},e.fn.carousel.Constructor=t,e(function(){e("body").on("click.carousel.data-api","[data-slide]",function(t){var n=e(this),r,i=e(n.attr("data-target")||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,"")),s=!i.data("modal")&&e.extend({},i.data(),n.data());i.carousel(s),t.preventDefault()})})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.collapse.defaults,n),this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};t.prototype={constructor:t,dimension:function(){var e=this.$element.hasClass("width");return e?"width":"height"},show:function(){var t,n,r,i;if(this.transitioning)return;t=this.dimension(),n=e.camelCase(["scroll",t].join("-")),r=this.$parent&&this.$parent.find("> .accordion-group > .in");if(r&&r.length){i=r.data("collapse");if(i&&i.transitioning)return;r.collapse("hide"),i||r.data("collapse",null)}this.$element[t](0),this.transition("addClass",e.Event("show"),"shown"),this.$element[t](this.$element[0][n])},hide:function(){var t;if(this.transitioning)return;t=this.dimension(),this.reset(this.$element[t]()),this.transition("removeClass",e.Event("hide"),"hidden"),this.$element[t](0)},reset:function(e){var t=this.dimension();return this.$element.removeClass("collapse")[t](e||"auto")[0].offsetWidth,this.$element[e!==null?"addClass":"removeClass"]("collapse"),this},transition:function(t,n,r){var i=this,s=function(){n.type=="show"&&i.reset(),i.transitioning=0,i.$element.trigger(r)};this.$element.trigger(n);if(n.isDefaultPrevented())return;this.transitioning=1,this.$element[t]("in"),e.support.transition&&this.$element.hasClass("collapse")?this.$element.one(e.support.transition.end,s):s()},toggle:function(){this[this.$element.hasClass("in")?"hide":"show"]()}},e.fn.collapse=function(n){return this.each(function(){var r=e(this),i=r.data("collapse"),s=typeof n=="object"&&n;i||r.data("collapse",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.collapse.defaults={toggle:!0},e.fn.collapse.Constructor=t,e(function(){e("body").on("click.collapse.data-api","[data-toggle=collapse]",function(t){var n=e(this),r,i=n.attr("data-target")||t.preventDefault()||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,""),s=e(i).data("collapse")?"toggle":n.data();e(i).collapse(s)})})}(window.jQuery),!function(e){function t(){e(n).parent().removeClass("open")}"use strict";var n='[data-toggle="dropdown"]',r=function(t){var n=e(t).on("click.dropdown.data-api",this.toggle);e("html").on("click.dropdown.data-api",function(){n.parent().removeClass("open")})};r.prototype={constructor:r,toggle:function(n){var r=e(this),i,s,o;if(r.is(".disabled, :disabled"))return;return s=r.attr("data-target"),s||(s=r.attr("href"),s=s&&s.replace(/.*(?=#[^\s]*$)/,"")),i=e(s),i.length||(i=r.parent()),o=i.hasClass("open"),t(),o||i.toggleClass("open"),!1}},e.fn.dropdown=function(t){return this.each(function(){var n=e(this),i=n.data("dropdown");i||n.data("dropdown",i=new r(this)),typeof t=="string"&&i[t].call(n)})},e.fn.dropdown.Constructor=r,e(function(){e("html").on("click.dropdown.data-api",t),e("body").on("click.dropdown",".dropdown form",function(e){e.stopPropagation()}).on("click.dropdown.data-api",n,r.prototype.toggle)})}(window.jQuery),!function(e){function t(){var t=this,r=setTimeout(function(){t.$element.off(e.support.transition.end),n.call(t)},500);this.$element.one(e.support.transition.end,function(){clearTimeout(r),n.call(t)})}function n(e){this.$element.hide().trigger("hidden"),r.call(this)}function r(t){var n=this,r=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var s=e.support.transition&&r;this.$backdrop=e('<div class="modal-backdrop '+r+'" />').appendTo(document.body),this.options.backdrop!="static"&&this.$backdrop.click(e.proxy(this.hide,this)),s&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),s?this.$backdrop.one(e.support.transition.end,t):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,e.proxy(i,this)):i.call(this)):t&&t()}function i(){this.$backdrop.remove(),this.$backdrop=null}function s(){var t=this;this.isShown&&this.options.keyboard?e(document).on("keyup.dismiss.modal",function(e){e.which==27&&t.hide()}):this.isShown||e(document).off("keyup.dismiss.modal")}"use strict";var o=function(t,n){this.options=n,this.$element=e(t).delegate('[data-dismiss="modal"]',"click.dismiss.modal",e.proxy(this.hide,this))};o.prototype={constructor:o,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=this,n=e.Event("show");this.$element.trigger(n);if(this.isShown||n.isDefaultPrevented())return;e("body").addClass("modal-open"),this.isShown=!0,s.call(this),r.call(this,function(){var n=e.support.transition&&t.$element.hasClass("fade");t.$element.parent().length||t.$element.appendTo(document.body),t.$element.show(),n&&t.$element[0].offsetWidth,t.$element.addClass("in"),n?t.$element.one(e.support.transition.end,function(){t.$element.trigger("shown")}):t.$element.trigger("shown")})},hide:function(r){r&&r.preventDefault();var i=this;r=e.Event("hide"),this.$element.trigger(r);if(!this.isShown||r.isDefaultPrevented())return;this.isShown=!1,e("body").removeClass("modal-open"),s.call(this),this.$element.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?t.call(this):n.call(this)}},e.fn.modal=function(t){return this.each(function(){var n=e(this),r=n.data("modal"),i=e.extend({},e.fn.modal.defaults,n.data(),typeof t=="object"&&t);r||n.data("modal",r=new o(this,i)),typeof t=="string"?r[t]():i.show&&r.show()})},e.fn.modal.defaults={backdrop:!0,keyboard:!0,show:!0},e.fn.modal.Constructor=o,e(function(){e("body").on("click.modal.data-api",'[data-toggle="modal"]',function(t){var n=e(this),r,i=e(n.attr("data-target")||(r=n.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,"")),s=i.data("modal")?"toggle":e.extend({},i.data(),n.data());t.preventDefault(),i.modal(s)})})}(window.jQuery),!function(e){"use strict";var t=function(e,t){this.init("tooltip",e,t)};t.prototype={constructor:t,init:function(t,n,r){var i,s;this.type=t,this.$element=e(n),this.options=this.getOptions(r),this.enabled=!0,this.options.trigger!="manual"&&(i=this.options.trigger=="hover"?"mouseenter":"focus",s=this.options.trigger=="hover"?"mouseleave":"blur",this.$element.on(i,this.options.selector,e.proxy(this.enter,this)),this.$element.on(s,this.options.selector,e.proxy(this.leave,this))),this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(t){return t=e.extend({},e.fn[this.type].defaults,t,this.$element.data()),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},enter:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);if(!n.options.delay||!n.options.delay.show)return n.show();clearTimeout(this.timeout),n.hoverState="in",this.timeout=setTimeout(function(){n.hoverState=="in"&&n.show()},n.options.delay.show)},leave:function(t){var n=e(t.currentTarget)[this.type](this._options).data(this.type);this.timeout&&clearTimeout(this.timeout);if(!n.options.delay||!n.options.delay.hide)return n.hide();n.hoverState="out",this.timeout=setTimeout(function(){n.hoverState=="out"&&n.hide()},n.options.delay.hide)},show:function(){var e,t,n,r,i,s,o;if(this.hasContent()&&this.enabled){e=this.tip(),this.setContent(),this.options.animation&&e.addClass("fade"),s=typeof this.options.placement=="function"?this.options.placement.call(this,e[0],this.$element[0]):this.options.placement,t=/in/.test(s),e.remove().css({top:0,left:0,display:"block"}).appendTo(t?this.$element:document.body),n=this.getPosition(t),r=e[0].offsetWidth,i=e[0].offsetHeight;switch(t?s.split(" ")[1]:s){case"bottom":o={top:n.top+n.height,left:n.left+n.width/2-r/2};break;case"top":o={top:n.top-i,left:n.left+n.width/2-r/2};break;case"left":o={top:n.top+n.height/2-i/2,left:n.left-r};break;case"right":o={top:n.top+n.height/2-i/2,left:n.left+n.width}}e.css(o).addClass(s).addClass("in")}},isHTML:function(e){return typeof e!="string"||e.charAt(0)==="<"&&e.charAt(e.length-1)===">"&&e.length>=3||/^(?:[^<]*<[\w\W]+>[^>]*$)/.exec(e)},setContent:function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.isHTML(t)?"html":"text"](t),e.removeClass("fade in top bottom left right")},hide:function(){function t(){var t=setTimeout(function(){r.off(e.support.transition.end).remove()},500);r.one(e.support.transition.end,function(){clearTimeout(t),r.remove()})}var n=this,r=this.tip();r.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?t():r.remove()},fixTitle:function(){var e=this.$element;(e.attr("title")||typeof e.attr("data-original-title")!="string")&&e.attr("data-original-title",e.attr("title")||"").removeAttr("title")},hasContent:function(){return this.getTitle()},getPosition:function(t){return e.extend({},t?{top:0,left:0}:this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight})},getTitle:function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title),e},tip:function(){return this.$tip=this.$tip||e(this.options.template)},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(){this[this.tip().hasClass("in")?"hide":"show"]()}},e.fn.tooltip=function(n){return this.each(function(){var r=e(this),i=r.data("tooltip"),s=typeof n=="object"&&n;i||r.data("tooltip",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.defaults={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover",title:"",delay:0}}(window.jQuery),!function(e){"use strict";var t=function(e,t){this.init("popover",e,t)};t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype,{constructor:t,setContent:function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".popover-title")[this.isHTML(t)?"html":"text"](t),e.find(".popover-content > *")[this.isHTML(n)?"html":"text"](n),e.removeClass("fade top bottom left right in")},hasContent:function(){return this.getTitle()||this.getContent()},getContent:function(){var e,t=this.$element,n=this.options;return e=t.attr("data-content")||(typeof n.content=="function"?n.content.call(t[0]):n.content),e},tip:function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip}}),e.fn.popover=function(n){return this.each(function(){var r=e(this),i=r.data("popover"),s=typeof n=="object"&&n;i||r.data("popover",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.popover.Constructor=t,e.fn.popover.defaults=e.extend({},e.fn.tooltip.defaults,{placement:"right",content:"",template:'<div class="popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'})}(window.jQuery),!function(e){function t(t,n){var r=e.proxy(this.process,this),i=e(t).is("body")?e(window):e(t),s;this.options=e.extend({},e.fn.scrollspy.defaults,n),this.$scrollElement=i.on("scroll.scroll.data-api",r),this.selector=(this.options.target||(s=e(t).attr("href"))&&s.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.$body=e("body"),this.refresh(),this.process()}"use strict",t.prototype={constructor:t,refresh:function(){var t=this,n;this.offsets=e([]),this.targets=e([]),n=this.$body.find(this.selector).map(function(){var t=e(this),n=t.data("target")||t.attr("href"),r=/^#\w/.test(n)&&e(n);return r&&n.length&&[[r.position().top,n]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){t.offsets.push(this[0]),t.targets.push(this[1])})},process:function(){var e=this.$scrollElement.scrollTop()+this.options.offset,t=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,n=t-this.$scrollElement.height(),r=this.offsets,i=this.targets,s=this.activeTarget,o;if(e>=n)return s!=(o=i.last()[0])&&this.activate(o);for(o=r.length;o--;)s!=i[o]&&e>=r[o]&&(!r[o+1]||e<=r[o+1])&&this.activate(i[o])},activate:function(t){var n,r;this.activeTarget=t,e(this.selector).parent(".active").removeClass("active"),r=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',n=e(r).parent("li").addClass("active"),n.parent(".dropdown-menu")&&(n=n.closest("li.dropdown").addClass("active")),n.trigger("activate")}},e.fn.scrollspy=function(n){return this.each(function(){var r=e(this),i=r.data("scrollspy"),s=typeof n=="object"&&n;i||r.data("scrollspy",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.scrollspy.Constructor=t,e.fn.scrollspy.defaults={offset:10},e(function(){e('[data-spy="scroll"]').each(function(){var t=e(this);t.scrollspy(t.data())})})}(window.jQuery),!function(e){"use strict";var t=function(t){this.element=e(t)};t.prototype={constructor:t,show:function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),r=t.attr("data-target"),i,s,o;r||(r=t.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));if(t.parent("li").hasClass("active"))return;i=n.find(".active a").last()[0],o=e.Event("show",{relatedTarget:i}),t.trigger(o);if(o.isDefaultPrevented())return;s=e(r),this.activate(t.parent("li"),n),this.activate(s,s.parent(),function(){t.trigger({type:"shown",relatedTarget:i})})},activate:function(t,n,r){function i(){s.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),o?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),r&&r()}var s=n.find("> .active"),o=r&&e.support.transition&&s.hasClass("fade");o?s.one(e.support.transition.end,i):i(),s.removeClass("in")}},e.fn.tab=function(n){return this.each(function(){var r=e(this),i=r.data("tab");i||r.data("tab",i=new t(this)),typeof n=="string"&&i[n]()})},e.fn.tab.Constructor=t,e(function(){e("body").on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(t){t.preventDefault(),e(this).tab("show")})})}(window.jQuery),!function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.typeahead.defaults,n),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.$menu=e(this.options.menu).appendTo("body"),this.source=this.options.source,this.shown=!1,this.listen()};t.prototype={constructor:t,select:function(){var e=this.$menu.find(".active").attr("data-value");return this.$element.val(this.updater(e)).change(),this.hide()},updater:function(e){return e},show:function(){var t=e.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight});return this.$menu.css({top:t.top+t.height,left:t.left}),this.$menu.show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(t){var n=this,r,i;return this.query=this.$element.val(),this.query?(r=e.grep(this.source,function(e){return n.matcher(e)}),r=this.sorter(r),r.length?this.render(r.slice(0,this.options.items)).show():this.shown?this.hide():this):this.shown?this.hide():this},matcher:function(e){return~e.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(e){var t=[],n=[],r=[],i;while(i=e.shift())i.toLowerCase().indexOf(this.query.toLowerCase())?~i.indexOf(this.query)?n.push(i):r.push(i):t.push(i);return t.concat(n,r)},highlighter:function(e){var t=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return e.replace(new RegExp("("+t+")","ig"),function(e,t){return"<strong>"+t+"</strong>"})},render:function(t){var n=this;return t=e(t).map(function(t,r){return t=e(n.options.item).attr("data-value",r),t.find("a").html(n.highlighter(r)),t[0]}),t.first().addClass("active"),this.$menu.html(t),this},next:function(t){var n=this.$menu.find(".active").removeClass("active"),r=n.next();r.length||(r=e(this.$menu.find("li")[0])),r.addClass("active")},prev:function(e){var t=this.$menu.find(".active").removeClass("active"),n=t.prev();n.length||(n=this.$menu.find("li").last()),n.addClass("active")},listen:function(){this.$element.on("blur",e.proxy(this.blur,this)).on("keypress",e.proxy(this.keypress,this)).on("keyup",e.proxy(this.keyup,this)),(e.browser.webkit||e.browser.msie)&&this.$element.on("keydown",e.proxy(this.keypress,this)),this.$menu.on("click",e.proxy(this.click,this)).on("mouseenter","li",e.proxy(this.mouseenter,this))},keyup:function(e){switch(e.keyCode){case 40:case 38:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}e.stopPropagation(),e.preventDefault()},keypress:function(e){if(!this.shown)return;switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:if(e.type!="keydown")break;e.preventDefault(),this.prev();break;case 40:if(e.type!="keydown")break;e.preventDefault(),this.next()}e.stopPropagation()},blur:function(e){var t=this;setTimeout(function(){t.hide()},150)},click:function(e){e.stopPropagation(),e.preventDefault(),this.select()},mouseenter:function(t){this.$menu.find(".active").removeClass("active"),e(t.currentTarget).addClass("active")}},e.fn.typeahead=function(n){return this.each(function(){var r=e(this),i=r.data("typeahead"),s=typeof n=="object"&&n;i||r.data("typeahead",i=new t(this,s)),typeof n=="string"&&i[n]()})},e.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>'},e.fn.typeahead.Constructor=t,e(function(){e("body").on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var n=e(this);if(n.data("typeahead"))return;t.preventDefault(),n.typeahead(n.data())})})}(window.jQuery);(function(){function e(e,t){try{for(var n in t)Object.defineProperty(e.prototype,n,{value:t[n],enumerable:!1})}catch(r){e.prototype=t}}function t(e){var t=-1,n=e.length,r=[];while(++t<n)r.push(e[t]);return r}function n(e){return Array.prototype.slice.call(e)}function r(){}function i(e){return e}function s(){return this}function o(){return!0}function u(e){return typeof e=="function"?e:function(){return e}}function a(e,t,n){return function(){var r=n.apply(t,arguments);return arguments.length?e:r}}function f(e){return e!=null&&!isNaN(e)}function l(e){return e.length}function c(e){return e==null}function h(e){return e.trim().replace(/\s+/g," ")}function p(e){var t=1;while(e*t%1)t*=10;return t}function d(){}function v(e){function t(){var t=n,r=-1,i=t.length,s;while(++r<i)(s=t[r].on)&&s.apply(this,arguments);return e}var n=[],i=new r;return t.on=function(t,r){var s=i.get(t),o;return arguments.length<2?s&&s.on:(s&&(s.on=null,n=n.slice(0,o=n.indexOf(s)).concat(n.slice(o+1)),i.remove(t)),r&&n.push(i.set(t,{on:r})),e)},t}function m(e,t){return t-(e?1+Math.floor(Math.log(e+Math.pow(10,1+Math.floor(Math.log(e)/Math.LN10)-t))/Math.LN10):1)}function g(e){return e+""}function y(e){var t=e.lastIndexOf("."),n=t>=0?e.substring(t):(t=e.length,""),r=[];while(t>0)r.push(e.substring(t-=3,t+3));return r.reverse().join(",")+n}function b(e,t){var n=Math.pow(10,Math.abs(8-t)*3);return{scale:t>8?function(e){return e/n}:function(e){return e*n},symbol:e}}function w(e){return function(t){return t<=0?0:t>=1?1:e(t)}}function E(e){return function(t){return 1-e(1-t)}}function S(e){return function(t){return.5*(t<.5?e(2*t):2-e(2-2*t))}}function x(e){return e}function T(e){return function(t){return Math.pow(t,e)}}function N(e){return 1-Math.cos(e*Math.PI/2)}function C(e){return Math.pow(2,10*(e-1))}function k(e){return 1-Math.sqrt(1-e*e)}function L(e,t){var n;return arguments.length<2&&(t=.45),arguments.length<1?(e=1,n=t/4):n=t/(2*Math.PI)*Math.asin(1/e),function(r){return 1+e*Math.pow(2,10*-r)*Math.sin((r-n)*2*Math.PI/t)}}function A(e){return e||(e=1.70158),function(t){return t*t*((e+1)*t-e)}}function O(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}function M(){d3.event.stopPropagation(),d3.event.preventDefault()}function _(){var e=d3.event,t;while(t=e.sourceEvent)e=t;return e}function D(e){var t=new d,n=0,r=arguments.length;while(++n<r)t[arguments[n]]=v(t);return t.of=function(n,r){return function(i){try{var s=i.sourceEvent=d3.event;i.target=e,d3.event=i,t[i.type].apply(n,r)}finally{d3.event=s}}},t}function P(e){var t=[e.a,e.b],n=[e.c,e.d],r=B(t),i=H(t,n),s=B(j(n,t,-i))||0;t[0]*n[1]<n[0]*t[1]&&(t[0]*=-1,t[1]*=-1,r*=-1,i*=-1),this.rotate=(r?Math.atan2(t[1],t[0]):Math.atan2(-n[0],n[1]))*ls,this.translate=[e.e,e.f],this.scale=[r,s],this.skew=s?Math.atan2(i,s)*ls:0}function H(e,t){return e[0]*t[0]+e[1]*t[1]}function B(e){var t=Math.sqrt(H(e,e));return t&&(e[0]/=t,e[1]/=t),t}function j(e,t,n){return e[0]+=n*t[0],e[1]+=n*t[1],e}function F(e){return e=="transform"?d3.interpolateTransform:d3.interpolate}function I(e,t){return t=t-(e=+e)?1/(t-e):0,function(n){return(n-e)*t}}function q(e,t){return t=t-(e=+e)?1/(t-e):0,function(n){return Math.max(0,Math.min(1,(n-e)*t))}}function R(){}function U(e,t,n){return new z(e,t,n)}function z(e,t,n){this.r=e,this.g=t,this.b=n}function W(e){return e<16?"0"+Math.max(0,e).toString(16):Math.min(255,e).toString(16)}function X(e,t,n){var r=0,i=0,s=0,o,u,a;o=/([a-z]+)\((.*)\)/i.exec(e);if(o){u=o[2].split(",");switch(o[1]){case"hsl":return n(parseFloat(u[0]),parseFloat(u[1])/100,parseFloat(u[2])/100);case"rgb":return t(K(u[0]),K(u[1]),K(u[2]))}}return(a=ds.get(e))?t(a.r,a.g,a.b):(e!=null&&e.charAt(0)==="#"&&(e.length===4?(r=e.charAt(1),r+=r,i=e.charAt(2),i+=i,s=e.charAt(3),s+=s):e.length===7&&(r=e.substring(1,3),i=e.substring(3,5),s=e.substring(5,7)),r=parseInt(r,16),i=parseInt(i,16),s=parseInt(s,16)),t(r,i,s))}function V(e,t,n){var r=Math.min(e/=255,t/=255,n/=255),i=Math.max(e,t,n),s=i-r,o,u,a=(i+r)/2;return s?(u=a<.5?s/(i+r):s/(2-i-r),e==i?o=(t-n)/s+(t<n?6:0):t==i?o=(n-e)/s+2:o=(e-t)/s+4,o*=60):u=o=0,Q(o,u,a)}function $(e,t,n){e=J(e),t=J(t),n=J(n);var r=ut((.4124564*e+.3575761*t+.1804375*n)/ys),i=ut((.2126729*e+.7151522*t+.072175*n)/bs),s=ut((.0193339*e+.119192*t+.9503041*n)/ws);return nt(116*i-16,500*(r-i),200*(i-s))}function J(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function K(e){var t=parseFloat(e);return e.charAt(e.length-1)==="%"?Math.round(t*2.55):t}function Q(e,t,n){return new G(e,t,n)}function G(e,t,n){this.h=e,this.s=t,this.l=n}function Y(e,t,n){function r(e){return e>360?e-=360:e<0&&(e+=360),e<60?s+(o-s)*e/60:e<180?o:e<240?s+(o-s)*(240-e)/60:s}function i(e){return Math.round(r(e)*255)}var s,o;return e%=360,e<0&&(e+=360),t=t<0?0:t>1?1:t,n=n<0?0:n>1?1:n,o=n<=.5?n*(1+t):n+t-n*t,s=2*n-o,U(i(e+120),i(e),i(e-120))}function Z(e,t,n){return new et(e,t,n)}function et(e,t,n){this.h=e,this.c=t,this.l=n}function tt(e,t,n){return nt(n,Math.cos(e*=Math.PI/180)*t,Math.sin(e)*t)}function nt(e,t,n){return new rt(e,t,n)}function rt(e,t,n){this.l=e,this.a=t,this.b=n}function it(e,t,n){var r=(e+16)/116,i=r+t/500,s=r-n/200;return i=ot(i)*ys,r=ot(r)*bs,s=ot(s)*ws,U(at(3.2404542*i-1.5371385*r-.4985314*s),at(-0.969266*i+1.8760108*r+.041556*s),at(.0556434*i-.2040259*r+1.0572252*s))}function st(e,t,n){return Z(Math.atan2(n,t)/Math.PI*180,Math.sqrt(t*t+n*n),e)}function ot(e){return e>.206893034?e*e*e:(e-4/29)/7.787037}function ut(e){return e>.008856?Math.pow(e,1/3):7.787037*e+4/29}function at(e){return Math.round(255*(e<=.00304?12.92*e:1.055*Math.pow(e,1/2.4)-.055))}function ft(e){return Qi(e,ks),e}function lt(e){return function(){return Ss(e,this)}}function ct(e){return function(){return xs(e,this)}}function ht(e,t){function n(){this.removeAttribute(e)}function r(){this.removeAttributeNS(e.space,e.local)}function i(){this.setAttribute(e,t)}function s(){this.setAttributeNS(e.space,e.local,t)}function o(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}function u(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}return e=d3.ns.qualify(e),t==null?e.local?r:n:typeof t=="function"?e.local?u:o:e.local?s:i}function pt(e){return new RegExp("(?:^|\\s+)"+d3.requote(e)+"(?:\\s+|$)","g")}function dt(e,t){function n(){var n=-1;while(++n<i)e[n](this,t)}function r(){var n=-1,r=t.apply(this,arguments);while(++n<i)e[n](this,r)}e=e.trim().split(/\s+/).map(vt);var i=e.length;return typeof t=="function"?r:n}function vt(e){var t=pt(e);return function(n,r){if(i=n.classList)return r?i.add(e):i.remove(e);var i=n.className,s=i.baseVal!=null,o=s?i.baseVal:i;r?(t.lastIndex=0,t.test(o)||(o=h(o+" "+e),s?i.baseVal=o:n.className=o)):o&&(o=h(o.replace(t," ")),s?i.baseVal=o:n.className=o)}}function mt(e,t,n){function r(){this.style.removeProperty(e)}function i(){this.style.setProperty(e,t,n)}function s(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}return t==null?r:typeof t=="function"?s:i}function gt(e,t){function n(){delete this[e]}function r(){this[e]=t}function i(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}return t==null?n:typeof t=="function"?i:r}function yt(e){return{__data__:e}}function bt(e){return function(){return Cs(this,e)}}function wt(e){return arguments.length||(e=d3.ascending),function(t,n){return e(t&&t.__data__,n&&n.__data__)}}function Et(e,t,n){function r(){var t=this[s];t&&(this.removeEventListener(e,t,t.$),delete this[s])}function i(){function i(e){var n=d3.event;d3.event=e,u[0]=o.__data__;try{t.apply(o,u)}finally{d3.event=n}}var o=this,u=arguments;r.call(this),this.addEventListener(e,this[s]=i,i.$=n),i._=t}var s="__on"+e,o=e.indexOf(".");return o>0&&(e=e.substring(0,o)),t?i:r}function St(e,t){for(var n=0,r=e.length;n<r;n++)for(var i=e[n],s=0,o=i.length,u;s<o;s++)(u=i[s])&&t(u,s,n);return e}function xt(e){return Qi(e,As),e}function Tt(e,t,n){Qi(e,Os);var i=new r,s=d3.dispatch("start","end"),o=Fs;return e.id=t,e.time=n,e.tween=function(t,n){return arguments.length<2?i.get(t):(n==null?i.remove(t):i.set(t,n),e)},e.ease=function(t){return arguments.length?(o=typeof t=="function"?t:d3.ease.apply(d3,arguments),e):o},e.each=function(t,n){return arguments.length<2?Nt.call(e,t):(s.on(t,n),e)},d3.timer(function(r){return St(e,function(e,u,a){function f(r){return v.active>t?c():(v.active=t,i.forEach(function(t,n){(n=n.call(e,m,u))&&h.push(n)}),s.start.call(e,m,u),l(r)||d3.timer(l,0,n),1)}function l(n){if(v.active!==t)return c();var r=(n-p)/d,i=o(r),a=h.length;while(a>0)h[--a].call(e,i);if(r>=1)return c(),_s=t,s.end.call(e,m,u),_s=0,1}function c(){return--v.count||delete e.__transition__,1}var h=[],p=e.delay,d=e.duration,v=(e=e.node).__transition__||(e.__transition__={active:0,count:0}),m=e.__data__;++v.count,p<=r?f(r):d3.timer(f,p,n)})},0,n),e}function Nt(e){var t=_s,n=Fs,r=Bs,i=js;return _s=this.id,Fs=this.ease(),St(this,function(t,n,r){Bs=t.delay,js=t.duration,e.call(t=t.node,t.__data__,n,r)}),_s=t,Fs=n,Bs=r,js=i,this}function Ct(e,t,n){return n!=""&&Is}function kt(e,t){return d3.tween(e,F(t))}function Lt(){var e,t=Date.now(),n=Us;while(n)e=t-n.then,e>=n.delay&&(n.flush=n.callback(e)),n=n.next;var r=At()-t;r>24?(isFinite(r)&&(clearTimeout(Ws),Ws=setTimeout(Lt,r)),zs=0):(zs=1,Xs(Lt))}function At(){var e=null,t=Us,n=Infinity;while(t)t.flush?(delete Rs[t.callback.id],t=e?e.next=t.next:Us=t.next):(n=Math.min(n,t.then+t.delay),t=(e=t).next);return n}function Ot(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();if(Vs<0&&(window.scrollX||window.scrollY)){n=d3.select(document.body).append("svg").style("position","absolute").style("top",0).style("left",0);var i=n[0][0].getScreenCTM();Vs=!i.f&&!i.e,n.remove()}return Vs?(r.x=t.pageX,r.y=t.pageY):(r.x=t.clientX,r.y=t.clientY),r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}var s=e.getBoundingClientRect();return[t.clientX-s.left-e.clientLeft,t.clientY-s.top-e.clientTop]}function Mt(){}function _t(e){var t=e[0],n=e[e.length-1];return t<n?[t,n]:[n,t]}function Dt(e){return e.rangeExtent?e.rangeExtent():_t(e.range())}function Pt(e,t){var n=0,r=e.length-1,i=e[n],s=e[r],o;s<i&&(o=n,n=r,r=o,o=i,i=s,s=o);if(t=t(s-i))e[n]=t.floor(i),e[r]=t.ceil(s);return e}function Ht(){return Math}function Bt(e,t,n,r){function i(){var i=Math.min(e.length,t.length)>2?zt:Ut,a=r?q:I;return o=i(e,t,a,n),u=i(t,e,a,d3.interpolate),s}function s(e){return o(e)}var o,u;return s.invert=function(e){return u(e)},s.domain=function(t){return arguments.length?(e=t.map(Number),i()):e},s.range=function(e){return arguments.length?(t=e,i()):t},s.rangeRound=function(e){return s.range(e).interpolate(d3.interpolateRound)},s.clamp=function(e){return arguments.length?(r=e,i()):r},s.interpolate=function(e){return arguments.length?(n=e,i()):n},s.ticks=function(t){return qt(e,t)},s.tickFormat=function(t){return Rt(e,t)},s.nice=function(){return Pt(e,Ft),i()},s.copy=function(){return Bt(e,t,n,r)},i()}function jt(e,t){return d3.rebind(e,t,"range","rangeRound","interpolate","clamp")}function Ft(e){return e=Math.pow(10,Math.round(Math.log(e)/Math.LN10)-1),e&&{floor:function(t){return Math.floor(t/e)*e},ceil:function(t){return Math.ceil(t/e)*e}}}function It(e,t){var n=_t(e),r=n[1]-n[0],i=Math.pow(10,Math.floor(Math.log(r/t)/Math.LN10)),s=t/r*i;return s<=.15?i*=10:s<=.35?i*=5:s<=.75&&(i*=2),n[0]=Math.ceil(n[0]/i)*i,n[1]=Math.floor(n[1]/i)*i+i*.5,n[2]=i,n}function qt(e,t){return d3.range.apply(d3,It(e,t))}function Rt(e,t){return d3.format(",."+Math.max(0,-Math.floor(Math.log(It(e,t)[2])/Math.LN10+.01))+"f")}function Ut(e,t,n,r){var i=n(e[0],e[1]),s=r(t[0],t[1]);return function(e){return s(i(e))}}function zt(e,t,n,r){var i=[],s=[],o=0,u=Math.min(e.length,t.length)-1;e[u]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());while(++o<=u)i.push(n(e[o-1],e[o])),s.push(r(t[o-1],t[o]));return function(t){var n=d3.bisect(e,t,1,u)-1;return s[n](i[n](t))}}function Wt(e,t){function n(n){return e(t(n))}var r=t.pow;return n.invert=function(t){return r(e.invert(t))},n.domain=function(i){return arguments.length?(t=i[0]<0?Vt:Xt,r=t.pow,e.domain(i.map(t)),n):e.domain().map(r)},n.nice=function(){return e.domain(Pt(e.domain(),Ht)),n},n.ticks=function(){var n=_t(e.domain()),i=[];if(n.every(isFinite)){var s=Math.floor(n[0]),o=Math.ceil(n[1]),u=r(n[0]),a=r(n[1]);if(t===Vt){i.push(r(s));for(;s++<o;)for(var f=9;f>0;f--)i.push(r(s)*f)}else{for(;s<o;s++)for(var f=1;f<10;f++)i.push(r(s)*f);i.push(r(s))}for(s=0;i[s]<u;s++);for(o=i.length;i[o-1]>a;o--);i=i.slice(s,o)}return i},n.tickFormat=function(e,i){arguments.length<2&&(i=$s);if(arguments.length<1)return i;var s=Math.max(.1,e/n.ticks().length),o=t===Vt?(u=-1e-12,Math.floor):(u=1e-12,Math.ceil),u;return function(e){return e/r(o(t(e)+u))<=s?i(e):""}},n.copy=function(){return Wt(e.copy(),t)},jt(n,e)}function Xt(e){return Math.log(e<0?0:e)/Math.LN10}function Vt(e){return-Math.log(e>0?0:-e)/Math.LN10}function $t(e,t){function n(t){return e(r(t))}var r=Jt(t),i=Jt(1/t);return n.invert=function(t){return i(e.invert(t))},n.domain=function(t){return arguments.length?(e.domain(t.map(r)),n):e.domain().map(i)},n.ticks=function(e){return qt(n.domain(),e)},n.tickFormat=function(e){return Rt(n.domain(),e)},n.nice=function(){return n.domain(Pt(n.domain(),Ft))},n.exponent=function(e){if(!arguments.length)return t;var s=n.domain();return r=Jt(t=e),i=Jt(1/t),n.domain(s)},n.copy=function(){return $t(e.copy(),t)},jt(n,e)}function Jt(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Kt(e,t){function n(t){return o[((s.get(t)||s.set(t,e.push(t)))-1)%o.length]}function i(t,n){return d3.range(e.length).map(function(e){return t+n*e})}var s,o,u;return n.domain=function(i){if(!arguments.length)return e;e=[],s=new r;var o=-1,u=i.length,a;while(++o<u)s.has(a=i[o])||s.set(a,e.push(a));return n[t.t].apply(n,t.a)},n.range=function(e){return arguments.length?(o=e,u=0,t={t:"range",a:arguments},n):o},n.rangePoints=function(r,s){arguments.length<2&&(s=0);var a=r[0],f=r[1],l=(f-a)/(Math.max(1,e.length-1)+s);return o=i(e.length<2?(a+f)/2:a+l*s/2,l),u=0,t={t:"rangePoints",a:arguments},n},n.rangeBands=function(r,s,a){arguments.length<2&&(s=0),arguments.length<3&&(a=s);var f=r[1]<r[0],l=r[f-0],c=r[1-f],h=(c-l)/(e.length-s+2*a);return o=i(l+h*a,h),f&&o.reverse(),u=h*(1-s),t={t:"rangeBands",a:arguments},n},n.rangeRoundBands=function(r,s,a){arguments.length<2&&(s=0),arguments.length<3&&(a=s);var f=r[1]<r[0],l=r[f-0],c=r[1-f],h=Math.floor((c-l)/(e.length-s+2*a)),p=c-l-(e.length-s)*h;return o=i(l+Math.round(p/2),h),f&&o.reverse(),u=Math.round(h*(1-s)),t={t:"rangeRoundBands",a:arguments},n},n.rangeBand=function(){return u},n.rangeExtent=function(){return _t(t.a[0])},n.copy=function(){return Kt(e,t)},n.domain(e)}function Qt(e,t){function n(){var n=0,s=e.length,o=t.length;i=[];while(++n<o)i[n-1]=d3.quantile(e,n/o);return r}function r(e){return isNaN(e=+e)?NaN:t[d3.bisect(i,e)]}var i;return r.domain=function(t){return arguments.length?(e=t.filter(function(e){return!isNaN(e)}).sort(d3.ascending),n()):e},r.range=function(e){return arguments.length?(t=e,n()):t},r.quantiles=function(){return i},r.copy=function(){return Qt(e,t)},n()}function Gt(e,t,n){function r(t){return n[Math.max(0,Math.min(o,Math.floor(s*(t-e))))]}function i(){return s=n.length/(t-e),o=n.length-1,r}var s,o;return r.domain=function(n){return arguments.length?(e=+n[0],t=+n[n.length-1],i()):[e,t]},r.range=function(e){return arguments.length?(n=e,i()):n},r.copy=function(){return Gt(e,t,n)},i()}function Yt(e,t){function n(n){return t[d3.bisect(e,n)]}return n.domain=function(t){return arguments.length?(e=t,n):e},n.range=function(e){return arguments.length?(t=e,n):t},n.copy=function(){return Yt(e,t)},n}function Zt(e){function t(e){return+e}return t.invert=t,t.domain=t.range=function(n){return arguments.length?(e=n.map(t),t):e},t.ticks=function(t){return qt(e,t)},t.tickFormat=function(t){return Rt(e,t)},t.copy=function(){return Zt(e)},t}function en(e){return e.innerRadius}function tn(e){return e.outerRadius}function nn(e){return e.startAngle}function rn(e){return e.endAngle}function sn(e){function t(t){function o(){a.push("M",s(e(l),f))}var a=[],l=[],c=-1,h=t.length,p,d=u(n),v=u(r);while(++c<h)i.call(this,p=t[c],c)?l.push([+d.call(this,p,c),+v.call(this,p,c)]):l.length&&(o(),l=[]);return l.length&&o(),a.length?a.join(""):null}var n=on,r=un,i=o,s=an,a=s.key,f=.7;return t.x=function(e){return arguments.length?(n=e,t):n},t.y=function(e){return arguments.length?(r=e,t):r},t.defined=function(e){return arguments.length?(i=e,t):i},t.interpolate=function(e){return arguments.length?(typeof e=="function"?a=s=e:a=(s=eo.get(e)||an).key,t):a},t.tension=function(e){return arguments.length?(f=e,t):f},t}function on(e){return e[0]}function un(e){return e[1]}function an(e){return e.join("L")}function fn(e){return an(e)+"Z"}function ln(e){var t=0,n=e.length,r=e[0],i=[r[0],",",r[1]];while(++t<n)i.push("V",(r=e[t])[1],"H",r[0]);return i.join("")}function cn(e){var t=0,n=e.length,r=e[0],i=[r[0],",",r[1]];while(++t<n)i.push("H",(r=e[t])[0],"V",r[1]);return i.join("")}function hn(e,t){return e.length<4?an(e):e[1]+vn(e.slice(1,e.length-1),mn(e,t))}function pn(e,t){return e.length<3?an(e):e[0]+vn((e.push(e[0]),e),mn([e[e.length-2]].concat(e,[e[1]]),t))}function dn(e,t,n){return e.length<3?an(e):e[0]+vn(e,mn(e,t))}function vn(e,t){if(t.length<1||e.length!=t.length&&e.length!=t.length+2)return an(e);var n=e.length!=t.length,r="",i=e[0],s=e[1],o=t[0],u=o,a=1;n&&(r+="Q"+(s[0]-o[0]*2/3)+","+(s[1]-o[1]*2/3)+","+s[0]+","+s[1],i=e[1],a=2);if(t.length>1){u=t[1],s=e[a],a++,r+="C"+(i[0]+o[0])+","+(i[1]+o[1])+","+(s[0]-u[0])+","+(s[1]-u[1])+","+s[0]+","+s[1];for(var f=2;f<t.length;f++,a++)s=e[a],u=t[f],r+="S"+(s[0]-u[0])+","+(s[1]-u[1])+","+s[0]+","+s[1]}if(n){var l=e[a];r+="Q"+(s[0]+u[0]*2/3)+","+(s[1]+u[1]*2/3)+","+l[0]+","+l[1]}return r}function mn(e,t){var n=[],r=(1-t)/2,i,s=e[0],o=e[1],u=1,a=e.length;while(++u<a)i=s,s=o,o=e[u],n.push([r*(o[0]-i[0]),r*(o[1]-i[1])]);return n}function gn(e){if(e.length<3)return an(e);var t=1,n=e.length,r=e[0],i=r[0],s=r[1],o=[i,i,i,(r=e[1])[0]],u=[s,s,s,r[1]],a=[i,",",s];Sn(a,o,u);while(++t<n)r=e[t],o.shift(),o.push(r[0]),u.shift(),u.push(r[1]),Sn(a,o,u);t=-1;while(++t<2)o.shift(),o.push(r[0]),u.shift(),u.push(r[1]),Sn(a,o,u);return a.join("")}function yn(e){if(e.length<4)return an(e);var t=[],n=-1,r=e.length,i,s=[0],o=[0];while(++n<3)i=e[n],s.push(i[0]),o.push(i[1]);t.push(En(ro,s)+","+En(ro,o)),--n;while(++n<r)i=e[n],s.shift(),s.push(i[0]),o.shift(),o.push(i[1]),Sn(t,s,o);return t.join("")}function bn(e){var t,n=-1,r=e.length,i=r+4,s,o=[],u=[];while(++n<4)s=e[n%r],o.push(s[0]),u.push(s[1]);t=[En(ro,o),",",En(ro,u)],--n;while(++n<i)s=e[n%r],o.shift(),o.push(s[0]),u.shift(),u.push(s[1]),Sn(t,o,u);return t.join("")}function wn(e,t){var n=e.length-1;if(n){var r=e[0][0],i=e[0][1],s=e[n][0]-r,o=e[n][1]-i,u=-1,a,f;while(++u<=n)a=e[u],f=u/n,a[0]=t*a[0]+(1-t)*(r+f*s),a[1]=t*a[1]+(1-t)*(i+f*o)}return gn(e)}function En(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function Sn(e,t,n){e.push("C",En(to,t),",",En(to,n),",",En(no,t),",",En(no,n),",",En(ro,t),",",En(ro,n))}function xn(e,t){return(t[1]-e[1])/(t[0]-e[0])}function Tn(e){var t=0,n=e.length-1,r=[],i=e[0],s=e[1],o=r[0]=xn(i,s);while(++t<n)r[t]=(o+(o=xn(i=s,s=e[t+1])))/2;return r[t]=o,r}function Nn(e){var t=[],n,r,i,s,o=Tn(e),u=-1,a=e.length-1;while(++u<a)n=xn(e[u],e[u+1]),Math.abs(n)<1e-6?o[u]=o[u+1]=0:(r=o[u]/n,i=o[u+1]/n,s=r*r+i*i,s>9&&(s=n*3/Math.sqrt(s),o[u]=s*r,o[u+1]=s*i));u=-1;while(++u<=a)s=(e[Math.min(a,u+1)][0]-e[Math.max(0,u-1)][0])/(6*(1+o[u]*o[u])),t.push([s||0,o[u]*s||0]);return t}function Cn(e){return e.length<3?an(e):e[0]+vn(e,Nn(e))}function kn(e){var t,n=-1,r=e.length,i,s;while(++n<r)t=e[n],i=t[0],s=t[1]+Ys,t[0]=i*Math.cos(s),t[1]=i*Math.sin(s);return e}function Ln(e){function t(t){function o(){l.push("M",f(e(v),p),h,c(e(d.reverse()),p),"Z")}var l=[],d=[],v=[],m=-1,g=t.length,y,b=u(n),w=u(i),E=n===r?function(){return x}:u(r),S=i===s?function(){return T}:u(s),x,T;while(++m<g)a.call(this,y=t[m],m)?(d.push([x=+b.call(this,y,m),T=+w.call(this,y,m)]),v.push([+E.call(this,y,m),+S.call(this,y,m)])):d.length&&(o(),d=[],v=[]);return d.length&&o(),l.length?l.join(""):null}var n=on,r=on,i=0,s=un,a=o,f=an,l=f.key,c=f,h="L",p=.7;return t.x=function(e){return arguments.length?(n=r=e,t):r},t.x0=function(e){return arguments.length?(n=e,t):n},t.x1=function(e){return arguments.length?(r=e,t):r},t.y=function(e){return arguments.length?(i=s=e,t):s},t.y0=function(e){return arguments.length?(i=e,t):i},t.y1=function(e){return arguments.length?(s=e,t):s},t.defined=function(e){return arguments.length?(a=e,t):a},t.interpolate=function(e){return arguments.length?(typeof e=="function"?l=f=e:l=(f=eo.get(e)||an).key,c=f.reverse||f,h=f.closed?"M":"L",t):l},t.tension=function(e){return arguments.length?(p=e,t):p},t}function An(e){return e.source}function On(e){return e.target}function Mn(e){return e.radius}function _n(e){return e.startAngle}function Dn(e){return e.endAngle}function Pn(e){return[e.x,e.y]}function Hn(e){return function(){var t=e.apply(this,arguments),n=t[0],r=t[1]+Ys;return[n*Math.cos(r),n*Math.sin(r)]}}function Bn(){return 64}function jn(){return"circle"}function Fn(e){var t=Math.sqrt(e/Math.PI);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+ -t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}function In(e,t){e.attr("transform",function(e){return"translate("+t(e)+",0)"})}function qn(e,t){e.attr("transform",function(e){return"translate(0,"+t(e)+")"})}function Rn(e,t,n){i=[];if(n&&t.length>1){var r=_t(e.domain()),i,s=-1,o=t.length,u=(t[1]-t[0])/++n,a,f;while(++s<o)for(a=n;--a>0;)(f=+t[s]-a*u)>=r[0]&&i.push(f);for(--s,a=0;++a<n&&(f=+t[s]+a*u)<r[1];)i.push(f)}return i}function Un(){fo||(fo=d3.select("body").append("div").style("visibility","hidden").style("top",0).style("height",0).style("width",0).style("overflow-y","scroll").append("div").style("height","2000px").node().parentNode);var e=d3.event,t;try{fo.scrollTop=1e3,fo.dispatchEvent(e),t=1e3-fo.scrollTop}catch(n){t=e.wheelDelta||-e.detail*5}return t}function zn(e){var t=e.source,n=e.target,r=Xn(t,n),i=[t];while(t!==r)t=t.parent,i.push(t);var s=i.length;while(n!==r)i.splice(s,0,n),n=n.parent;return i}function Wn(e){var t=[],n=e.parent;while(n!=null)t.push(e),e=n,n=n.parent;return t.push(e),t}function Xn(e,t){if(e===t)return e;var n=Wn(e),r=Wn(t),i=n.pop(),s=r.pop(),o=null;while(i===s)o=i,i=n.pop(),s=r.pop();return o}function Vn(e){e.fixed|=2}function $n(e){e.fixed&=1}function Jn(e){e.fixed|=4}function Kn(e){e.fixed&=3}function Qn(e,t,n){var r=0,i=0;e.charge=0;if(!e.leaf){var s=e.nodes,o=s.length,u=-1,a;while(++u<o){a=s[u];if(a==null)continue;Qn(a,t,n),e.charge+=a.charge,r+=a.charge*a.cx,i+=a.charge*a.cy}}if(e.point){e.leaf||(e.point.x+=Math.random()-.5,e.point.y+=Math.random()-.5);var f=t*n[e.point.index];e.charge+=e.pointCharge=f,r+=f*e.point.x,i+=f*e.point.y}e.cx=r/e.charge,e.cy=i/e.charge}function Gn(e){return 20}function Yn(e){return 1}function Zn(e){return e.x}function er(e){return e.y}function tr(e,t,n){e.y0=t,e.y=n}function nr(e){return d3.range(e.length)}function rr(e){var t=-1,n=e[0].length,r=[];while(++t<n)r[t]=0;return r}function ir(e){var t=1,n=0,r=e[0][1],i,s=e.length;for(;t<s;++t)(i=e[t][1])>r&&(n=t,r=i);return n}function sr(e){return e.reduce(or,0)}function or(e,t){return e+t[1]}function ur(e,t){return ar(e,Math.ceil(Math.log(t.length)/Math.LN2+1))}function ar(e,t){var n=-1,r=+e[0],i=(e[1]-r)/t,s=[];while(++n<=t)s[n]=i*n+r;return s}function fr(e){return[d3.min(e),d3.max(e)]}function lr(e,t){return d3.rebind(e,t,"sort","children","value"),e.links=dr,e.nodes=function(t){return vo=!0,(e.nodes=e)(t)},e}function cr(e){return e.children}function hr(e){return e.value}function pr(e,t){return t.value-e.value}function dr(e){return d3.merge(e.map(function(e){return(e.children||[]).map(function(t){return{source:e,target:t}})}))}function vr(e,t){return e.value-t.value}function mr(e,t){var n=e._pack_next;e._pack_next=t,t._pack_prev=e,t._pack_next=n,n._pack_prev=t}function gr(e,t){e._pack_next=t,t._pack_prev=e}function yr(e,t){var n=t.x-e.x,r=t.y-e.y,i=e.r+t.r;return i*i-n*n-r*r>.001}function br(e){function t(e){r=Math.min(e.x-e.r,r),i=Math.max(e.x+e.r,i),s=Math.min(e.y-e.r,s),o=Math.max(e.y+e.r,o)}if(!(n=e.children)||!(p=n.length))return;var n,r=Infinity,i=-Infinity,s=Infinity,o=-Infinity,u,a,f,l,c,h,p;n.forEach(wr),u=n[0],u.x=-u.r,u.y=0,t(u);if(p>1){a=n[1],a.x=a.r,a.y=0,t(a);if(p>2){f=n[2],xr(u,a,f),t(f),mr(u,f),u._pack_prev=f,mr(f,a),a=u._pack_next;for(l=3;l<p;l++){xr(u,a,f=n[l]);var d=0,v=1,m=1;for(c=a._pack_next;c!==a;c=c._pack_next,v++)if(yr(c,f)){d=1;break}if(d==1)for(h=u._pack_prev;h!==c._pack_prev;h=h._pack_prev,m++)if(yr(h,f))break;d?(v<m||v==m&&a.r<u.r?gr(u,a=c):gr(u=h,a),l--):(mr(u,f),a=f,t(f))}}}var g=(r+i)/2,y=(s+o)/2,b=0;for(l=0;l<p;l++)f=n[l],f.x-=g,f.y-=y,b=Math.max(b,f.r+Math.sqrt(f.x*f.x+f.y*f.y));e.r=b,n.forEach(Er)}function wr(e){e._pack_next=e._pack_prev=e}function Er(e){delete e._pack_next,delete e._pack_prev}function Sr(e,t,n,r){var i=e.children;e.x=t+=r*e.x,e.y=n+=r*e.y,e.r*=r;if(i){var s=-1,o=i.length;while(++s<o)Sr(i[s],t,n,r)}}function xr(e,t,n){var r=e.r+n.r,i=t.x-e.x,s=t.y-e.y;if(r&&(i||s)){var o=t.r+n.r,u=i*i+s*s;o*=o,r*=r;var a=.5+(r-o)/(2*u),f=Math.sqrt(Math.max(0,2*o*(r+u)-(r-=u)*r-o*o))/(2*u);n.x=e.x+a*i+f*s,n.y=e.y+a*s-f*i}else n.x=e.x+r,n.y=e.y}function Tr(e){return 1+d3.max(e,function(e){return e.y})}function Nr(e){return e.reduce(function(e,t){return e+t.x},0)/e.length}function Cr(e){var t=e.children;return t&&t.length?Cr(t[0]):e}function kr(e){var t=e.children,n;return t&&(n=t.length)?kr(t[n-1]):e}function Lr(e,t){return e.parent==t.parent?1:2}function Ar(e){var t=e.children;return t&&t.length?t[0]:e._tree.thread}function Or(e){var t=e.children,n;return t&&(n=t.length)?t[n-1]:e._tree.thread}function Mr(e,t){var n=e.children;if(n&&(i=n.length)){var r,i,s=-1;while(++s<i)t(r=Mr(n[s],t),e)>0&&(e=r)}return e}function _r(e,t){return e.x-t.x}function Dr(e,t){return t.x-e.x}function Pr(e,t){return e.depth-t.depth}function Hr(e,t){function n(e,r){var i=e.children;if(i&&(a=i.length)){var s,o=null,u=-1,a;while(++u<a)s=i[u],n(s,o),o=s}t(e,r)}n(e,null)}function Br(e){var t=0,n=0,r=e.children,i=r.length,s;while(--i>=0)s=r[i]._tree,s.prelim+=t,s.mod+=t,t+=s.shift+(n+=s.change)}function jr(e,t,n){e=e._tree,t=t._tree;var r=n/(t.number-e.number);e.change+=r,t.change-=r,t.shift+=n,t.prelim+=n,t.mod+=n}function Fr(e,t,n){return e._tree.ancestor.parent==t.parent?e._tree.ancestor:n}function Ir(e){return{x:e.x,y:e.y,dx:e.dx,dy:e.dy}}function qr(e,t){var n=e.x+t[3],r=e.y+t[0],i=e.dx-t[1]-t[3],s=e.dy-t[0]-t[2];return i<0&&(n+=i/2,i=0),s<0&&(r+=s/2,s=0),{x:n,y:r,dx:i,dy:s}}function Rr(e,t){function n(e,r){d3.text(e,t,function(e){r(e&&n.parse(e))})}function r(t){return t.map(i).join(e)}function i(e){return o.test(e)?'"'+e.replace(/\"/g,'""')+'"':e}var s=new RegExp("\r\n|["+e+"\r\n]","g"),o=new RegExp('["'+e+"\n]"),u=e.charCodeAt(0);return n.parse=function(e){var t;return n.parseRows(e,function(e,n){if(n){var r={},i=-1,s=t.length;while(++i<s)r[t[i]]=e[i];return r}return t=e,null})},n.parseRows=function(e,t){function n(){if(s.lastIndex>=e.length)return i;if(l)return l=!1,r;var t=s.lastIndex;if(e.charCodeAt(t)===34){var n=t;while(n++<e.length)if(e.charCodeAt(n)===34){if(e.charCodeAt(n+1)!==34)break;n++}s.lastIndex=n+2;var o=e.charCodeAt(n+1);return o===13?(l=!0,e.charCodeAt(n+2)===10&&s.lastIndex++):o===10&&(l=!0),e.substring(t+1,n).replace(/""/g,'"')}var a=s.exec(e);return a?(l=a[0].charCodeAt(0)!==u,e.substring(t,a.index)):(s.lastIndex=e.length,e.substring(t))}var r={},i={},o=[],a=0,f,l;s.lastIndex=0;while((f=n())!==i){var c=[];while(f!==r&&f!==i)c.push(f),f=n();if(t&&!(c=t(c,a++)))continue;o.push(c)}return o},n.format=function(e){return e.map(r).join("\n")},n}function Ur(e,t){return function(n){return n&&e.hasOwnProperty(n.type)?e[n.type](n):t}}function zr(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+ -2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function Wr(e,t){go.hasOwnProperty(e.type)&&go[e.type](e,t)}function Xr(e,t){Wr(e.geometry,t)}function Vr(e,t){for(var n=e.features,r=0,i=n.length;r<i;r++)Wr(n[r].geometry,t)}function $r(e,t){for(var n=e.geometries,r=0,i=n.length;r<i;r++)Wr(n[r],t)}function Jr(e,t){for(var n=e.coordinates,r=0,i=n.length;r<i;r++)t.apply(null,n[r])}function Kr(e,t){for(var n=e.coordinates,r=0,i=n.length;r<i;r++)for(var s=n[r],o=0,u=s.length;o<u;o++)t.apply(null,s[o])}function Qr(e,t){for(var n=e.coordinates,r=0,i=n.length;r<i;r++)for(var s=n[r][0],o=0,u=s.length;o<u;o++)t.apply(null,s[o])}function Gr(e,t){t.apply(null,e.coordinates)}function Yr(e,t){for(var n=e.coordinates[0],r=0,i=n.length;r<i;r++)t.apply(null,n[r])}function Zr(e){return e.source}function ei(e){return e.target}function ti(){function e(e){var t=Math.sin(e*=p)*d,n=Math.sin(p-e)*d,r=n*s+t*c,u=n*o+t*h,a=n*i+t*l;return[Math.atan2(u,r)/mo,Math.atan2(a,Math.sqrt(r*r+u*u))/mo]}var t,n,r,i,s,o,u,a,f,l,c,h,p,d;return e.distance=function(){return p==null&&(d=1/Math.sin(p=Math.acos(Math.max(-1,Math.min(1,i*l+r*f*Math.cos(u-t)))))),p},e.source=function(u){var a=Math.cos(t=u[0]*mo),f=Math.sin(t);return r=Math.cos(n=u[1]*mo),i=Math.sin(n),s=r*a,o=r*f,p=null,e},e.target=function(t){var n=Math.cos(u=t[0]*mo),r=Math.sin(u);return f=Math.cos(a=t[1]*mo),l=Math.sin(a),c=f*n,h=f*r,p=null,e},e}function ni(e,t){var n=ti().source(e).target(t);return n.distance(),n}function ri(e){var t=0,n=0;for(;;){if(e(t,n))return[t,n];t===0?(t=n+1,n=0):(t-=1,n+=1)}}function ii(e,t,n,r){var i,s,o,u,a,f,l;return i=r[e],s=i[0],o=i[1],i=r[t],u=i[0],a=i[1],i=r[n],f=i[0],l=i[1],(l-o)*(u-s)-(a-o)*(f-s)>0}function si(e,t,n){return(n[0]-t[0])*(e[1]-t[1])<(n[1]-t[1])*(e[0]-t[0])}function oi(e,t,n,r){var i=e[0],s=t[0],o=n[0],u=r[0],a=e[1],f=t[1],l=n[1],c=r[1],h=i-o,p=s-i,d=u-o,v=a-l,m=f-a,g=c-l,y=(d*v-g*h)/(g*p-d*m);return[i+y*p,a+y*m]}function ui(e,t){var n={list:e.map(function(e,t){return{index:t,x:e[0],y:e[1]}}).sort(function(e,t){return e.y<t.y?-1:e.y>t.y?1:e.x<t.x?-1:e.x>t.x?1:0}),bottomSite:null},r={list:[],leftEnd:null,rightEnd:null,init:function(){r.leftEnd=r.createHalfEdge(null,"l"),r.rightEnd=r.createHalfEdge(null,"l"),r.leftEnd.r=r.rightEnd,r.rightEnd.l=r.leftEnd,r.list.unshift(r.leftEnd,r.rightEnd)},createHalfEdge:function(e,t){return{edge:e,side:t,vertex:null,l:null,r:null}},insert:function(e,t){t.l=e,t.r=e.r,e.r.l=t,e.r=t},leftBound:function(e){var t=r.leftEnd;do t=t.r;while(t!=r.rightEnd&&i.rightOf(t,e));return t=t.l,t},del:function(e){e.l.r=e.r,e.r.l=e.l,e.edge=null},right:function(e){return e.r},left:function(e){return e.l},leftRegion:function(e){return e.edge==null?n.bottomSite:e.edge.region[e.side]},rightRegion:function(e){return e.edge==null?n.bottomSite:e.edge.region[wo[e.side]]}},i={bisect:function(e,t){var n={region:{l:e,r:t},ep:{l:null,r:null}},r=t.x-e.x,i=t.y-e.y,s=r>0?r:-r,o=i>0?i:-i;return n.c=e.x*r+e.y*i+(r*r+i*i)*.5,s>o?(n.a=1,n.b=i/r,n.c/=r):(n.b=1,n.a=r/i,n.c/=i),n},intersect:function(e,t){var n=e.edge,r=t.edge;if(!n||!r||n.region.r==r.region.r)return null;var i=n.a*r.b-n.b*r.a;if(Math.abs(i)<1e-10)return null;var s=(n.c*r.b-r.c*n.b)/i,o=(r.c*n.a-n.c*r.a)/i,u=n.region.r,a=r.region.r,f,l;u.y<a.y||u.y==a.y&&u.x<a.x?(f=e,l=n):(f=t,l=r);var c=s>=l.region.r.x;return c&&f.side==="l"||!c&&f.side==="r"?null:{x:s,y:o}},rightOf:function(e,t){var n=e.edge,r=n.region.r,i=t.x>r.x;if(i&&e.side==="l")return 1;if(!i&&e.side==="r")return 0;if(n.a===1){var s=t.y-r.y,o=t.x-r.x,u=0,a=0;!i&&n.b<0||i&&n.b>=0?a=u=s>=n.b*o:(a=t.x+t.y*n.b>n.c,n.b<0&&(a=!a),a||(u=1));if(!u){var f=r.x-n.region.l.x;a=n.b*(o*o-s*s)<f*s*(1+2*o/f+n.b*n.b),n.b<0&&(a=!a)}}else{var l=n.c-n.a*t.x,c=t.y-l,h=t.x-r.x,p=l-r.y;a=c*c>h*h+p*p}return e.side==="l"?a:!a},endPoint:function(e,n,r){e.ep[n]=r;if(!e.ep[wo[n]])return;t(e)},distance:function(e,t){var n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)}},s={list:[],insert:function(e,t,n){e.vertex=t,e.ystar=t.y+n;for(var r=0,i=s.list,o=i.length;r<o;r++){var u=i[r];if(e.ystar>u.ystar||e.ystar==u.ystar&&t.x>u.vertex.x)continue;break}i.splice(r,0,e)},del:function(e){for(var t=0,n=s.list,r=n.length;t<r&&n[t]!=e;++t);n.splice(t,1)},empty:function(){return s.list.length===0},nextEvent:function(e){for(var t=0,n=s.list,r=n.length;t<r;++t)if(n[t]==e)return n[t+1];return null},min:function(){var e=s.list[0];return{x:e.vertex.x,y:e.ystar}},extractMin:function(){return s.list.shift()}};r.init(),n.bottomSite=n.list.shift();var o=n.list.shift(),u,a,f,l,c,h,p,d,v,m,g,y,b;for(;;){s.empty()||(u=s.min());if(o&&(s.empty()||o.y<u.y||o.y==u.y&&o.x<u.x))a=r.leftBound(o),f=r.right(a),p=r.rightRegion(a),y=i.bisect(p,o),h=r.createHalfEdge(y,"l"),r.insert(a,h),m=i.intersect(a,h),m&&(s.del(a),s.insert(a,m,i.distance(m,o))),a=h,h=r.createHalfEdge(y,"r"),r.insert(a,h),m=i.intersect(h,f),m&&s.insert(h,m,i.distance(m,o)),o=n.list.shift();else{if(!!s.empty())break;a=s.extractMin(),l=r.left(a),f=r.right(a),c=r.right(f),p=r.leftRegion(a),d=r.rightRegion(f),g=a.vertex,i.endPoint(a.edge,a.side,g),i.endPoint(f.edge,f.side,g),r.del(a),s.del(f),r.del(f),b="l",p.y>d.y&&(v=p,p=d,d=v,b="r"),y=i.bisect(p,d),h=r.createHalfEdge(y,b),r.insert(l,h),i.endPoint(y,wo[b],g),m=i.intersect(l,h),m&&(s.del(l),s.insert(l,m,i.distance(m,p))),m=i.intersect(h,c),m&&s.insert(h,m,i.distance(m,p))}}for(a=r.right(r.leftEnd);a!=r.rightEnd;a=r.right(a))t(a.edge)}function ai(){return{leaf:!0,nodes:[],point:null}}function fi(e,t,n,r,i,s){if(!e(t,n,r,i,s)){var o=(n+i)*.5,u=(r+s)*.5,a=t.nodes;a[0]&&fi(e,a[0],n,r,o,u),a[1]&&fi(e,a[1],o,r,i,u),a[2]&&fi(e,a[2],n,u,o,s),a[3]&&fi(e,a[3],o,u,i,s)}}function li(e){return{x:e[0],y:e[1]}}function ci(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function hi(e){return e.substring(0,3)}function pi(e,t,n,r){var i,s,o=0,u=t.length,a=n.length;while(o<u){if(r>=a)return-1;i=t.charCodeAt(o++);if(i==37){s=Uo[t.charAt(o++)];if(!s||(r=s(e,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}function di(e){return new RegExp("^(?:"+e.map(d3.requote).join("|")+")","i")}function vi(e){var t=new r,n=-1,i=e.length;while(++n<i)t.set(e[n].toLowerCase(),n);return t}function mi(e,t,n){Bo.lastIndex=0;var r=Bo.exec(t.substring(n));return r?n+=r[0].length:-1}function gi(e,t,n){Ho.lastIndex=0;var r=Ho.exec(t.substring(n));return r?n+=r[0].length:-1}function yi(e,t,n){Io.lastIndex=0;var r=Io.exec(t.substring(n));return r?(e.m=qo.get(r[0].toLowerCase()),n+=r[0].length):-1}function bi(e,t,n){jo.lastIndex=0;var r=jo.exec(t.substring(n));return r?(e.m=Fo.get(r[0].toLowerCase()),n+=r[0].length):-1}function wi(e,t,n){return pi(e,Ro.c.toString(),t,n)}function Ei(e,t,n){return pi(e,Ro.x.toString(),t,n)}function Si(e,t,n){return pi(e,Ro.X.toString(),t,n)}function xi(e,t,n){zo.lastIndex=0;var r=zo.exec(t.substring(n,n+4));return r?(e.y=+r[0],n+=r[0].length):-1}function Ti(e,t,n){zo.lastIndex=0;var r=zo.exec(t.substring(n,n+2));return r?(e.y=Ni(+r[0]),n+=r[0].length):-1}function Ni(e){return e+(e>68?1900:2e3)}function Ci(e,t,n){zo.lastIndex=0;var r=zo.exec(t.substring(n,n+2));return r?(e.m=r[0]-1,n+=r[0].length):-1}function ki(e,t,n){zo.lastIndex=0;var r=zo.exec(t.substring(n,n+2));return r?(e.d=+r[0],n+=r[0].length):-1}function Li(e,t,n){zo.lastIndex=0;var r=zo.exec(t.substring(n,n+2));return r?(e.H=+r[0],n+=r[0].length):-1}function Ai(e,t,n){zo.lastIndex=0;var r=zo.exec(t.substring(n,n+2));return r?(e.M=+r[0],n+=r[0].length):-1}function Oi(e,t,n){zo.lastIndex=0;var r=zo.exec(t.substring(n,n+2));return r?(e.S=+r[0],n+=r[0].length):-1}function Mi(e,t,n){zo.lastIndex=0;var r=zo.exec(t.substring(n,n+3));return r?(e.L=+r[0],n+=r[0].length):-1}function _i(e,t,n){var r=Wo.get(t.substring(n,n+=2).toLowerCase());return r==null?-1:(e.p=r,n)}function Di(e){var t=e.getTimezoneOffset(),n=t>0?"-":"+",r=~~(Math.abs(t)/60),i=Math.abs(t)%60;return n+Mo(r)+Mo(i)}function Pi(e){return e.toISOString()}function Hi(e,t,n){function r(t){var n=e(t),r=s(n,1);return t-n<r-t?n:r}function i(n){return t(n=e(new Eo(n-1)),1),n}function s(e,n){return t(e=new Eo(+e),n),e}function o(e,r,s){var o=i(e),u=[];if(s>1)while(o<r)n(o)%s||u.push(new Date(+o)),t(o,1);else while(o<r)u.push(new Date(+o)),t(o,1);return u}function u(e,t,n){try{Eo=ci;var r=new ci;return r._=e,o(r,t,n)}finally{Eo=Date}}e.floor=e,e.round=r,e.ceil=i,e.offset=s,e.range=o;var a=e.utc=Bi(e);return a.floor=a,a.round=Bi(r),a.ceil=Bi(i),a.offset=Bi(s),a.range=u,e}function Bi(e){return function(t,n){try{Eo=ci;var r=new ci;return r._=t,e(r,n)._}finally{Eo=Date}}}function ji(e,t,n){function r(t){return e(t)}return r.invert=function(t){return Ii(e.invert(t))},r.domain=function(t){return arguments.length?(e.domain(t),r):e.domain().map(Ii)},r.nice=function(e){return r.domain(Pt(r.domain(),function(){return e}))},r.ticks=function(n,i){var s=Fi(r.domain());if(typeof n!="function"){var o=s[1]-s[0],u=o/n,a=d3.bisect(Vo,u);if(a==Vo.length)return t.year(s,n);if(!a)return e.ticks(n).map(Ii);Math.log(u/Vo[a-1])<Math.log(Vo[a]/u)&&--a,n=t[a],i=n[1],n=n[0].range}return n(s[0],new Date(+s[1]+1),i)},r.tickFormat=function(){return n},r.copy=function(){return ji(e.copy(),t,n)},d3.rebind(r,e,"range","rangeRound","interpolate","clamp")}function Fi(e){var t=e[0],n=e[e.length-1];return t<n?[t,n]:[n,t]}function Ii(e){return new Date(e)}function qi(e){return function(t){var n=e.length-1,r=e[n];while(!r[1](t))r=e[--n];return r[0](t)}}function Ri(e){var t=new Date(e,0,1);return t.setFullYear(e),t}function Ui(e){var t=e.getFullYear(),n=Ri(t),r=Ri(t+1);return t+(e-n)/(r-n)}function zi(e){var t=new Date(Date.UTC(e,0,1));return t.setUTCFullYear(e),t}function Wi(e){var t=e.getUTCFullYear(),n=zi(t),r=zi(t+1);return t+(e-n)/(r-n)}Date.now||(Date.now=function(){return+(new Date)});try{document.createElement("div").style.setProperty("opacity",0,"")}catch(Xi){var Vi=CSSStyleDeclaration.prototype,$i=Vi.setProperty;Vi.setProperty=function(e,t,n){$i.call(this,e,t+"",n)}}d3={version:"2.10.3"};var Ji=n;try{Ji(document.documentElement.childNodes)[0].nodeType}catch(Ki){Ji=t}var Qi=[].__proto__?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)e[n]=t[n]};d3.map=function(e){var t=new r;for(var n in e)t.set(n,e[n]);return t},e(r,{has:function(e){return Gi+e in this},get:function(e){return this[Gi+e]},set:function(e,t){return this[Gi+e]=t},remove:function(e){return e=Gi+e,e in this&&delete this[e]},keys:function(){var e=[];return this.forEach(function(t){e.push(t)}),e},values:function(){var e=[];return this.forEach(function(t,n){e.push(n)}),e},entries:function(){var e=[];return this.forEach(function(t,n){e.push({key:t,value:n})}),e},forEach:function(e){for(var t in this)t.charCodeAt(0)===Yi&&e.call(this,t.substring(1),this[t])}});var Gi="\0",Yi=Gi.charCodeAt(0);d3.functor=u,d3.rebind=function(e,t){var n=1,r=arguments.length,i;while(++n<r)e[i=arguments[n]]=a(e,t,t[i]);return e},d3.ascending=function(e,t){return e<t?-1:e>t?1:e>=t?0:NaN},d3.descending=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},d3.mean=function(e,t){var n=e.length,r,i=0,s=-1,o=0;if(arguments.length===1)while(++s<n)f(r=e[s])&&(i+=(r-i)/++o);else while(++s<n)f(r=t.call(e,e[s],s))&&(i+=(r-i)/++o);return o?i:undefined},d3.median=function(e,t){return arguments.length>1&&(e=e.map(t)),e=e.filter(f),e.length?d3.quantile(e.sort(d3.ascending),.5):undefined},d3.min=function(e,t){var n=-1,r=e.length,i,s;if(arguments.length===1){while(++n<r&&((i=e[n])==null||i!=i))i=undefined;while(++n<r)(s=e[n])!=null&&i>s&&(i=s)}else{while(++n<r&&((i=t.call(e,e[n],n))==null||i!=i))i=undefined;while(++n<r)(s=t.call(e,e[n],n))!=null&&i>s&&(i=s)}return i},d3.max=function(e,t){var n=-1,r=e.length,i,s;if(arguments.length===1){while(++n<r&&((i=e[n])==null||i!=i))i=undefined;while(++n<r)(s=e[n])!=null&&s>i&&(i=s)}else{while(++n<r&&((i=t.call(e,e[n],n))==null||i!=i))i=undefined;while(++n<r)(s=t.call(e,e[n],n))!=null&&s>i&&(i=s)}return i},d3.extent=function(e,t){var n=-1,r=e.length,i,s,o;if(arguments.length===1){while(++n<r&&((i=o=e[n])==null||i!=i))i=o=undefined;while(++n<r)(s=e[n])!=null&&(i>s&&(i=s),o<s&&(o=s))}else{while(++n<r&&((i=o=t.call(e,e[n],n))==null||i!=i))i=undefined;while(++n<r)(s=t.call(e,e[n],n))!=null&&(i>s&&(i=s),o<s&&(o=s))}return[i,o]},d3.random={normal:function(e,t){var n=arguments.length;return n<2&&(t=1),n<1&&(e=0),function(){var n,r,i;do n=Math.random()*2-1,r=Math.random()*2-1,i=n*n+r*r;while(!i||i>1);return e+t*n*Math.sqrt(-2*Math.log(i)/i)}},logNormal:function(e,t){var n=arguments.length;n<2&&(t=1),n<1&&(e=0);var r=d3.random.normal();return function(){return Math.exp(e+t*r())}},irwinHall:function(e){return function(){for(var t=0,n=0;n<e;n++)t+=Math.random();return t/e}}},d3.sum=function(e,t){var n=0,r=e.length,i,s=-1;if(arguments.length===1)while(++s<r)isNaN(i=+e[s])||(n+=i);else while(++s<r)isNaN(i=+t.call(e,e[s],s))||(n+=i);return n},d3.quantile=function(e,t){var n=(e.length-1)*t+1,r=Math.floor(n),i=e[r-1],s=n-r;return s?i+s*(e[r]-i):i},d3.transpose=function(e){return d3.zip.apply(d3,e)},d3.zip=function(){if(!(i=arguments.length))return[];for(var e=-1,t=d3.min(arguments,l),n=new Array(t);++e<t;)for(var r=-1,i,s=n[e]=new Array(i);++r<i;)s[r]=arguments[r][e];return n},d3.bisector=function(e){return{left:function(t,n,r,i){arguments.length<3&&(r=0),arguments.length<4&&(i=t.length);while(r<i){var s=r+i>>>1;e.call(t,t[s],s)<n?r=s+1:i=s}return r},right:function(t,n,r,i){arguments.length<3&&(r=0),arguments.length<4&&(i=t.length);while(r<i){var s=r+i>>>1;n<e.call(t,t[s],s)?i=s:r=s+1}return r}}};var Zi=d3.bisector(function(e){return e});d3.bisectLeft=Zi.left,d3.bisect=d3.bisectRight=Zi.right,d3.first=function(e,t){var n=0,r=e.length,i=e[0],s;arguments.length===1&&(t=d3.ascending);while(++n<r)t.call(e,i,s=e[n])>0&&(i=s);return i},d3.last=function(e,t){var n=0,r=e.length,i=e[0],s;arguments.length===1&&(t=d3.ascending);while(++n<r)t.call(e,i,s=e[n])<=0&&(i=s);return i},d3.nest=function(){function e(t,s){if(s>=i.length)return u?u.call(n,t):o?t.sort(o):t;var a=-1,f=t.length,l=i[s++],c,h,p=new r,d,v={};while(++a<f)(d=p.get(c=l(h=t[a])))?d.push(h):p.set(c,[h]);return p.forEach(function(t,n){v[t]=e(n,s)}),v}function t(e,n){if(n>=i.length)return e;var r=[],o=s[n++],u;for(u in e)r.push({key:u,values:t(e[u],n)});return o&&r.sort(function(e,t){return o(e.key,t.key)}),r}var n={},i=[],s=[],o,u;return n.map=function(t){return e(t,0)},n.entries=function(n){return t(e(n,0),0)},n.key=function(e){return i.push(e),n},n.sortKeys=function(e){return s[i.length-1]=e,n},n.sortValues=function(e){return o=e,n},n.rollup=function(e){return u=e,n},n},d3.keys=function(e){var t=[];for(var n in e)t.push(n);return t},d3.values=function(e){var t=[];for(var n in e)t.push(e[n]);return t},d3.entries=function(e){var t=[];for(var n in e)t.push({key:n,value:e[n]});return t},d3.permute=function(e,t){var n=[],r=-1,i=t.length;while(++r<i)n[r]=e[t[r]];return n},d3.merge=function(e){return Array.prototype.concat.apply([],e)},d3.split=function(e,t){var n=[],r=[],i,s=-1,o=e.length;arguments.length<2&&(t=c);while(++s<o)t.call(r,i=e[s],s)?r=[]:(r.length||n.push(r),r.push(i));return n},d3.range=function(e,t,n){arguments.length<3&&(n=1,arguments.length<2&&(t=e,e=0));if((t-e)/n===Infinity)throw new Error("infinite range");var r=[],i=p(Math.abs(n)),s=-1,o;e*=i,t*=i,n*=i;if(n<0)while((o=e+n*++s)>t)r.push(o/i);else while((o=e+n*++s)<t)r.push(o/i);return r},d3.requote=function(e){return e.replace(es,"\\$&")};var es=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;d3.round=function(e,t){return t?Math.round(e*(t=Math.pow(10,t)))/t:Math.round(e)},d3.xhr=function(e,t,n){var r=new XMLHttpRequest;arguments.length<3?(n=t,t=null):t&&r.overrideMimeType&&r.overrideMimeType(t),r.open("GET",e,!0),t&&r.setRequestHeader("Accept",t),r.onreadystatechange=function(){if(r.readyState===4){var e=r.status;n(!e&&r.response||e>=200&&e<300||e===304?r:null)}},r.send(null)},d3.text=function(e,t,n){function r(e){n(e&&e.responseText)}arguments.length<3&&(n=t,t=null),d3.xhr(e,t,r)},d3.json=function(e,t){d3.text(e,"application/json",function(e){t(e?JSON.parse(e):null)})},d3.html=function(e,t){d3.text(e,"text/html",function(e){if(e!=null){var n=document.createRange();n.selectNode(document.body),e=n.createContextualFragment(e)}t(e)})},d3.xml=function(e,t,n){function r(e){n(e&&e.responseXML)}arguments.length<3&&(n=t,t=null),d3.xhr(e,t,r)};var ts={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};d3.ns={prefix:ts,qualify:function(e){var t=e.indexOf(":"),n=e;return t>=0&&(n=e.substring(0,t),e=e.substring(t+1)),ts.hasOwnProperty(n)?{space:ts[n],local:e}:e}},d3.dispatch=function(){var e=new d,t=-1,n=arguments.length;while(++t<n)e[arguments[t]]=v(e);return e},d.prototype.on=function(e,t){var n=e.indexOf("."),r="";return n>0&&(r=e.substring(n+1),e=e.substring(0,n)),arguments.length<2?this[e].on(r):this[e].on(r,t)},d3.format=function(e){var t=ns.exec(e),n=t[1]||" ",r=t[3]||"",i=t[5],s=+t[6],o=t[7],u=t[8],a=t[9],f=1,l="",c=!1;u&&(u=+u.substring(1)),i&&(n="0",o&&(s-=Math.floor((s-1)/4)));switch(a){case"n":o=!0,a="g";break;case"%":f=100,l="%",a="f";break;case"p":f=100,l="%",a="r";break;case"d":c=!0,u=0;break;case"s":f=-1,a="r"}return a=="r"&&!u&&(a="g"),a=rs.get(a)||g,function(e){if(c&&e%1)return"";var t=e<0&&(e=-e)?"-":r;if(f<0){var h=d3.formatPrefix(e,u);e=h.scale(e),l=h.symbol}else e*=f;e=a(e,u);if(i){var p=e.length+t.length;p<s&&(e=(new Array(s-p+1)).join(n)+e),o&&(e=y(e)),e=t+e}else{o&&(e=y(e)),e=t+e;var p=e.length;p<s&&(e=(new Array(s-p+1)).join(n)+e)}return e+l}};var ns=/(?:([^{])?([<>=^]))?([+\- ])?(#)?(0)?([0-9]+)?(,)?(\.[0-9]+)?([a-zA-Z%])?/,rs=d3.map({g:function(e,t){return e.toPrecision(t)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},r:function(e,t){return d3.round(e,t=m(e,t)).toFixed(Math.max(0,Math.min(20,t)))}}),is=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"].map(b);d3.formatPrefix=function(e,t){var n=0;return e&&(e<0&&(e*=-1),t&&(e=d3.round(e,m(e,t))),n=1+Math.floor(1e-12+Math.log(e)/Math.LN10),n=Math.max(-24,Math.min(24,Math.floor((n<=0?n+1:n-1)/3)*3))),is[8+n/3]};var ss=T(2),os=T(3),us=function(){return x},as=d3.map({linear:us,poly:T,quad:function(){return ss},cubic:function(){return os},sin:function(){return N},exp:function(){return C},circle:function(){return k},elastic:L,back:A,bounce:function(){return O}}),fs=d3.map({"in":x,out:E,"in-out":S,"out-in":function(e){return S(E(e))}});d3.ease=function(e){var t=e.indexOf("-"),n=t>=0?e.substring(0,t):e,r=t>=0?e.substring(t+1):"in";return n=as.get(n)||us,r=fs.get(r)||x,w(r(n.apply(null,Array.prototype.slice.call(arguments,1))))},d3.event=null,d3.transform=function(e){var t=document.createElementNS(d3.ns.prefix.svg,"g");return(d3.transform=function(e){t.setAttribute("transform",e);var n=t.transform.baseVal.consolidate();return new P(n?n.matrix:cs)})(e)},P.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var ls=180/Math.PI,cs={a:1,b:0,c:0,d:1,e:0,f:0};d3.interpolate=function(e,t){var n=d3.interpolators.length,r;while(--n>=0&&!(r=d3.interpolators[n](e,t)));return r},d3.interpolateNumber=function(e,t){return t-=e,function(n){return e+t*n}},d3.interpolateRound=function(e,t){return t-=e,function(n){return Math.round(e+t*n)}},d3.interpolateString=function(e,t){var n,r,i,s=0,o=0,u=[],a=[],f,l;hs.lastIndex=0;for(r=0;n=hs.exec(t);++r)n.index&&u.push(t.substring(s,o=n.index)),a.push({i:u.length,x:n[0]}),u.push(null),s=hs.lastIndex;s<t.length&&u.push(t.substring(s));for(r=0,f=a.length;(n=hs.exec(e))&&r<f;++r){l=a[r];if(l.x==n[0]){if(l.i)if(u[l.i+1]==null){u[l.i-1]+=l.x,u.splice(l.i,1);for(i=r+1;i<f;++i)a[i].i--}else{u[l.i-1]+=l.x+u[l.i+1],u.splice(l.i,2);for(i=r+1;i<f;++i)a[i].i-=2}else if(u[l.i+1]==null)u[l.i]=l.x;else{u[l.i]=l.x+u[l.i+1],u.splice(l.i+1,1);for(i=r+1;i<f;++i)a[i].i--}a.splice(r,1),f--,r--}else l.x=d3.interpolateNumber(parseFloat(n[0]),parseFloat(l.x))}while(r<f)l=a.pop(),u[l.i+1]==null?u[l.i]=l.x:(u[l.i]=l.x+u[l.i+1],u.splice(l.i+1,1)),f--;return u.length===1?u[0]==null?a[0].x:function(){return t}:function(e){for(r=0;r<f;++r)u[(l=a[r]).i]=l.x(e);return u.join("")}},d3.interpolateTransform=function(e,t){var n=[],r=[],i,s=d3.transform(e),o=d3.transform(t),u=s.translate,a=o.translate,f=s.rotate,l=o.rotate,c=s.skew,h=o.skew,p=s.scale,d=o.scale;return u[0]!=a[0]||u[1]!=a[1]?(n.push("translate(",null,",",null,")"),r.push({i:1,x:d3.interpolateNumber(u[0],a[0])},{i:3,x:d3.interpolateNumber(u[1],a[1])})):a[0]||a[1]?n.push("translate("+a+")"):n.push(""),f!=l?(f-l>180?l+=360:l-f>180&&(f+=360),r.push({i:n.push(n.pop()+"rotate(",null,")")-2,x:d3.interpolateNumber(f,l)})):l&&n.push(n.pop()+"rotate("+l+")"),c!=h?r.push({i:n.push(n.pop()+"skewX(",null,")")-2,x:d3.interpolateNumber(c,h)}):h&&n.push(n.pop()+"skewX("+h+")"),p[0]!=d[0]||p[1]!=d[1]?(i=n.push(n.pop()+"scale(",null,",",null,")"),r.push({i:i-4,x:d3.interpolateNumber(p[0],d[0])},{i:i-2,x:d3.interpolateNumber(p[1],d[1])})):(d[0]!=1||d[1]!=1)&&n.push(n.pop()+"scale("+d+")"),i=r.length,function(e){var t=-1,s;while(++t<i)n[(s=r[t]).i]=s.x(e);return n.join("")}},d3.interpolateRgb=function(e,t){e=d3.rgb(e),t=d3.rgb(t);var n=e.r,r=e.g,i=e.b,s=t.r-n,o=t.g-r,u=t.b-i;return function(e){return"#"+W(Math.round(n+s*e))+W(Math.round(r+o*e))+W(Math.round(i+u*e))}},d3.interpolateHsl=function(e,t){e=d3.hsl(e),t=d3.hsl(t);var n=e.h,r=e.s,i=e.l,s=t.h-n,o=t.s-r,u=t.l-i;return s>180?s-=360:s<-180&&(s+=360),function(e){return Y(n+s*e,r+o*e,i+u*e)+""}},d3.interpolateLab=function(e,t){e=d3.lab(e),t=d3.lab(t);var n=e.l,r=e.a,i=e.b,s=t.l-n,o=t.a-r,u=t.b-i;return function(e){return it(n+s*e,r+o*e,i+u*e)+""}},d3.interpolateHcl=function(e,t){e=d3.hcl(e),t=d3.hcl(t);var n=e.h,r=e.c,i=e.l,s=t.h-n,o=t.c-r,u=t.l-i;return s>180?s-=360:s<-180&&(s+=360),function(e){return tt(n+s*e,r+o*e,i+u*e)+""}},d3.interpolateArray=function(e,t){var n=[],r=[],i=e.length,s=t.length,o=Math.min(e.length,t.length),u;for(u=0;u<o;++u)n.push(d3.interpolate(e[u],t[u]));for(;u<i;++u)r[u]=e[u];for(;u<s;++u)r[u]=t[u];return function(e){for(u=0;u<o;++u)r[u]=n[u](e);return r}},d3.interpolateObject=function(e,t){var n={},r={},i;for(i in e)i in t?n[i]=F(i)(e[i],t[i]):r[i]=e[i];for(i in t)i in e||(r[i]=t[i]);return function(e){for(i in n)r[i]=n[i](e);return r}};var hs=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;d3.interpolators=[d3.interpolateObject,function(e,t){return t instanceof Array&&d3.interpolateArray(e,t)},function(e,t){return(typeof e=="string"||typeof t=="string")&&d3.interpolateString(e+"",t+"")},function(e,t){return(typeof t=="string"?ds.has(t)||/^(#|rgb\(|hsl\()/.test(t):t instanceof R)&&d3.interpolateRgb(e,t)},function(e,t){return!isNaN(e=+e)&&!isNaN(t=+t)&&d3.interpolateNumber(e,t)}],R.prototype.toString=function(){return this.rgb()+""},d3.rgb=function(e,t,n){return arguments.length===1?e instanceof z?U(e.r,e.g,e.b):X(""+e,U,Y):U(~~e,~~t,~~n)};var ps=z.prototype=new R;ps.brighter=function(e){e=Math.pow(.7,arguments.length?e:1);var t=this.r,n=this.g,r=this.b,i=30;return!t&&!n&&!r?U(i,i,i):(t&&t<i&&(t=i),n&&n<i&&(n=i),r&&r<i&&(r=i),U(Math.min(255,Math.floor(t/e)),Math.min(255,Math.floor(n/e)),Math.min(255,Math.floor(r/e))))},ps.darker=function(e){return e=Math.pow(.7,arguments.length?e:1),U(Math.floor(e*this.r),Math.floor(e*this.g),Math.floor(e*this.b))},ps.hsl=function(){return V(this.r,this.g,this.b)},ps.toString=function(){return"#"+W(this.r)+W(this.g)+W(this.b)};var ds=d3.map({aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"});ds.forEach(function(e,t){ds.set(e,X(t,U,Y))}),d3.hsl=function(e,t,n){return arguments.length===1?e instanceof G?Q(e.h,e.s,e.l):X(""+e,V,Q):Q(+e,+t,+n)};var vs=G.prototype=new R;vs.brighter=function(e){return e=Math.pow(.7,arguments.length?e:1),Q(this.h,this.s,this.l/e)},vs.darker=function(e){return e=Math.pow(.7,arguments.length?e:1),Q(this.h,this.s,e*this.l)},vs.rgb=function(){return Y(this.h,this.s,this.l)},d3.hcl=function(e,t,n){return arguments.length===1?e instanceof et?Z(e.h,e.c,e.l):e instanceof rt?st(e.l,e.a,e.b):st((e=$((e=d3.rgb(e)).r,e.g,e.b)).l,e.a,e.b):Z(+e,+t,+n)};var ms=et.prototype=new R;ms.brighter=function(e){return Z(this.h,this.c,Math.min(100,this.l+gs*(arguments.length?e:1)))},ms.darker=function(e){return Z(this.h,this.c,Math.max(0,this.l-gs*(arguments.length?e:1)))},ms.rgb=function(){return tt(this.h,this.c,this.l).rgb()},d3.lab=function(e,t,n){return arguments.length===1?e instanceof rt?nt(e.l,e.a,e.b):e instanceof et?tt(e.l,e.c,e.h):$((e=d3.rgb(e)).r,e.g,e.b):nt(+e,+t,+n)};var gs=18,ys=.95047,bs=1,ws=1.08883,Es=rt.prototype=new R;Es.brighter=function(e){return nt(Math.min(100,this.l+gs*(arguments.length?e:1)),this.a,this.b)},Es.darker=function(e){return nt(Math.max(0,this.l-gs*(arguments.length?e:1)),this.a,this.b)},Es.rgb=function(){return it(this.l,this.a,this.b)};var Ss=function(e,t){return t.querySelector(e)},xs=function(e,t){return t.querySelectorAll(e)},Ts=document.documentElement,Ns=Ts.matchesSelector||Ts.webkitMatchesSelector||Ts.mozMatchesSelector||Ts.msMatchesSelector||Ts.oMatchesSelector,Cs=function(e,t){return Ns.call(e,t)};typeof Sizzle=="function"&&(Ss=function(e,t){return Sizzle(e,t)[0]||null},xs=function(e,t){return Sizzle.uniqueSort(Sizzle(e,t))},Cs=Sizzle.matchesSelector);var ks=[];d3.selection=function(){return Ls},d3.selection.prototype=ks,ks.select=function(e){var t=[],n,r,i,s;typeof e!="function"&&(e=lt(e));for(var o=-1,u=this.length;++o<u;){t.push(n=[]),n.parentNode=(i=this[o]).parentNode;for(var a=-1,f=i.length;++a<f;)(s=i[a])?(n.push(r=e.call(s,s.__data__,a)),r&&"__data__"in s&&(r.__data__=s.__data__)):n.push(null)}return ft(t)},ks.selectAll=function(e){var t=[],n,r;typeof e!="function"&&(e=ct(e));for(var i=-1,s=this.length;++i<s;)for(var o=this[i],u=-1,a=o.length;++u<a;)if(r=o[u])t.push(n=Ji(e.call(r,r.__data__,u))),n.parentNode=r;return ft(t)},ks.attr=function(e,t){if(arguments.length<2){if(typeof e=="string"){var n=this.node();return e=d3.ns.qualify(e),e.local?n.getAttributeNS(e.space,e.local):n.getAttribute(e)}for(t in e)this.each(ht(t,e[t]));return this}return this.each(ht(e,t))},ks.classed=function(e,t){if(arguments.length<2){if(typeof e=="string"){var n=this.node(),r=(e=e.trim().split(/^|\s+/g)).length,i=-1;if(t=n.classList){while(++i<r)if(!t.contains(e[i]))return!1}else{t=n.className,t.baseVal!=null&&(t=t.baseVal);while(++i<r)if(!pt(e[i]).test(t))return!1}return!0}for(t in e)this.each(dt(t,e[t]));return this}return this.each(dt(e,t))},ks.style=function(e,t,n){var r=arguments.length;if(r<3){if(typeof e!="string"){r<2&&(t="");for(n in e)this.each(mt(n,e[n],t));return this}if(r<2)return window.getComputedStyle(this.node(),null).getPropertyValue(e);n=""}return this.each(mt(e,t,n))},ks.property=function(e,t){if(arguments.length<2){if(typeof e=="string")return this.node()[e];for(t in e)this.each(gt(t,e[t]));return this}return this.each(gt(e,t))},ks.text=function(e){return arguments.length<1?this.node().textContent:this.each(typeof e=="function"?function(){var t=e.apply(this,arguments);this.textContent=t==null?"":t}:e==null?function(){this.textContent=""}:function(){this.textContent=e})},ks.html=function(e){return arguments.length<1?this.node().innerHTML:this.each(typeof e=="function"?function(){var t=e.apply(this,arguments);this.innerHTML=t==null?"":t}:e==null?function(){this.innerHTML=""}:function(){this.innerHTML=e})},ks.append=function(e){function t(){return this.appendChild(document.createElementNS(this.namespaceURI,e))}function n(){return this.appendChild(document.createElementNS(e.space,e.local))}return e=d3.ns.qualify(e),this.select(e.local?n:t)},ks.insert=function(e,t){function n(){return this.insertBefore(document.createElementNS(this.namespaceURI,e),Ss(t,this))}function r(){return this.insertBefore(document.createElementNS(e.space,e.local),Ss(t,this))}return e=d3.ns.qualify(e),this.select(e.local?r:n)},ks.remove=function(){return this.each(function(){var e=this.parentNode;e&&e.removeChild(this)})},ks.data=function(e,t){function n(e,n){var i,s=e.length,o=n.length,u=Math.min(s,o),c=Math.max(s,o),h=[],p=[],d=[],v,m;if(t){var g=new r,y=[],b,w=n.length;for(i=-1;++i<s;)b=t.call(v=e[i],v.__data__,i),g.has(b)?d[w++]=v:g.set(b,v),y.push(b);for(i=-1;++i<o;)b=t.call(n,m=n[i],i),g.has(b)?(h[i]=v=g.get(b),v.__data__=m,p[i]=d[i]=null):(p[i]=yt(m),h[i]=d[i]=null),g.remove(b);for(i=-1;++i<s;)g.has(y[i])&&(d[i]=e[i])}else{for(i=-1;++i<u;)v=e[i],m=n[i],v?(v.__data__=m,h[i]=v,p[i]=d[i]=null):(p[i]=yt(m),h[i]=d[i]=null);for(;i<o;++i)p[i]=yt(n[i]),h[i]=d[i]=null;for(;i<c;++i)d[i]=e[i],p[i]=h[i]=null}p.update=h,p.parentNode=h.parentNode=d.parentNode=e.parentNode,a.push(p),f.push(h),l.push(d)}var i=-1,s=this.length,o,u;if(!arguments.length){e=new Array(s=(o=this[0]).length);while(++i<s)if(u=o[i])e[i]=u.__data__;return e}var a=xt([]),f=ft([]),l=ft([]);if(typeof e=="function")while(++i<s)n(o=this[i],e.call(o,o.parentNode.__data__,i));else while(++i<s)n(o=this[i],e);return f.enter=function(){return a},f.exit=function(){return l},f},ks.datum=ks.map=function(e){return arguments.length<1?this.property("__data__"):this.property("__data__",e)},ks.filter=function(e){var t=[],n,r,i;typeof e!="function"&&(e=bt(e));for(var s=0,o=this.length;s<o;s++){t.push(n=[]),n.parentNode=(r=this[s]).parentNode;for(var u=0,a=r.length;u<a;u++)(i=r[u])&&e.call(i,i.__data__,u)&&n.push(i)}return ft(t)},ks.order=function(){for(var e=-1,t=this.length;++e<t;)for(var n=this[e],r=n.length-1,i=n[r],s;--r>=0;)if(s=n[r])i&&i!==s.nextSibling&&i.parentNode.insertBefore(s,i),i=s;return this},ks.sort=function(e){e=wt.apply(this,arguments);for(var t=-1,n=this.length;++t<n;)this[t].sort(e);return this.order()},ks.on=function(e,t,n){var r=arguments.length;if(r<3){if(typeof e!="string"){r<2&&(t=!1);for(n in e)this.each(Et(n,e[n],t));return this}if(r<2)return(r=this.node()["__on"+e])&&r._;n=!1}return this.each(Et(e,t,n))},ks.each=function(e){return St(this,function(t,n,r){e.call(t,t.__data__,n,r)})},ks.call=function(e){return e.apply(this,(arguments[0]=this,arguments)),this},ks.empty=function(){return!this.node()},ks.node=function(e){for(var t=0,n=this.length;t<n;t++)for(var r=this[t],i=0,s=r.length;i<s;i++){var o=r[i];if(o)return o}return null},ks.transition=function(){var e=[],t,n;for(var r=-1,i=this.length;++r<i;){e.push(t=[]);for(var s=this[r],o=-1,u=s.length;++o<u;)t.push((n=s[o])?{node:n,delay:Bs,duration:js}:null)}return Tt(e,_s||++Ms,Date.now())};var Ls=ft([[document]]);Ls[0].parentNode=Ts,d3.select=function(e){return typeof e=="string"?Ls.select(e):ft([[e]])},d3.selectAll=function(e){return typeof e=="string"?Ls.selectAll(e):ft([Ji(e)])};var As=[];d3.selection.enter=xt,d3.selection.enter.prototype=As,As.append=ks.append,As.insert=ks.insert,As.empty=ks.empty,As.node=ks.node,As.select=function(e){var t=[],n,r,i,s,o;for(var u=-1,a=this.length;++u<a;){i=(s=this[u]).update,t.push(n=[]),n.parentNode=s.parentNode;for(var f=-1,l=s.length;++f<l;)(o=s[f])?(n.push(i[f]=r=e.call(s.parentNode,o.__data__,f)),r.__data__=o.__data__):n.push(null)}return ft(t)};var Os=[],Ms=0,_s=0,Ds=0,Ps=250,Hs=d3.ease("cubic-in-out"),Bs=Ds,js=Ps,Fs=Hs;Os.call=ks.call,d3.transition=function(e){return arguments.length?_s?e.transition():e:Ls.transition()},d3.transition.prototype=Os,Os.select=function(e){var t=[],n,r,i;typeof e!="function"&&(e=lt(e));for(var s=-1,o=this.length;++s<o;){t.push(n=[]);for(var u=this[s],a=-1,f=u.length;++a<f;)(i=u[a])&&(r=e.call(i.node,i.node.__data__,a))?("__data__"in i.node&&(r.__data__=i.node.__data__),n.push({node:r,delay:i.delay,duration:i.duration})):n.push(null)}return Tt(t,this.id,this.time).ease(this.ease())},Os.selectAll=function(e){var t=[],n,r,i;typeof e!="function"&&(e=ct(e));for(var s=-1,o=this.length;++s<o;)for(var u=this[s],a=-1,f=u.length;++a<f;)if(i=u[a]){r=e.call(i.node,i.node.__data__,a),t.push(n=[]);for(var l=-1,c=r.length;++l<c;)n.push({node:r[l],delay:i.delay,duration:i.duration})}return Tt(t,this.id,this.time).ease(this.ease())},Os.filter=function(e){var t=[],n,r,i;typeof e!="function"&&(e=bt(e));for(var s=0,o=this.length;s<o;s++){t.push(n=[]);for(var r=this[s],u=0,a=r.length;u<a;u++)(i=r[u])&&e.call(i.node,i.node.__data__,u)&&n.push(i)}return Tt(t,this.id,this.time).ease(this.ease())},Os.attr=function(e,t){if(arguments.length<2){for(t in e)this.attrTween(t,kt(e[t],t));return this}return this.attrTween(e,kt(t,e))},Os.attrTween=function(e,t){function n(e,n){var r=t.call(this,e,n,this.getAttribute(i));return r===Is?(this.removeAttribute(i),null):r&&function(e){this.setAttribute(i,r(e))}}function r(e,n){var r=t.call(this,e,n,this.getAttributeNS(i.space,i.local));return r===Is?(this.removeAttributeNS(i.space,i.local),null):r&&function(e){this.setAttributeNS(i.space,i.local,r(e))}}var i=d3.ns.qualify(e);return this.tween("attr."+e,i.local?r:n)},Os.style=function(e,t,n){var r=arguments.length;if(r<3){if(typeof e!="string"){r<2&&(t="");for(n in e)this.styleTween(n,kt(e[n],n),t);return this}n=""}return this.styleTween(e,kt(t,e),n)},Os.styleTween=function(e,t,n){return arguments.length<3&&(n=""),this.tween("style."+e,function(r,i){var s=t.call(this,r,i,window.getComputedStyle(this,null).getPropertyValue(e));return s===Is?(this.style.removeProperty(e),null):s&&function(t){this.style.setProperty(e,s(t),n)}})},Os.text=function(e){return this.tween("text",function(t,n){this.textContent=typeof e=="function"?e.call(this,t,n):e})},Os.remove=function(){return this.each("end.transition",function(){var e;!this.__transition__&&(e=this.parentNode)&&e.removeChild(this)})},Os.delay=function(e){return St(this,typeof e=="function"?function(t,n,r){t.delay=e.call(t=t.node,t.__data__,n,r)|0}:(e|=0,function(t){t.delay=e}))},Os.duration=function(e){return St(this,typeof e=="function"?function(t,n,r){t.duration=Math.max(1,e.call(t=t.node,t.__data__,n,r)|0)}:(e=Math.max(1,e|0),function(t){t.duration=e}))},Os.transition=function(){return this.select(s)},d3.tween=function(e,t){function n(n,r,i){var s=e.call(this,n,r);return s==null?i!=""&&Is:i!=s&&t(i,s+"")}function r(n,r,i){return i!=e&&t(i,e)}return typeof e=="function"?n:e==null?Ct:(e+="",r)};var Is={},qs=0,Rs={},Us=null,zs,Ws;d3.timer=function(e,t,n){if(arguments.length<3){if(arguments.length<2)t=0;else if(!isFinite(t))return;n=Date.now()}var r=Rs[e.id];r&&r.callback===e?(r.then=n,r.delay=t):Rs[e.id=++qs]=Us={callback:e,then:n,delay:t,next:Us},zs||(Ws=clearTimeout(Ws),zs=1,Xs(Lt))},d3.timer.flush=function(){var e,t=Date.now(),n=Us;while(n)e=t-n.then,n.delay||(n.flush=n.callback(e)),n=n.next;At()};var Xs=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,17)};d3.mouse=function(e){return Ot(e,_())};var Vs=/WebKit/.test(navigator.userAgent)?-1:0;d3.touches=function(e,t){return arguments.length<2&&(t=_().touches),t?Ji(t).map(function(t){var n=Ot(e,t);return n.identifier=t.identifier,n}):[]},d3.scale={},d3.scale.linear=function(){return Bt([0,1],[0,1],d3.interpolate,!1)},d3.scale.log=function(){return Wt(d3.scale.linear(),Xt)};var $s=d3.format(".0e");Xt.pow=function(e){return Math.pow(10,e)},Vt.pow=function(e){return-Math.pow(10,-e)},d3.scale.pow=function(){return $t(d3.scale.linear(),1)},d3.scale.sqrt=function(){return d3.scale.pow().exponent(.5)},d3.scale.ordinal=function(){return Kt([],{t:"range",a:[[]]})},d3.scale.category10=function(){return d3.scale.ordinal().range(Js)},d3.scale.category20=function(){return d3.scale.ordinal().range(Ks)},d3.scale.category20b=function(){return d3.scale.ordinal().range(Qs)},d3.scale.category20c=function(){return d3.scale.ordinal().range(Gs)};var Js=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],Ks=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],Qs=["#393b79","#5254a3","#6b6ecf","#9c9ede","#637939","#8ca252","#b5cf6b","#cedb9c","#8c6d31","#bd9e39","#e7ba52","#e7cb94","#843c39","#ad494a","#d6616b","#e7969c","#7b4173","#a55194","#ce6dbd","#de9ed6"],Gs=["#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"];d3.scale.quantile=function(){return Qt([],[])},d3.scale.quantize=function(){return Gt(0,1,[0,1])},d3.scale.threshold=function(){return Yt([.5],[0,1])},d3.scale.identity=function(){return Zt([0,1])},d3.svg={},d3.svg.arc=function(){function e(){var e=t.apply(this,arguments),s=n.apply(this,arguments),o=r.apply(this,arguments)+Ys,u=i.apply(this,arguments)+Ys,a=(u<o&&(a=o,o=u,u=a),u-o),f=a<Math.PI?"0":"1",l=Math.cos(o),c=Math.sin(o),h=Math.cos(u),p=Math.sin(u);return a>=Zs?e?"M0,"+s+"A"+s+","+s+" 0 1,1 0,"+ -s+"A"+s+","+s+" 0 1,1 0,"+s+"M0,"+e+"A"+e+","+e+" 0 1,0 0,"+ -e+"A"+e+","+e+" 0 1,0 0,"+e+"Z":"M0,"+s+"A"+s+","+s+" 0 1,1 0,"+ -s+"A"+s+","+s+" 0 1,1 0,"+s+"Z":e?"M"+s*l+","+s*c+"A"+s+","+s+" 0 "+f+",1 "+s*h+","+s*p+"L"+e*h+","+e*p+"A"+e+","+e+" 0 "+f+",0 "+e*l+","+e*c+"Z":"M"+s*l+","+s*c+"A"+s+","+s+" 0 "+f+",1 "+s*h+","+s*p+"L0,0"+"Z"}var t=en,n=tn,r=nn,i=rn;return e.innerRadius=function(n){return arguments.length?(t=u(n),e):t},e.outerRadius=function(t){return arguments.length?(n=u(t),e):n},e.startAngle=function(t){return arguments.length?(r=u(t),e):r},e.endAngle=function(t){return arguments.length?(i=u(t),e):i},e.centroid=function(){var e=(t.apply(this,arguments)+n.apply(this,arguments))/2,s=(r.apply(this,arguments)+i.apply(this,arguments))/2+Ys;return[Math.cos(s)*e,Math.sin(s)*e]},e};var Ys=-Math.PI/2,Zs=2*Math.PI-1e-6;d3.svg.line=function(){return sn(i)};var eo=d3.map({linear:an,"linear-closed":fn,"step-before":ln,"step-after":cn,basis:gn,"basis-open":yn,"basis-closed":bn,bundle:wn,cardinal:dn,"cardinal-open":hn,"cardinal-closed":pn,monotone:Cn});eo.forEach(function(e,t){t.key=e,t.closed=/-closed$/.test(e)});var to=[0,2/3,1/3,0],no=[0,1/3,2/3,0],ro=[0,1/6,2/3,1/6];d3.svg.line.radial=function(){var e=sn(kn);return e.radius=e.x,delete e.x,e.angle=e.y,delete e.y,e},ln.reverse=cn,cn.reverse=ln,d3.svg.area=function(){return Ln(i)},d3.svg.area.radial=function(){var e=Ln(kn);return e.radius=e.x,delete e.x,e.innerRadius=e.x0,delete e.x0,e.outerRadius=e.x1,delete e.x1,e.angle=e.y,delete e.y,e.startAngle=e.y0,delete e.y0,e.endAngle=e.y1,delete e.y1,e},d3.svg.chord=function(){function e(e,u){var a=t(this,s,e,u),f=t(this,o,e,u);return"M"+a.p0+r(a.r,a.p1,a.a1-a.a0)+(n(a,f)?i(a.r,a.p1,a.r,a.p0):i(a.r,a.p1,f.r,f.p0)+r(f.r,f.p1,f.a1-f.a0)+i(f.r,f.p1,a.r,a.p0))+"Z"}function t(e,t,n,r){var i=t.call(e,n,r),s=a.call(e,i,r),o=f.call(e,i,r)+Ys,u=l.call(e,i,r)+Ys;return{r:s,a0:o,a1:u,p0:[s*Math.cos(o),s*Math.sin(o)],p1:[s*Math.cos(u),s*Math.sin(u)]}}function n(e,t){return e.a0==t.a0&&e.a1==t.a1}function r(e,t,n){return"A"+e+","+e+" 0 "+ +(n>Math.PI)+",1 "+t}function i(e,t,n,r){return"Q 0,0 "+r}var s=An,o=On,a=Mn,f=nn,l=rn;return e.radius=function(t){return arguments.length?(a=u(t),e):a},e.source=function(t){return arguments.length?(s=u(t),e):s},e.target=function(t){return arguments.length?(o=u(t),e):o},e.startAngle=function(t){return arguments.length?(f=u(t),e):f},e.endAngle=function(t){return arguments.length?(l=u(t),e):l},e},d3.svg.diagonal=function(){function e(e,i){var s=t.call(this,e,i),o=n.call(this,e,i),u=(s.y+o.y)/2,a=[s,{x:s.x,y:u},{x:o.x,y:u},o];return a=a.map(r),"M"+a[0]+"C"+a[1]+" "+a[2]+" "+a[3]}var t=An,n=On,r=Pn;return e.source=function(n){return arguments.length?(t=u(n),e):t},e.target=function(t){return arguments.length?(n=u(t),e):n},e.projection=function(t){return arguments.length?(r=t,e):r},e},d3.svg.diagonal.radial=function(){var e=d3.svg.diagonal(),t=Pn,n=e.projection;return e.projection=function(e){return arguments.length?n(Hn(t=e)):t},e},d3.svg.mouse=d3.mouse,d3.svg.touches=d3.touches,d3.svg.symbol=function(){function e(e,r){return(io.get(t.call(this,e,r))||Fn)(n.call(this,e,r))}var t=jn,n=Bn;return e.type=function(n){return arguments.length?(t=u(n),e):t},e.size=function(t){return arguments.length?(n=u(t),e):n},e};var io=d3.map({circle:Fn,cross:function(e){var t=Math.sqrt(e/5)/2;return"M"+ -3*t+","+ -t+"H"+ -t+"V"+ -3*t+"H"+t+"V"+ -t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+ -t+"V"+t+"H"+ -3*t+"Z"},diamond:function(e){var t=Math.sqrt(e/(2*oo)),n=t*oo;return"M0,"+ -t+"L"+n+",0"+" 0,"+t+" "+ -n+",0"+"Z"},square:function(e){var t=Math.sqrt(e)/2;return"M"+ -t+","+ -t+"L"+t+","+ -t+" "+t+","+t+" "+ -t+","+t+"Z"},"triangle-down":function(e){var t=Math.sqrt(e/so),n=t*so/2;return"M0,"+n+"L"+t+","+ -n+" "+ -t+","+ -n+"Z"},"triangle-up":function(e){var t=Math.sqrt(e/so),n=t*so/2;return"M0,"+ -n+"L"+t+","+n+" "+ -t+","+n+"Z"}});d3.svg.symbolTypes=io.keys();var so=Math.sqrt(3),oo=Math.tan(30*Math.PI/180);d3.svg.axis=function(){function e(e){e.each(function(){var e=d3.select(this),c=a==null?t.ticks?t.ticks.apply(t,u):t.domain():a,h=f==null?t.tickFormat?t.tickFormat.apply(t,u):String:f,p=Rn(t,c,l),d=e.selectAll(".minor").data(p,String),v=d.enter().insert("line","g").attr("class","tick minor").style("opacity",1e-6),m=d3.transition(d.exit()).style("opacity",1e-6).remove(),g=d3.transition(d).style("opacity",1),y=e.selectAll("g").data(c,String),b=y.enter().insert("g","path").style("opacity",1e-6),w=d3.transition(y.exit()).style("opacity",1e-6).remove(),E=d3.transition(y).style("opacity",1),S,x=Dt(t),T=e.selectAll(".domain").data([0]),N=T.enter().append("path").attr("class","domain"),C=d3.transition(T),k=t.copy(),L=this.__chart__||k;this.__chart__=k,b.append("line").attr("class","tick"),b.append("text");var A=b.select("line"),O=E.select("line"),M=y.select("text").text(h),_=b.select("text"),D=E.select("text");switch(n){case"bottom":S=In,v.attr("y2",i),g.attr("x2",0).attr("y2",i),A.attr("y2",r),_.attr("y",Math.max(r,0)+o),O.attr("x2",0).attr("y2",r),D.attr("x",0).attr("y",Math.max(r,0)+o),M.attr("dy",".71em").attr("text-anchor","middle"),C.attr("d","M"+x[0]+","+s+"V0H"+x[1]+"V"+s);break;case"top":S=In,v.attr("y2",-i),g.attr("x2",0).attr("y2",-i),A.attr("y2",-r),_.attr("y",-(Math.max(r,0)+o)),O.attr("x2",0).attr("y2",-r),D.attr("x",0).attr("y",-(Math.max(r,0)+o)),M.attr("dy","0em").attr("text-anchor","middle"),C.attr("d","M"+x[0]+","+ -s+"V0H"+x[1]+"V"+ -s);break;case"left":S=qn,v.attr("x2",-i),g.attr("x2",-i).attr("y2",0),A.attr("x2",-r),_.attr("x",-(Math.max(r,0)+o)),O.attr("x2",-r).attr("y2",0),D.attr("x",-(Math.max(r,0)+o)).attr("y",0),M.attr("dy",".32em").attr("text-anchor","end"),C.attr("d","M"+ -s+","+x[0]+"H0V"+x[1]+"H"+ -s);break;case"right":S=qn,v.attr("x2",i),g.attr("x2",i).attr("y2",0),A.attr("x2",r),_.attr("x",Math.max(r,0)+o),O.attr("x2",r).attr("y2",0),D.attr("x",Math.max(r,0)+o).attr("y",0),M.attr("dy",".32em").attr("text-anchor","start"),C.attr("d","M"+s+","+x[0]+"H0V"+x[1]+"H"+s)}if(t.ticks)b.call(S,L),E.call(S,k),w.call(S,k),v.call(S,L),g.call(S,k),m.call(S,k);else{var P=k.rangeBand()/2,H=function(e){return k(e)+P};b.call(S,H),E.call(S,H)}})}var t=d3.scale.linear(),n="bottom",r=6,i=6,s=6,o=3,u=[10],a=null,f,l=0;return e.scale=function(n){return arguments.length?(t=n,e):t},e.orient=function(t){return arguments.length?(n=t,e):n},e.ticks=function(){return arguments.length?(u=arguments,e):u},e.tickValues=function(t){return arguments.length?(a=t,e):a},e.tickFormat=function(t){return arguments.length?(f=t,e):f},e.tickSize=function(t,n,o){if(!arguments.length)return r;var u=arguments.length-1;return r=+t,i=u>1?+n:r,s=u>0?+arguments[u]:r,e},e.tickPadding=function(t){return arguments.length?(o=+t,e):o},e.tickSubdivide=function(t){return arguments.length?(l=+t,e):l},e},d3.svg.brush=function(){function e(s){s.each(function(){var s=d3.select(this),f=s.selectAll(".background").data([0]),l=s.selectAll(".extent").data([0]),c=s.selectAll(".resize").data(a,String),h;s.style("pointer-events","all").on("mousedown.brush",i).on("touchstart.brush",i),f.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),l.enter().append("rect").attr("class","extent").style("cursor","move"),c.enter().append("g").attr("class",function(e){return"resize "+e}).style("cursor",function(e){return uo[e]}).append("rect").attr("x",function(e){return/[ew]$/.test(e)?-3:null}).attr("y",function(e){return/^[ns]/.test(e)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),c.style("display",e.empty()?"none":null),c.exit().remove(),o&&(h=Dt(o),f.attr("x",h[0]).attr("width",h[1]-h[0]),n(s)),u&&(h=Dt(u),f.attr("y",h[0]).attr("height",h[1]-h[0]),r(s)),t(s)})}function t(e){e.selectAll(".resize").attr("transform",function(e){return"translate("+f[+/e$/.test(e)][0]+","+f[+/^s/.test(e)][1]+")"})}function n(e){e.select(".extent").attr("x",f[0][0]),e.selectAll(".extent,.n>rect,.s>rect").attr("width",f[1][0]-f[0][0])}function r(e){e.select(".extent").attr("y",f[0][1]),e.selectAll(".extent,.e>rect,.w>rect").attr("height",f[1][1]-f[0][1])}function i(){function i(){var e=d3.event.changedTouches;return e?d3.touches(v,e)[0]:d3.mouse(v)}function a(){d3.event.keyCode==32&&(S||(x=null,T[0]-=f[1][0],T[1]-=f[1][1],S=2),M())}function c(){d3.event.keyCode==32&&S==2&&(T[0]+=f[1][0],T[1]+=f[1][1],S=0,M())}function h(){var e=i(),s=!1;N&&(e[0]+=N[0],e[1]+=N[1]),S||(d3.event.altKey?(x||(x=[(f[0][0]+f[1][0])/2,(f[0][1]+f[1][1])/2]),T[0]=f[+(e[0]<x[0])][0],T[1]=f[+(e[1]<x[1])][1]):x=null),w&&p(e,o,0)&&(n(y),s=!0),E&&p(e,u,1)&&(r(y),s=!0),s&&(t(y),g({type:"brush",mode:S?"move":"resize"}))}function p(e,t,n){var r=Dt(t),i=r[0],s=r[1],o=T[n],u=f[1][n]-f[0][n],a,c;S&&(i-=o,s-=u+o),a=Math.max(i,Math.min(s,e[n])),S?c=(a+=o)+u:(x&&(o=Math.max(i,Math.min(s,2*x[n]-a))),o<a?(c=a,a=o):c=o);if(f[0][n]!==a||f[1][n]!==c)return l=null,f[0][n]=a,f[1][n]=c,!0}function d(){h(),y.style("pointer-events","all").selectAll(".resize").style("display",e.empty()?"none":null),d3.select("body").style("cursor",null),C.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),g({type:"brushend"}),M()}var v=this,m=d3.select(d3.event.target),g=s.of(v,arguments),y=d3.select(v),b=m.datum(),w=!/^(n|s)$/.test(b)&&o,E=!/^(e|w)$/.test(b)&&u,S=m.classed("extent"),x,T=i(),N,C=d3.select(window).on("mousemove.brush",h).on("mouseup.brush",d).on("touchmove.brush",h).on("touchend.brush",d).on("keydown.brush",a).on("keyup.brush",c);if(S)T[0]=f[0][0]-T[0],T[1]=f[0][1]-T[1];else if(b){var k=+/w$/.test(b),L=+/^n/.test(b);N=[f[1-k][0]-T[0],f[1-L][1]-T[1]],T[0]=f[k][0],T[1]=f[L][1]}else d3.event.altKey&&(x=T.slice());y.style("pointer-events","none").selectAll(".resize").style("display",null),d3.select("body").style("cursor",m.style("cursor")),g({type:"brushstart"}),h(),M()}var s=D(e,"brushstart","brush","brushend"),o=null,u=null,a=ao[0],f=[[0,0],[0,0]],l;return e.x=function(t){return arguments.length?(o=t,a=ao[!o<<1|!u],e):o},e.y=function(t){return arguments.length?(u=t,a=ao[!o<<1|!u],e):u},e.extent=function(t){var n,r,i,s,a;return arguments.length?(l=[[0,0],[0,0]],o&&(n=t[0],r=t[1],u&&(n=n[0],r=r[0]),l[0][0]=n,l[1][0]=r,o.invert&&(n=o(n),r=o(r)),r<n&&(a=n,n=r,r=a),f[0][0]=n|0,f[1][0]=r|0),u&&(i=t[0],s=t[1],o&&(i=i[1],s=s[1]),l[0][1]=i,l[1][1]=s,u.invert&&(i=u(i),s=u(s)),s<i&&(a=i,i=s,s=a),f[0][1]=i|0,f[1][1]=s|0),e):(t=l||f,o&&(n=t[0][0],r=t[1][0],l||(n=f[0][0],r=f[1][0],o.invert&&(n=o.invert(n),r=o.invert(r)),r<n&&(a=n,n=r,r=a))),u&&(i=t[0][1],s=t[1][1],l||(i=f[0][1],s=f[1][1],u.invert&&(i=u.invert(i),s=u.invert(s)),s<i&&(a=i,i=s,s=a))),o&&u?[[n,i],[r,s]]:o?[n,r]:u&&[i,s])},e.clear=function(){return l=null,f[0][0]=f[0][1]=f[1][0]=f[1][1]=0,e},e.empty=function(){return o&&f[0][0]===f[1][0]||u&&f[0][1]===f[1][1]},d3.rebind(e,s,"on")};var uo={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},ao=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];d3.behavior={},d3.behavior.drag=function(){function e(){this.on("mousedown.drag",t).on("touchstart.drag",t)}function t(){function e(){var e=o.parentNode;return f?d3.touches(e).filter(function(e){return e.identifier===f})[0]:d3.mouse(e)}function t(){if(!o.parentNode)return i();var t=e(),n=t[0]-c[0],r=t[1]-c[1];h|=n|r,c=t,M(),u({type:"drag",x:t[0]+l[0],y:t[1]+l[1],dx:n,dy:r})}function i(){u({type:"dragend"}),h&&(M(),d3.event.target===a&&p.on("click.drag",s,!0)),p.on(f?"touchmove.drag-"+f:"mousemove.drag",null).on(f?"touchend.drag-"+f:"mouseup.drag",null)}function s(){M(),p.on("click.drag",null)}var o=this,u=n.of(o,arguments),a=d3.event.target,f=d3.event.touches&&d3.event.changedTouches[0].identifier,l,c=e(),h=0,p=d3.select(window).on(f?"touchmove.drag-"+f:"mousemove.drag",t).on(f?"touchend.drag-"+f:"mouseup.drag",i,!0);r?(l=r.apply(o,arguments),l=[l.x-c[0],l.y-c[1]]):l=[0,0],f||M(),u({type:"dragstart"})}var n=D(e,"drag","dragstart","dragend"),r=null;return e.origin=function(t){return arguments.length?(r=t,e):r},d3.rebind(e,n,"on")},d3.behavior.zoom=function(){function e(){this.on("mousedown.zoom",o).on("mousewheel.zoom",u).on("mousemove.zoom",a).on("DOMMouseScroll.zoom",u).on("dblclick.zoom",f).on("touchstart.zoom",l).on("touchmove.zoom",c).on("touchend.zoom",l)}function t(e){return[(e[0]-h[0])/d,(e[1]-h[1])/d]}function n(e){return[e[0]*d+h[0],e[1]*d+h[1]]}function r(e){d=Math.max(m[0],Math.min(m[1],e))}function i(e,t){t=n(t),h[0]+=e[0]-t[0],h[1]+=e[1]-t[1]}function s(e){b&&b.domain(y.range().map(function(e){return(e-h[0])/d}).map(y.invert)),E&&E.domain(w.range().map(function(e){return(e-h[1])/d}).map(w.invert)),d3.event.preventDefault(),e({type:"zoom",scale:d,translate:h})}function o(){function e(){f=1,i(d3.mouse(o),c),s(u)}function n(){f&&M(),l.on("mousemove.zoom",null).on("mouseup.zoom",null),f&&d3.event.target===a&&l.on("click.zoom",r,!0)}function r(){M(),l.on("click.zoom",null)}var o=this,u=g.of(o,arguments),a=d3.event.target,f=0,l=d3.select(window).on("mousemove.zoom",e).on("mouseup.zoom",n),c=t(d3.mouse(o));window.focus(),M()}function u(){p||(p=t(d3.mouse(this))),r(Math.pow(2,Un()*.002)*d),i(d3.mouse(this),p),s(g.of(this,arguments))}function a(){p=null}function f(){var e=d3.mouse(this),n=t(e);r(d3.event.shiftKey?d/2:d*2),i(e,n),s(g.of(this,arguments))}function l(){var e=d3.touches(this),n=Date.now();v=d,p={},e.forEach(function(e){p[e.identifier]=t(e)}),M();if(e.length===1){if(n-S<500){var o=e[0],u=t(e[0]);r(d*2),i(o,u),s(g.of(this,arguments))}S=n}}function c(){var e=d3.touches(this),t=e[0],n=p[t.identifier];if(o=e[1]){var o,u=p[o.identifier];t=[(t[0]+o[0])/2,(t[1]+o[1])/2],n=[(n[0]+u[0])/2,(n[1]+u[1])/2],r(d3.event.scale*v)}i(t,n),S=null,s(g.of(this,arguments))}var h=[0,0],p,d=1,v,m=lo,g=D(e,"zoom"),y,b,w,E,S;return e.translate=function(t){return arguments.length?(h=t.map(Number),e):h},e.scale=function(t){return arguments.length?(d=+t,e):d},e.scaleExtent=function(t){return arguments.length?(m=t==null?lo:t.map(Number),e):m},e.x=function(t){return arguments.length?(b=t,y=t.copy(),e):b},e.y=function(t){return arguments.length?(E=t,w=t.copy(),e):E},d3.rebind(e,g,"on")};var fo,lo=[0,Infinity];d3.layout={},d3.layout.bundle=function(){return function(e){var t=[],n=-1,r=e.length;while(++n<r)t.push(zn(e[n]));return t}},d3.layout.chord=function(){function e(){var e={},n=[],c=d3.range(o),h=[],p,d,v,m,g;r=[],i=[],p=0,m=-1;while(++m<o){d=0,g=-1;while(++g<o)d+=s[m][g];n.push(d),h.push(d3.range(o)),p+=d}a&&c.sort(function(e,t){return a(n[e],n[t])}),f&&h.forEach(function(e,t){e.sort(function(e,n){return f(s[t][e],s[t][n])})}),p=(2*Math.PI-u*o)/p,d=0,m=-1;while(++m<o){v=d,g=-1;while(++g<o){var y=c[m],b=h[y][g],w=s[y][b],E=d,S=d+=w*p;e[y+"-"+b]={index:y,subindex:b,startAngle:E,endAngle:S,value:w}}i[y]={index:y,startAngle:v,endAngle:d,value:(d-v)/p},d+=u}m=-1;while(++m<o){g=m-1;while(++g<o){var x=e[m+"-"+g],T=e[g+"-"+m];(x.value||T.value)&&r.push(x.value<T.value?{source:T,target:x}:{source:x,target:T})}}l&&t()}function t(){r.sort(function(e,t){return l((e.source.value+e.target.value)/2,(t.source.value+t.target.value)/2)})}var n={},r,i,s,o,u=0,a,f,l;return n.matrix=function(e){return arguments.length?(o=(s=e)&&s.length,r=i=null,n):s},n.padding=function(e){return arguments.length?(u=e,r=i=null,n):u},n.sortGroups=function(e){return arguments.length?(a=e,r=i=null,n):a},n.sortSubgroups=function(e){return arguments.length?(f=e,r=null,n):f},n.sortChords=function(e){return arguments.length?(l=e,r&&t(),n):l},n.chords=function(){return r||e(),r},n.groups=function(){return i||e(),i},n},d3.layout.force=function(){function e(e){return function(t,n,r,i,s){if(t.point!==e){var o=t.cx-e.x,u=t.cy-e.y,a=1/Math.sqrt(o*o+u*u);if((i-n)*a<d){var f=t.charge*a*a;return e.px-=o*f,e.py-=u*f,!0}if(t.point&&isFinite(a)){var f=t.pointCharge*a*a;e.px-=o*f,e.py-=u*f}}return!t.charge}}function t(e){e.px=d3.event.x,e.py=d3.event.y,n.resume()}var n={},r=d3.dispatch("start","tick","end"),s=[1,1],o,a,f=.9,l=Gn,c=Yn,h=-30,p=.1,d=.8,v,m=[],g=[],y,b,w;return n.tick=function(){if((a*=.99)<.005)return r.end({type:"end",alpha:a=0}),!0;var t=m.length,n=g.length,i,o,u,l,c,d,v,E,S;for(o=0;o<n;++o){u=g[o],l=u.source,c=u.target,E=c.x-l.x,S=c.y-l.y;if(d=E*E+S*S)d=a*b[o]*((d=Math.sqrt(d))-y[o])/d,E*=d,S*=d,c.x-=E*(v=l.weight/(c.weight+l.weight)),c.y-=S*v,l.x+=E*(v=1-v),l.y+=S*v}if(v=a*p){E=s[0]/2,S=s[1]/2,o=-1;if(v)while(++o<t)u=m[o],u.x+=(E-u.x)*v,u.y+=(S-u.y)*v}if(h){Qn(i=d3.geom.quadtree(m),a,w),o=-1;while(++o<t)(u=m[o]).fixed||i.visit(e(u))}o=-1;while(++o<t)u=m[o],u.fixed?(u.x=u.px,u.y=u.py):(u.x-=(u.px-(u.px=u.x))*f,u.y-=(u.py-(u.py=u.y))*f);r.tick({type:"tick",alpha:a})},n.nodes=function(e){return arguments.length?(m=e,n):m},n.links=function(e){return arguments.length?(g=e,n):g},n.size=function(e){return arguments.length?(s=e,n):s},n.linkDistance=function(e){return arguments.length?(l=u(e),n):l},n.distance=n.linkDistance,n.linkStrength=function(e){return arguments.length?(c=u(e),n):c},n.friction=function(e){return arguments.length?(f=e,n):f},n.charge=function(e){return arguments.length?(h=typeof e=="function"?e:+e,n):h},n.gravity=function(e){return arguments.length?(p=e,n):p},n.theta=function(e){return arguments.length?(d=e,n):d},n.alpha=function(e){return arguments.length?(a?e>0?a=e:a=0:e>0&&(r.start({type:"start",alpha:a=e}),d3.timer(n.tick)),n):a},n.start=function(){function e(e,n){var i=t(r),s=-1,o=i.length,u;while(++s<o)if(!isNaN(u=i[s][e]))return u;return Math.random()*n}function t(){if(!p){p=[];for(i=0;i<o;++i)p[i]=[];for(i=0;i<u;++i){var e=g[i];p[e.source.index].push(e.target),p[e.target.index].push(e.source)}}return p[r]}var r,i,o=m.length,u=g.length,a=s[0],f=s[1],p,d;for(r=0;r<o;++r)(d=m[r]).index=r,d.weight=0;y=[],b=[];for(r=0;r<u;++r)d=g[r],typeof d.source=="number"&&(d.source=m[d.source]),typeof d.target=="number"&&(d.target=m[d.target]),y[r]=l.call(this,d,r),b[r]=c.call(this,d,r),++d.source.weight,++d.target.weight;for(r=0;r<o;++r)d=m[r],isNaN(d.x)&&(d.x=e("x",a)),isNaN(d.y)&&(d.y=e("y",f)),isNaN(d.px)&&(d.px=d.x),isNaN(d.py)&&(d.py=d.y);w=[];if(typeof h=="function")for(r=0;r<o;++r)w[r]=+h.call(this,m[r],r);else for(r=0;r<o;++r)w[r]=h;return n.resume()},n.resume=function(){return n.alpha(.1)},n.stop=function(){return n.alpha(0)},n.drag=function(){o||(o=d3.behavior.drag().origin(i).on("dragstart",Vn).on("drag",t).on("dragend",$n)),this.on("mouseover.force",Jn).on("mouseout.force",Kn).call(o)},d3.rebind(n,r,"on")},d3.layout.partition=function(){function e(t,n,r,i){var s=t.children;t.x=n,t.y=t.depth*i,t.dx=r,t.dy=i;if(s&&(u=s.length)){var o=-1,u,a,f;r=t.value?r/t.value:0;while(++o<u)e(a=s[o],n,f=a.value*r,i),n+=f}}function t(e){var n=e.children,r=0;if(n&&(s=n.length)){var i=-1,s;while(++i<s)r=Math.max(r,t(n[i]))}return 1+r}function n(n,s){var o=r.call(this,n,s);return e(o[0],0,i[0],i[1]/t(o[0])),o}var r=d3.layout.hierarchy(),i=[1,1];return n.size=function(e){return arguments.length?(i=e,n):i},lr(n,r)},d3.layout.pie=function(){function e(s,o){var u=s.map(function(n,r){return+t.call(e,n,r)}),a=+(typeof r=="function"?r.apply(this,arguments):r),f=((typeof i=="function"?i.apply(this,arguments):i)-r)/d3.sum(u),l=d3.range(s.length);n!=null&&l.sort(n===co?function(e,t){return u[t]-u[e]}:function(e,t){return n(s[e],s[t])});var c=[];return l.forEach(function(e){var t;c[e]={data:s[e],value:t=u[e],startAngle:a,endAngle:a+=t*f}}),c}var t=Number,n=co,r=0,i=2*Math.PI;return e.value=function(n){return arguments.length?(t=n,e):t},e.sort=function(t){return arguments.length?(n=t,e):n},e.startAngle=function(t){return arguments.length?(r=t,e):r},e.endAngle=function(t){return arguments.length?(i=t,e):i},e};var co={};d3.layout.stack=function(){function e(i,a){var f=i.map(function(n,r){return t.call(e,n,r)}),l=f.map(function(t,n){return t.map(function(t,n){return[o.call(e,t,n),u.call(e,t,n)]})}),c=n.call(e,l,a);f=d3.permute(f,c),l=d3.permute(l,c);var h=r.call(e,l,a),p=f.length,d=f[0].length,v,m,g;for(m=0;m<d;++m){s.call(e,f[0][m],g=h[m],l[0][m][1]);for(v=1;v<p;++v)s.call(e,f[v][m],g+=l[v-1][m][1],l[v][m][1])}return i}var t=i,n=nr,r=rr,s=tr,o=Zn,u=er;return e.values=function(n){return arguments.length?(t=n,e):t},e.order=function(t){return arguments.length?(n=typeof t=="function"?t:ho.get(t)||nr,e):n},e.offset=function(t){return arguments.length?(r=typeof t=="function"?t:po.get(t)||rr,e):r},e.x=function(t){return arguments.length?(o=t,e):o},e.y=function(t){return arguments.length?(u=t,e):u},e.out=function(t){return arguments.length?(s=t,e):s},e};var ho=d3.map({"inside-out":function(e){var t=e.length,n,r,i=e.map(ir),s=e.map(sr),o=d3.range(t).sort(function(e,t){return i[e]-i[t]}),u=0,a=0,f=[],l=[];for(n=0;n<t;++n)r=o[n],u<a?(u+=s[r],f.push(r)):(a+=s[r],l.push(r));return l.reverse().concat(f)},reverse:function(e){return d3.range(e.length).reverse()},"default":nr}),po=d3.map({silhouette:function(e){var t=e.length,n=e[0].length,r=[],i=0,s,o,u,a=[];for(o=0;o<n;++o){for(s=0,u=0;s<t;s++)u+=e[s][o][1];u>i&&(i=u),r.push(u)}for(o=0;o<n;++o)a[o]=(i-r[o])/2;return a},wiggle:function(e){var t=e.length,n=e[0],r=n.length,i=0,s,o,u,a,f,l,c,h,p,d=[];d[0]=h=p=0;for(o=1;o<r;++o){for(s=0,a=0;s<t;++s)a+=e[s][o][1];for(s=0,f=0,c=n[o][0]-n[o-1][0];s<t;++s){for(u=0,l=(e[s][o][1]-e[s][o-1][1])/(2*c);u<s;++u)l+=(e[u][o][1]-e[u][o-1][1])/c;f+=l*e[s][o][1]}d[o]=h-=a?f/a*c:0,h<p&&(p=h)}for(o=0;o<r;++o)d[o]-=p;return d},expand:function(e){var t=e.length,n=e[0].length,r=1/t,i,s,o,u=[];for(s=0;s<n;++s){for(i=0,o=0;i<t;i++)o+=e[i][s][1];if(o)for(i=0;i<t;i++)e[i][s][1]/=o;else for(i=0;i<t;i++)e[i][s][1]=r}for(s=0;s<n;++s)u[s]=0;return u},zero:rr});d3.layout.histogram=function(){function e(e,s){var o=[],u=e.map(n,this),a=r.call(this,u,s),f=i.call(this,a,u,s),l,s=-1,c=u.length,h=f.length-1,p=t?1:1/c,d;while(++s<h)l=o[s]=[],l.dx=f[s+1]-(l.x=f[s]),l.y=0;if(h>0){s=-1;while(++s<c)d=u[s],d>=a[0]&&d<=a[1]&&(l=o[d3.bisect(f,d,1,h)-1],l.y+=p,l.push(e[s]))}return o}var t=!0,n=Number,r=fr,i=ur;return e.value=function(t){return arguments.length?(n=t,e):n},e.range=function(t){return arguments.length?(r=u(t),e):r},e.bins=function(t){return arguments.length?(i=typeof t=="number"?function(e){return ar(e,t)}:u(t),e):i},e.frequency=function(n){return arguments.length?(t=!!n,e):t},e},d3.layout.hierarchy=function(){function e(t,o,u){var a=i.call(n,t,o),f=vo?t:{data:t};f.depth=o,u.push(f);if(a&&(c=a.length)){var l=-1,c,h=f.children=[],p=0,d=o+1,v;while(++l<c)v=e(a[l],d,u),v.parent=f,h.push(v),p+=v.value;r&&h.sort(r),s&&(f.value=p)}else s&&(f.value=+s.call(n,t,o)||0);return f}function t(e,r){var i=e.children,o=0;if(i&&(a=i.length)){var u=-1,a,f=r+1;while(++u<a)o+=t(i[u],f)}else s&&(o=+s.call(n,vo?e:e.data,r)||0);return s&&(e.value=o),o}function n(t){var n=[];return e(t,0,n),n}var r=pr,i=cr,s=hr;return n.sort=function(e){return arguments.length?(r=e,n):r},n.children=function(e){return arguments.length?(i=e,n):i},n.value=function(e){return arguments.length?(s=e,n):s},n.revalue=function(e){return t(e,0),e},n};var vo=!1;d3.layout.pack=function(){function e(e,i){var s=t.call(this,e,i),o=s[0];o.x=0,o.y=0,Hr(o,function(e){e.r=Math.sqrt(e.value)}),Hr(o,br);var u=r[0],a=r[1],f=Math.max(2*o.r/u,2*o.r/a);if(n>0){var l=n*f/2;Hr(o,function(e){e.r+=l}),Hr(o,br),Hr(o,function(e){e.r-=l}),f=Math.max(2*o.r/u,2*o.r/a)}return Sr(o,u/2,a/2,1/f),s}var t=d3.layout.hierarchy().sort(vr),n=0,r=[1,1];return e.size=function(t){return arguments.length?(r=t,e):r},e.padding=function(t){return arguments.length?(n=+t,e):n},lr(e,t)},d3.layout.cluster=function(){function e(e,i){var s=t.call(this,e,i),o=s[0],u,a=0,f,l;Hr(o,function(e){var t=e.children;t&&t.length?(e.x=Nr(t),e.y=Tr(t)):(e.x=u?a+=n(e,u):0,e.y=0,u=e)});var c=Cr(o),h=kr(o),p=c.x-n(c,h)/2,d=h.x+n(h,c)/2;return Hr(o,function(e){e.x=(e.x-p)/(d-p)*r[0],e.y=(1-(o.y?e.y/o.y:1))*r[1]}),s}var t=d3.layout.hierarchy().sort(null).value(null),n=Lr,r=[1,1];return e.separation=function(t){return arguments.length?(n=t,e):n},e.size=function(t){return arguments.length?(r=t,e):r},lr(e,t)},d3.layout.tree=function(){function e(e,i){function s(e,t){var r=e.children,i=e._tree;if(r&&(o=r.length)){var o,a=r[0],f,l=a,c,h=-1;while(++h<o)c=r[h],s(c,f),l=u(c,f,l),f=c;Br(e);var p=.5*(a._tree.prelim+c._tree.prelim);t?(i.prelim=t._tree.prelim+n(e,t),i.mod=i.prelim-p):i.prelim=p}else t&&(i.prelim=t._tree.prelim+n(e,t))}function o(e,t){e.x=e._tree.prelim+t;var n=e.children;if(n&&(i=n.length)){var r=-1,i;t+=e._tree.mod;while(++r<i)o(n[r],t)}}function u(e,t,r){if(t){var i=e,s=e,o=t,u=e.parent.children[0],a=i._tree.mod,f=s._tree.mod,l=o._tree.mod,c=u._tree.mod,h;while(o=Or(o),i=Ar(i),o&&i)u=Ar(u),s=Or(s),s._tree.ancestor=e,h=o._tree.prelim+l-i._tree.prelim-a+n(o,i),h>0&&(jr(Fr(o,e,r),e,h),a+=h,f+=h),l+=o._tree.mod,a+=i._tree.mod,c+=u._tree.mod,f+=s._tree.mod;o&&!Or(s)&&(s._tree.thread=o,s._tree.mod+=l-f),i&&!Ar(u)&&(u._tree.thread=i,u._tree.mod+=a-c,r=e)}return r}var a=t.call(this,e,i),f=a[0];Hr(f,function(e,t){e._tree={ancestor:e,prelim:0,mod:0,change:0,shift:0,number:t?t._tree.number+1:0}}),s(f),o(f,-f._tree.prelim);var l=Mr(f,Dr),c=Mr(f,_r),h=Mr(f,Pr),p=l.x-n(l,c)/2,d=c.x+n(c,l)/2,v=h.depth||1;return Hr(f,function(e){e.x=(e.x-p)/(d-p)*r[0],e.y=e.depth/v*r[1],delete e._tree}),a}var t=d3.layout.hierarchy().sort(null).value(null),n=Lr,r=[1,1];return e.separation=function(t){return arguments.length?(n=t,e):n},e.size=function(t){return arguments.length?(r=t,e):r},lr(e,t)},d3.layout.treemap=function(){function e(e,t){var n=-1,r=e.length,i,s;while(++n<r)s=(i=e[n]).value*(t<0?0:t),i.area=isNaN(s)||s<=0?0:s}function t(n){var s=n.children;if(s&&s.length){var o=l(n),u=[],a=s.slice(),f,c=Infinity,h,p=Math.min(o.dx,o.dy),d;e(a,o.dx*o.dy/n.value),u.area=0;while((d=a.length)>0)u.push(f=a[d-1]),u.area+=f.area,(h=r(u,p))<=c?(a.pop(),c=h):(u.area-=u.pop().area,i(u,p,o,!1),p=Math.min(o.dx,o.dy),u.length=u.area=0,c=Infinity);u.length&&(i(u,p,o,!0),u.length=u.area=0),s.forEach(t)}}function n(t){var r=t.children;if(r&&r.length){var s=l(t),o=r.slice(),u,a=[];e(o,s.dx*s.dy/t.value),a.area=0;while(u=o.pop())a.push(u),a.area+=u.area,u.z!=null&&(i(a,u.z?s.dx:s.dy,s,!o.length),a.length=a.area=0);r.forEach(n)}}function r(e,t){var n=e.area,r,i=0,s=Infinity,o=-1,u=e.length;while(++o<u){if(!(r=e[o].area))continue;r<s&&(s=r),r>i&&(i=r)}return n*=n,t*=t,n?Math.max(t*i*p/n,n/(t*s*p)):Infinity}function i(e,t,n,r){var i=-1,s=e.length,o=n.x,a=n.y,f=t?u(e.area/t):0,l;if(t==n.dx){if(r||f>n.dy)f=n.dy;while(++i<s)l=e[i],l.x=o,l.y=a,l.dy=f,o+=l.dx=Math.min(n.x+n.dx-o,f?u(l.area/f):0);l.z=!0,l.dx+=n.x+n.dx-o,n.y+=f,n.dy-=f}else{if(r||f>n.dx)f=n.dx;while(++i<s)l=e[i],l.x=o,l.y=a,l.dx=f,a+=l.dy=Math.min(n.y+n.dy-a,f?u(l.area/f):0);l.z=!1,l.dy+=n.y+n.dy-a,n.x+=f,n.dx-=f}}function s(r){var i=h||o(r),s=i[0];return s.x=0,s.y=0,s.dx=a[0],s.dy=a[1],h&&o.revalue(s),e([s],s.dx*s.dy/s.value),(h?n:t)(s),c&&(h=i),i}var o=d3.layout.hierarchy(),u=Math.round,a=[1,1],f=null,l=Ir,c=!1,h,p=.5*(1+Math.sqrt(5));return s.size=function(e){return arguments.length?(a=e,s):a},s.padding=function(e){function t(t){var n=e.call(s,t,t.depth);return n==null?Ir(t):qr(t,typeof n=="number"?[n,n,n,n]:n)}function n(t){return qr(t,e)}if(!arguments.length)return f;var r;return l=(f=e)==null?Ir:(r=typeof e)==="function"?t:r==="number"?(e=[e,e,e,e],n):n,s},s.round=function(e){return arguments.length?(u=e?Math.round:Number,s):u!=Number},s.sticky=function(e){return arguments.length?(c=e,h=null,s):c},s.ratio=function(e){return arguments.length?(p=e,s):p},lr(s,o)},d3.csv=Rr(",","text/csv"),d3.tsv=Rr("	","text/tab-separated-values"),d3.geo={};var mo=Math.PI/180;d3.geo.azimuthal=function(){function e(e){var n=e[0]*mo-s,o=e[1]*mo,f=Math.cos(n),l=Math.sin(n),c=Math.cos(o),h=Math.sin(o),p=t!=="orthographic"?a*h+u*c*f:null,d,v=t==="stereographic"?1/(1+p):t==="gnomonic"?1/p:t==="equidistant"?(d=Math.acos(p),d?d/Math.sin(d):0):t==="equalarea"?Math.sqrt(2/(1+p)):1,m=v*c*l,g=v*(a*c*f-u*h);return[r*m+i[0],r*g+i[1]]}var t="orthographic",n,r=200,i=[480,250],s,o,u,a;return e.invert=function(e){var n=(e[0]-i[0])/r,o=(e[1]-i[1])/r,f=Math.sqrt(n*n+o*o),l=t==="stereographic"?2*Math.atan(f):t==="gnomonic"?Math.atan(f):t==="equidistant"?f:t==="equalarea"?2*Math.asin(.5*f):Math.asin(f),c=Math.sin(l),h=Math.cos(l);return[(s+Math.atan2(n*c,f*u*h+o*a*c))/mo,Math.asin(h*a-(f?o*c*u/f:0))/mo]},e.mode=function(n){return arguments.length?(t=n+"",e):t},e.origin=function(t){return arguments.length?(n=t,s=n[0]*mo,o=n[1]*mo,u=Math.cos(o),a=Math.sin(o),e):n},e.scale=function(t){return arguments.length?(r=+t,e):r},e.translate=function(t){return arguments.length?(i=[+t[0],+t[1]],e):i},e.origin([0,0])},d3.geo.albers=function(){function e(e){var t=u*(mo*e[0]-o),n=Math.sqrt(a-2*u*Math.sin(mo*e[1]))/u;return[i*n*Math.sin(t)+s[0],i*(n*Math.cos(t)-f)+s[1]]}function t(){var t=mo*r[0],i=mo*r[1],s=mo*n[1],l=Math.sin(t),c=Math.cos(t);return o=mo*n[0],u=.5*(l+Math.sin(i)),a=c*c+2*u*l,f=Math.sqrt(a-2*u*Math.sin(s))/u,e}var n=[-98,38],r=[29.5,45.5],i=1e3,s=[480,250],o,u,a,f;return e.invert=function(e){var t=(e[0]-s[0])/i,n=(e[1]-s[1])/i,r=f+n,l=Math.atan2(t,r),c=Math.sqrt(t*t+r*r);return[(o+l/u)/mo,Math.asin((a-c*c*u*u)/(2*u))/mo]},e.origin=function(e){return arguments.length?(n=[+e[0],+e[1]],t()):n},e.parallels=function(e){return arguments.length?(r=[+e[0],+e[1]],t()):r},e.scale=function(t){return arguments.length?(i=+t,e):i},e.translate=function(t){return arguments.length?(s=[+t[0],+t[1]],e):s},t()},d3.geo.albersUsa=function(){function e(e){var s=e[0],o=e[1];return(o>50?n:s<-140?r:o<21?i:t)(e)}var t=d3.geo.albers(),n=d3.geo.albers().origin([-160,60]).parallels([55,65]),r=d3.geo.albers().origin([-160,20]).parallels([8,18]),i=d3.geo.albers().origin([-60,10]).parallels([8,18]);return e.scale=function(s){return arguments.length?(t.scale(s),n.scale(s*.6),r.scale(s),i.scale(s*1.5),e.translate(t.translate())):t.scale()},e.translate=function(s){if(!arguments.length)return t.translate();var o=t.scale()/1e3,u=s[0],a=s[1];return t.translate(s),n.translate([u-400*o,a+170*o]),r.translate([u-190*o,a+200*o]),i.translate([u+580*o,a+430*o]),e},e.scale(t.scale())},d3.geo.bonne=function(){function e(e){var u=e[0]*mo-r,a=e[1]*mo-i;if(s){var f=o+s-a,l=u*Math.cos(a)/f;u=f*Math.sin(l),a=f*Math.cos(l)-o}else u*=Math.cos(a),a*=-1;return[t*u+n[0],t*a+n[1]]}var t=200,n=[480,250],r,i,s,o;return e.invert=function(e){var i=(e[0]-n[0])/t,u=(e[1]-n[1])/t;if(s){var a=o+u,f=Math.sqrt(i*i+a*a);u=o+s-f,i=r+f*Math.atan2(i,a)/Math.cos(u)}else u*=-1,i/=Math.cos(u);return[i/mo,u/mo]},e.parallel=function(t){return arguments.length?(o=1/Math.tan(s=t*mo),e):s/mo},e.origin=function(t){return arguments.length?(r=t[0]*mo,i=t[1]*mo,e):[r/mo,i/mo]},e.scale=function(n){return arguments.length?(t=+n,e):t},e.translate=function(t){return arguments.length?(n=[+t[0],+t[1]],e):n},e.origin([0,0]).parallel(45)},d3.geo.equirectangular=function(){function e(e){var r=e[0]/360,i=-e[1]/360;return[t*r+n[0],t*i+n[1]]}var t=500,n=[480,250];return e.invert=function(e){var r=(e[0]-n[0])/t,i=(e[1]-n[1])/t;return[360*r,-360*i]},e.scale=function(n){return arguments.length?(t=+n,e):t},e.translate=function(t){return arguments.length?(n=[+t[0],+t[1]],e):n},e},d3.geo.mercator=function(){function e(e){var r=e[0]/360,i=-(Math.log(Math.tan(Math.PI/4+e[1]*mo/2))/mo)/360;return[t*r+n[0],t*Math.max(-0.5,Math.min(.5,i))+n[1]]}var t=500,n=[480,250];return e.invert=function(e){var r=(e[0]-n[0])/t,i=(e[1]-n[1])/t;return[360*r,2*Math.atan(Math.exp(-360*i*mo))/mo-90]},e.scale=function(n){return arguments.length?(t=+n,e):t},e.translate=function(t){return arguments.length?(n=[+t[0],+t[1]],e):n},e},d3.geo.path=function(){function e(e,t){typeof s=="function"&&(o=zr(s.apply(this,arguments))),f(e);var n=a.length?a.join(""):null;return a=[],n}function t(e){return u(e).join(",")}function n(e){var t=i(e[0]),n=0,r=e.length;while(++n<r)t-=i(e[n]);return t}function r(e){var t=d3.geom.polygon(e[0].map(u)),n=t.area(),r=t.centroid(n<0?(n*=-1,1):-1),i=r[0],s=r[1],o=n,a=0,f=e.length;while(++a<f)t=d3.geom.polygon(e[a].map(u)),n=t.area(),r=t.centroid(n<0?(n*=-1,1):-1),i-=r[0],s-=r[1],o-=n;return[i,s,6*o]}function i(e){return Math.abs(d3.geom.polygon(e.map(u)).area())}var s=4.5,o=zr(s),u=d3.geo.albersUsa(),a=[],f=Ur({FeatureCollection:function(e){var t=e.features,n=-1,r=t.length;while(++n<r)a.push(f(t[n].geometry))},Feature:function(e){f(e.geometry)},Point:function(e){a.push("M",t(e.coordinates),o)},MultiPoint:function(e){var n=e.coordinates,r=-1,i=n.length;while(++r<i)a.push("M",t(n[r]),o)},LineString:function(e){var n=e.coordinates,r=-1,i=n.length;a.push("M");while(++r<i)a.push(t(n[r]),"L");a.pop()},MultiLineString:function(e){var n=e.coordinates,r=-1,i=n.length,s,o,u;while(++r<i){s=n[r],o=-1,u=s.length,a.push("M");while(++o<u)a.push(t(s[o]),"L");a.pop()}},Polygon:function(e){var n=e.coordinates,r=-1,i=n.length,s,o,u;while(++r<i){s=n[r],o=-1;if((u=s.length-1)>0){a.push("M");while(++o<u)a.push(t(s[o]),"L");a[a.length-1]="Z"}}},MultiPolygon:function(e){var n=e.coordinates,r=-1,i=n.length,s,o,u,f,l,c;while(++r<i){s=n[r],o=-1,u=s.length;while(++o<u){f=s[o],l=-1;if((c=f.length-1)>0){a.push("M");while(++l<c)a.push(t(f[l]),"L");a[a.length-1]="Z"}}}},GeometryCollection:function(e){var t=e.geometries,n=-1,r=t.length;while(++n<r)a.push(f(t[n]))}}),l=e.area=Ur({FeatureCollection:function(e){var t=0,n=e.features,r=-1,i=n.length;while(++r<i)t+=l(n[r]);return t},Feature:function(e){return l(e.geometry)},Polygon:function(e){return n(e.coordinates)},MultiPolygon:function(e){var t=0,r=e.coordinates,i=-1,s=r.length;while(++i<s)t+=n(r[i]);return t},GeometryCollection:function(e){var t=0,n=e.geometries,r=-1,i=n.length;while(++r<i)t+=l(n[r]);return t}},0),c=e.centroid=Ur({Feature:function(e){return c(e.geometry)},Polygon:function(e){var t=r(e.coordinates);return[t[0]/t[2],t[1]/t[2]]},MultiPolygon:function(e){var t=0,n=e.coordinates,i,s=0,o=0,u=0,a=-1,f=n.length;while(++a<f)i=r(n[a]),s+=i[0],o+=i[1],u+=i[2];return[s/u,o/u]}});return e.projection=function(t){return u=t,e},e.pointRadius=function(t){return typeof t=="function"?s=t:(s=+t,o=zr(s)),e},e},d3.geo.bounds=function(e){var t=Infinity,n=Infinity,r=-Infinity,i=-Infinity;return Wr(e,function(e,s){e<t&&(t=e),e>r&&(r=e),s<n&&(n=s),s>i&&(i=s)}),[[t,n],[r,i]]};var go={Feature:Xr,FeatureCollection:Vr,GeometryCollection:$r,LineString:Jr,MultiLineString:Kr,MultiPoint:Jr,MultiPolygon:Qr,Point:Gr,Polygon:Yr};d3.geo.circle=function(){function e(){}function t(e){return a.distance(e)<u}function n(e){var t=-1,n=e.length,i=[],s,o,f,l,c;while(++t<n)c=a.distance(f=e[t]),c<u?(o&&i.push(ni(o,f)((l-u)/(l-c))),i.push(f),s=o=null):(o=f,!s&&i.length&&(i.push(ni(i[i.length-1],o)((u-l)/(c-l))),s=o)),l=c;return s=e[0],o=i[0],o&&f[0]===s[0]&&f[1]===s[1]&&(f[0]!==o[0]||f[1]!==o[1])&&i.push(o),r(i)}function r(e){var t=0,n=e.length,r,i,s=n?[e[0]]:e,o,u=a.source();while(++t<n){o=a.source(e[t-1])(e[t]).coordinates;for(r=0,i=o.length;++r<i;)s.push(o[r])}return a.source(u),s}var s=[0,0],o=89.99,u=o*mo,a=d3.geo.greatArc().source(s).target(i);e.clip=function(e){return typeof s=="function"&&a.source(s.apply(this,arguments)),f(e)||null};var f=Ur({FeatureCollection:function(e){var t=e.features.map(f).filter(i);return t&&(e=Object.create(e),e.features=t,e)},Feature:function(e){var t=f(e.geometry);return t&&(e=Object.create(e),e.geometry=t,e)},Point:function(e){return t(e.coordinates)&&e},MultiPoint:function(e){var n=e.coordinates.filter(t);return n.length&&{type:e.type,coordinates:n}},LineString:function(e){var t=n(e.coordinates);return t.length&&(e=Object.create(e),e.coordinates=t,e)},MultiLineString:function(e){var t=e.coordinates.map(n).filter(function(e){return e.length});return t.length&&(e=Object.create(e),e.coordinates=t,e)},Polygon:function(e){var t=e.coordinates.map(n);return t[0].length&&(e=Object.create(e),e.coordinates=t,e)},MultiPolygon:function(e){var t=e.coordinates.map(function(e){return e.map(n)}).filter(function(e){return e[0].length});return t.length&&(e=Object.create(e),e.coordinates=t,e)},GeometryCollection:function(e){var t=e.geometries.map(f).filter(i);return t.length&&(e=Object.create(e),e.geometries=t,e)}});return e.origin=function(t){return arguments.length?(s=t,typeof s!="function"&&a.source(s),e):s},e.angle=function(t){return arguments.length?(u=(o=+t)*mo,e):o},d3.rebind(e,a,"precision")},d3.geo.greatArc=function(){function e(){var t=e.distance.apply(this,arguments),r=0,u=s/t,a=[n];while((r+=u)<1)a.push(o(r));return a.push(i),{type:"LineString",coordinates:a}}var t=Zr,n,r=ei,i,s=6*mo,o=ti();return e.distance=function(){return typeof t=="function"&&o.source(n=t.apply(this,arguments)),typeof r=="function"&&o.target(i=r.apply(this,arguments)),o.distance()},e.source=function(r){return arguments.length?(t=r,typeof t!="function"&&o.source(n=t),e):t},e.target=function(t){return arguments.length?(r=t,typeof r!="function"&&o.target(i=r),e):r},e.precision=function(t){return arguments.length?(s=t*mo,e):s/mo},e},d3.geo.greatCircle=d3.geo.circle,d3.geom={},d3.geom.contour=function(e,t){var n=t||ri(e),r=[],i=n[0],s=n[1],o=0,u=0,a=NaN,f=NaN,l=0;do l=0,e(i-1,s-1)&&(l+=1),e(i,s-1)&&(l+=2),e(i-1,s)&&(l+=4),e(i,s)&&(l+=8),l===6?(o=f===-1?-1:1,u=0):l===9?(o=0,u=a===1?-1:1):(o=yo[l],u=bo[l]),o!=a&&u!=f&&(r.push([i,s]),a=o,f=u),i+=o,s+=u;while(n[0]!=i||n[1]!=s);return r};var yo=[1,0,1,1,-1,0,-1,1,0,0,0,0,-1,0,-1,NaN],bo=[0,-1,0,0,0,-1,0,0,1,-1,1,1,0,-1,0,NaN];d3.geom.hull=function(e){if(e.length<3)return[];var t=e.length,n=t-1,r=[],i=[],s,o,u=0,a,f,l,c,h,p,d,v;for(s=1;s<t;++s)e[s][1]<e[u][1]?u=s:e[s][1]==e[u][1]&&(u=e[s][0]<e[u][0]?s:u);for(s=0;s<t;++s){if(s===u)continue;f=e[s][1]-e[u][1],a=e[s][0]-e[u][0],r.push({angle:Math.atan2(f,a),index:s})}r.sort(function(e,t){return e.angle-t.angle}),d=r[0].angle,p=r[0].index,h=0;for(s=1;s<n;++s)o=r[s].index,d==r[s].angle?(a=e[p][0]-e[u][0],f=e[p][1]-e[u][1],l=e[o][0]-e[u][0],c=e[o][1]-e[u][1],a*a+f*f>=l*l+c*c?r[s].index=-1:(r[h].index=-1,d=r[s].angle,h=s,p=o)):(d=r[s].angle,h=s,p=o);i.push(u);for(s=0,o=0;s<2;++o)r[o].index!==-1&&(i.push(r[o].index),s++);v=i.length;for(;o<n;++o){if(r[o].index===-1)continue;while(!ii(i[v-2],i[v-1],r[o].index,e))--v;i[v++]=r[o].index}var m=[];for(s=0;s<v;++s)m.push(e[i[s]]);return m},d3.geom.polygon=function(e){return e.area=function(){var t=0,n=e.length,r=e[n-1][0]*e[0][1],i=e[n-1][1]*e[0][0];while(++t<n)r+=e[t-1][0]*e[t][1],i+=e[t-1][1]*e[t][0];return(i-r)*.5},e.centroid=function(t){var n=-1,r=e.length,i=0,s=0,o,u=e[r-1],a;arguments.length||(t=-1/(6*e.area()));while(++n<r)o=u,u=e[n],a=o[0]*u[1]-u[0]*o[1],i+=(o[0]+u[0])*a,s+=(o[1]+u[1])*a;return[i*t,s*t]},e.clip=function(t){var n,r=-1,i=e.length,s,o,u=e[i-1],a,f,l;while(++r<i){n=t.slice(),t.length=0,a=e[r],f=n[(o=n.length)-1],s=-1;while(++s<o)l=n[s],si(l,u,a)?(si(f,u,a)||t.push(oi(f,l,u,a)),t.push(l)):si(f,u,a)&&t.push(oi(f,l,u,a)),f=l;u=a}return t},e},d3.geom.voronoi=function(e){var t=e.map(function(){return[]});return ui(e,function(e){var n,r,i,s,o,u;e.a===1&&e.b>=0?(n=e.ep.r,r=e.ep.l):(n=e.ep.l,r=e.ep.r),e.a===1?(o=n?n.y:-1e6,i=e.c-e.b*o,u=r?r.y:1e6,s=e.c-e.b*u):(i=n?n.x:-1e6,o=e.c-e.a*i,s=r?r.x:1e6,u=e.c-e.a*s);var a=[i,o],f=[s,u];t[e.region.l.index].push(a,f),t[e.region.r.index].push(a,f)}),t.map(function(t,n){var r=e[n][0],i=e[n][1];return t.forEach(function(e){e.angle=Math.atan2(e[0]-r,e[1]-i)}),t.sort(function(e,t){return e.angle-t.angle}).filter(function(e,n){return!n||e.angle-t[n-1].angle>1e-10})})};var wo={l:"r",r:"l"};d3.geom.delaunay=function(e){var t=e.map(function(){return[]}),n=[];return ui(e,function(n){t[n.region.l.index].push(e[n.region.r.index])}),t.forEach(function(t,r){var i=e[r],s=i[0],o=i[1];t.forEach(function(e){e.angle=Math.atan2(e[0]-s,e[1]-o)}),t.sort(function(e,t){return e.angle-t.angle});for(var u=0,a=t.length-1;u<a;u++)n.push([i,t[u],t[u+1]])}),n},d3.geom.quadtree=function(e,t,n,r,i){function s(e,t,n,r,i,s){if(isNaN(t.x)||isNaN(t.y))return;if(e.leaf){var u=e.point;u?Math.abs(u.x-t.x)+Math.abs(u.y-t.y)<.01?o(e,t,n,r,i,s):(e.point=null,o(e,u,n,r,i,s),o(e,t,n,r,i,s)):e.point=t}else o(e,t,n,r,i,s)}function o(e,t,n,r,i,o){var u=(n+i)*.5,a=(r+o)*.5,f=t.x>=u,l=t.y>=a,c=(l<<1)+f;e.leaf=!1,e=e.nodes[c]||(e.nodes[c]=ai()),f?n=u:i=u,l?r=a:o=a,s(e,t,n,r,i,o)}var u,a=-1,f=e.length;f&&isNaN(e[0].x)&&(e=e.map(li));if(arguments.length<5)if(arguments.length===3)i=r=n,n=t;else{t=n=Infinity,r=i=-Infinity;while(++a<f)u=e[a],u.x<t&&(t=u.x),u.y<n&&(n=u.y),u.x>r&&(r=u.x),u.y>i&&(i=u.y);var l=r-t,c=i-n;l>c?i=n+l:r=t+c}var h=ai();return h.add=function(e){s(h,e,t,n,r,i)},h.visit=function(e){fi(e,h,t,n,r,i)},e.forEach(h.add),h},d3.time={};var Eo=Date,So=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];ci.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){xo.setUTCDate.apply(this._,arguments)},setDay:function(){xo.setUTCDay.apply(this._,arguments)},setFullYear:function(){xo.setUTCFullYear.apply(this._,arguments)},setHours:function(){xo.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){xo.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){xo.setUTCMinutes.apply(this._,arguments)},setMonth:function(){xo.setUTCMonth.apply(this._,arguments)},setSeconds:function(){xo.setUTCSeconds.apply(this._,arguments)},setTime:function(){xo.setTime.apply(this._,arguments)}};var xo=Date.prototype,To="%a %b %e %H:%M:%S %Y",No="%m/%d/%y",Co="%H:%M:%S",ko=So,Lo=ko.map(hi),Ao=["January","February","March","April","May","June","July","August","September","October","November","December"],Oo=Ao.map(hi);d3.time.format=function(e){function t(t){var r=[],i=-1,s=0,o,u;while(++i<n)e.charCodeAt(i)==37&&(r.push(e.substring(s,i),(u=Ro[o=e.charAt(++i)])?u(t):o),s=i+1);return r.push(e.substring(s,i)),r.join("")}var n=e.length;return t.parse=function(t){var n={y:1900,m:0,d:1,H:0,M:0,S:0,L:0},r=pi(n,e,t,0);if(r!=t.length)return null;"p"in n&&(n.H=n.H%12+n.p*12);var i=new Eo;return i.setFullYear(n.y,n.m,n.d),i.setHours(n.H,n.M,n.S,n.L),i},t.toString=function(){return e},t};var Mo=d3.format("02d"),_o=d3.format("03d"),Do=d3.format("04d"),Po=d3.format("2d"),Ho=di(ko),Bo=di(Lo),jo=di(Ao),Fo=vi(Ao),Io=di(Oo),qo=vi(Oo),Ro={a:function(e){return Lo[e.getDay()]},A:function(e){return ko[e.getDay()]},b:function(e){return Oo[e.getMonth()]},B:function(e){return Ao[e.getMonth()]},c:d3.time.format(To),d:function(e){return Mo(e.getDate())},e:function(e){return Po(e.getDate())},H:function(e){return Mo(e.getHours())},I:function(e){return Mo(e.getHours()%12||12)},j:function(e){return _o(1+d3.time.dayOfYear(e))},L:function(e){return _o(e.getMilliseconds())},m:function(e){return Mo(e.getMonth()+1)},M:function(e){return Mo(e.getMinutes())},p:function(e){return e.getHours()>=12?"PM":"AM"},S:function(e){return Mo(e.getSeconds())},U:function(e){return Mo(d3.time.sundayOfYear(e))},w:function(e){return e.getDay()},W:function(e){return Mo(d3.time.mondayOfYear(e))},x:d3.time.format(No),X:d3.time.format(Co),y:function(e){return Mo(e.getFullYear()%100)},Y:function(e){return Do(e.getFullYear()%1e4)},Z:Di,"%":function(e){return"%"}},Uo={a:mi,A:gi,b:yi,B:bi,c:wi,d:ki,e:ki,H:Li,I:Li,L:Mi,m:Ci,M:Ai,p:_i,S:Oi,x:Ei,X:Si,y:Ti,Y:xi},zo=/^\s*\d+/,Wo=d3.map({am:0,pm:1});d3.time.format.utc=function(e){function t(e){try{Eo=ci;var t=new Eo;return t._=e,n(t)}finally{Eo=Date}}var n=d3.time.format(e);return t.parse=function(e){try{Eo=ci;var t=n.parse(e);return t&&t._}finally{Eo=Date}},t.toString=n.toString,t};var Xo=d3.time.format.utc("%Y-%m-%dT%H:%M:%S.%LZ");d3.time.format.iso=Date.prototype.toISOString?Pi:Xo,Pi.parse=function(e){var t=new Date(e);return isNaN(t)?null:t},Pi.toString=Xo.toString,d3.time.second=Hi(function(e){return new Eo(Math.floor(e/1e3)*1e3)},function(e,t){e.setTime(e.getTime()+Math.floor(t)*1e3)},function(e){return e.getSeconds()}),d3.time.seconds=d3.time.second.range,d3.time.seconds.utc=d3.time.second.utc.range,d3.time.minute=Hi(function(e){return new Eo(Math.floor(e/6e4)*6e4)},function(e,t){e.setTime(e.getTime()+Math.floor(t)*6e4)},function(e){return e.getMinutes()}),d3.time.minutes=d3.time.minute.range,d3.time.minutes.utc=d3.time.minute.utc.range,d3.time.hour=Hi(function(e){var t=e.getTimezoneOffset()/60;return new Eo((Math.floor(e/36e5-t)+t)*36e5)},function(e,t){e.setTime(e.getTime()+Math.floor(t)*36e5)},function(e){return e.getHours()}),d3.time.hours=d3.time.hour.range,d3.time.hours.utc=d3.time.hour.utc.range,d3.time.day=Hi(function(e){var t=new Eo(1970,0);return t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),t},function(e,t){e.setDate(e.getDate()+t)},function(e){return e.getDate()-1}),d3.time.days=d3.time.day.range,d3.time.days.utc=d3.time.day.utc.range,d3.time.dayOfYear=function(e){var t=d3.time.year(e);return Math.floor((e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*6e4)/864e5)},So.forEach(function(e,t){e=e.toLowerCase(),t=7-t;var n=d3.time[e]=Hi(function(e){return(e=d3.time.day(e)).setDate(e.getDate()-(e.getDay()+t)%7),e},function(e,t){e.setDate(e.getDate()+Math.floor(t)*7)},function(e){var n=d3.time.year(e).getDay();return Math.floor((d3.time.dayOfYear(e)+(n+t)%7)/7)-(n!==t)});d3.time[e+"s"]=n.range,d3.time[e+"s"].utc=n.utc.range,d3.time[e+"OfYear"]=function(e){var n=d3.time.year(e).getDay();return Math.floor((d3.time.dayOfYear(e)+(n+t)%7)/7)}}),d3.time.week=d3.time.sunday,d3.time.weeks=d3.time.sunday.range,d3.time.weeks.utc=d3.time.sunday.utc.range,d3.time.weekOfYear=d3.time.sundayOfYear,d3.time.month=Hi(function(e){return e=d3.time.day(e),e.setDate(1),e},function(e,t){e.setMonth(e.getMonth()+t)},function(e){return e.getMonth()}),d3.time.months=d3.time.month.range,d3.time.months.utc=d3.time.month.utc.range,d3.time.year=Hi(function(e){return e=d3.time.day(e),e.setMonth(0,1),e},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e){return e.getFullYear()}),d3.time.years=d3.time.year.range,d3.time.years.utc=d3.time.year.utc.range;var Vo=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],$o=[[d3.time.second,1],[d3.time.second,5],[d3.time.second,15],[d3.time.second,30],[d3.time.minute,1],[d3.time.minute,5],[d3.time.minute,15],[d3.time.minute,30],[d3.time.hour,1],[d3.time.hour,3],[d3.time.hour,6],[d3.time.hour,12],[d3.time.day,1],[d3.time.day,2],[d3.time.week,1],[d3.time.month,1],[d3.time.month,3],[d3.time.year,1]],Jo=[[d3.time.format("%Y"),function(e){return!0}],[d3.time.format("%B"),function(e){return e.getMonth()}],[d3.time.format("%b %d"),function(e){return e.getDate()!=1}],[d3.time.format("%a %d"),function(e){return e.getDay()&&e.getDate()!=1}],[d3.time.format("%I %p"),function(e){return e.getHours()}],[d3.time.format("%I:%M"),function(e){return e.getMinutes()}],[d3.time.format(":%S"),function(e){return e.getSeconds()}],[d3.time.format(".%L"),function(e){return e.getMilliseconds()}]],Ko=d3.scale.linear(),Qo=qi(Jo);$o.year=function(e,t){return Ko.domain(e.map(Ui)).ticks(t).map(Ri)},d3.time.scale=function(){return ji(d3.scale.linear(),$o,Qo)};var Go=$o.map(function(e){return[e[0].utc,e[1]]}),Yo=[[d3.time.format.utc("%Y"),function(e){return!0}],[d3.time.format.utc("%B"),function(e){return e.getUTCMonth()}],[d3.time.format.utc("%b %d"),function(e){return e.getUTCDate()!=1}],[d3.time.format.utc("%a %d"),function(e){return e.getUTCDay()&&e.getUTCDate()!=1}],[d3.time.format.utc("%I %p"),function(e){return e.getUTCHours()}],[d3.time.format.utc("%I:%M"),function(e){return e.getUTCMinutes()}],[d3.time.format.utc(":%S"),function(e){return e.getUTCSeconds()}],[d3.time.format.utc(".%L"),function(e){return e.getUTCMilliseconds()}]],Zo=qi(Yo);Go.year=function(e,t){return Ko.domain(e.map(Wi)).ticks(t).map(zi)},d3.time.scale.utc=function(){return ji(d3.scale.linear(),Go,Zo)}})();!function(){var e={},t=null,n=!0,r=!1;if("undefined"!=typeof AudioContext)t=new AudioContext;else if("undefined"!=typeof webkitAudioContext)t=new webkitAudioContext;else if("undefined"!=typeof Audio){n=!1;try{new Audio}catch(i){r=!0}}else n=!1,r=!0;if(n){var s=void 0===t.createGain?t.createGainNode():t.createGain();s.gain.value=1,s.connect(t.destination)}var o=function(){this._volume=1,this._muted=!1,this.usingWebAudio=n,this._howls=[]};o.prototype={volume:function(e){var t=this;if(e=parseFloat(e),e>=0&&1>=e){t._volume=e,n&&(s.gain.value=e);for(var r in t._howls)if(t._howls.hasOwnProperty(r)&&t._howls[r]._webAudio===!1)for(var i=0;i<t._howls[r]._audioNode.length;i++)t._howls[r]._audioNode[i].volume=t._howls[r]._volume*t._volume;return t}return n?s.gain.value:t._volume},mute:function(){return this._setMuted(!0),this},unmute:function(){return this._setMuted(!1),this},_setMuted:function(e){var t=this;t._muted=e,n&&(s.gain.value=e?0:t._volume);for(var r in t._howls)if(t._howls.hasOwnProperty(r)&&t._howls[r]._webAudio===!1)for(var i=0;i<t._howls[r]._audioNode.length;i++)t._howls[r]._audioNode[i].muted=e}};var u=new o,a=null;if(!r){a=new Audio;var f={mp3:!!a.canPlayType("audio/mpeg;").replace(/^no$/,""),opus:!!a.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!a.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),m4a:!!(a.canPlayType("audio/x-m4a;")||a.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!a.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")}}var l=function(e){var t=this;t._autoplay=e.autoplay||!1,t._buffer=e.buffer||!1,t._duration=e.duration||0,t._format=e.format||null,t._loop=e.loop||!1,t._loaded=!1,t._sprite=e.sprite||{},t._src=e.src||"",t._pos3d=e.pos3d||[0,0,-0.5],t._volume=void 0!==e.volume?e.volume:1,t._urls=e.urls||[],t._rate=e.rate||1,t._onload=[e.onload||function(){}],t._onloaderror=[e.onloaderror||function(){}],t._onend=[e.onend||function(){}],t._onpause=[e.onpause||function(){}],t._onplay=[e.onplay||function(){}],t._onendTimer=[],t._webAudio=n&&!t._buffer,t._audioNode=[],t._webAudio&&t._setupAudioNode(),u._howls.push(t),t.load()};if(l.prototype={load:function(){var t=this,n=null;if(r)return t.on("loaderror"),void 0;for(var i=0;i<t._urls.length;i++){var s,o;if(t._format)s=t._format;else{if(o=t._urls[i].toLowerCase().split("?")[0],s=o.match(/.+\.([^?]+)(\?|$)/),s=s&&s.length>=2?s:o.match(/data\:audio\/([^?]+);/),!s)return t.on("loaderror"),void 0;s=s[1]}if(f[s]){n=t._urls[i];break}}if(!n)return t.on("loaderror"),void 0;if(t._src=n,t._webAudio)c(t,n);else{var a=new Audio;t._audioNode.push(a),a.src=n,a._pos=0,a.preload="auto",a.volume=u._muted?0:t._volume*u.volume(),e[n]=t;var l=function(){t._duration=a.duration,0===Object.getOwnPropertyNames(t._sprite).length&&(t._sprite={_default:[0,1e3*t._duration]}),t._loaded||(t._loaded=!0,t.on("load")),t._autoplay&&t.play(),a.removeEventListener("canplaythrough",l,!1)};a.addEventListener("canplaythrough",l,!1),a.load()}return t},urls:function(e){var t=this;return e?(t.stop(),t._urls="string"==typeof e?[e]:e,t._loaded=!1,t.load(),t):t._urls},play:function(e,n){var r=this;return"function"==typeof e&&(n=e),e&&"function"!=typeof e||(e="_default"),r._loaded?r._sprite[e]?(r._inactiveNode(function(i){i._sprite=e;var s,o=i._pos>0?i._pos:r._sprite[e][0]/1e3,a=r._sprite[e][1]/1e3-i._pos,f=!!r._loop||!!r._sprite[e][2],l="string"==typeof n?n:Math.round(Date.now()*Math.random())+"";if(function(){var t={id:l,sprite:e,loop:f};s=setTimeout(function(){!r._webAudio&&f&&r.stop(t.id,t.timer).play(e,t.id),r._webAudio&&!f&&(r._nodeById(t.id).paused=!0,r._nodeById(t.id)._pos=0),r._webAudio||f||r.stop(t.id,t.timer),r.on("end",l)},1e3*a),r._onendTimer.push(s),t.timer=r._onendTimer[r._onendTimer.length-1]}(),r._webAudio){var c=r._sprite[e][0]/1e3,h=r._sprite[e][1]/1e3;i.id=l,i.paused=!1,p(r,[f,c,h],l),r._playStart=t.currentTime,i.gain.value=r._volume,void 0===i.bufferSource.start?i.bufferSource.noteGrainOn(0,o,a):i.bufferSource.start(0,o,a)}else{if(4!==i.readyState)return r._clearEndTimer(s),function(){var t=r,s=e,o=n,u=i,a=function(){t.play(s,o),u.removeEventListener("canplaythrough",a,!1)};u.addEventListener("canplaythrough",a,!1)}(),r;i.id=l,i.currentTime=o,i.muted=u._muted,i.volume=r._volume*u.volume(),setTimeout(function(){i.play()},0)}return r.on("play"),"function"==typeof n&&n(l),r}),r):("function"==typeof n&&n(),r):(r.on("load",function(){r.play(e,n)}),r)},pause:function(e,t){var n=this;if(!n._loaded)return n.on("play",function(){n.pause(e)}),n;n._clearEndTimer(t||0);var r=e?n._nodeById(e):n._activeNode();if(r)if(r._pos=n.pos(null,e),n._webAudio){if(!r.bufferSource)return n;r.paused=!0,void 0===r.bufferSource.stop?r.bufferSource.noteOff(0):r.bufferSource.stop(0)}else r.pause();return n.on("pause"),n},stop:function(e,t){var n=this;if(!n._loaded)return n.on("play",function(){n.stop(e)}),n;n._clearEndTimer(t||0);var r=e?n._nodeById(e):n._activeNode();if(r)if(r._pos=0,n._webAudio){if(!r.bufferSource)return n;r.paused=!0,void 0===r.bufferSource.stop?r.bufferSource.noteOff(0):r.bufferSource.stop(0)}else r.pause(),r.currentTime=0;return n},mute:function(e){var t=this;if(!t._loaded)return t.on("play",function(){t.mute(e)}),t;var n=e?t._nodeById(e):t._activeNode();return n&&(t._webAudio?n.gain.value=0:n.volume=0),t},unmute:function(e){var t=this;if(!t._loaded)return t.on("play",function(){t.unmute(e)}),t;var n=e?t._nodeById(e):t._activeNode();return n&&(t._webAudio?n.gain.value=t._volume:n.volume=t._volume),t},volume:function(e,t){var n=this;if(e=parseFloat(e),e>=0&&1>=e){if(n._volume=e,!n._loaded)return n.on("play",function(){n.volume(e,t)}),n;var r=t?n._nodeById(t):n._activeNode();return r&&(n._webAudio?r.gain.value=e:r.volume=e*u.volume()),n}return n._volume},loop:function(e){var t=this;return"boolean"==typeof e?(t._loop=e,t):t._loop},sprite:function(e){var t=this;return"object"==typeof e?(t._sprite=e,t):t._sprite},pos:function(e,n){var r=this;if(!r._loaded)return r.on("load",function(){r.pos(e)}),"number"==typeof e?r:r._pos||0;e=parseFloat(e);var i=n?r._nodeById(n):r._activeNode();if(i)return r._webAudio?e>=0?(r.pause(n),i._pos=e,r.play(i._sprite,n),r):i._pos+(t.currentTime-r._playStart):e>=0?(i.currentTime=e,r):i.currentTime;if(e>=0)return r;for(var s=0;s<r._audioNode.length;s++)if(r._audioNode[s].paused&&4===r._audioNode[s].readyState)return r._webAudio?r._audioNode[s]._pos:r._audioNode[s].currentTime},pos3d:function(e,t,n,r){var i=this;if(t=void 0!==t&&t?t:0,n=void 0!==n&&n?n:-0.5,!i._loaded)return i.on("play",function(){i.pos3d(e,t,n,r)}),i;if(e>=0||0>e){if(i._webAudio){var s=r?i._nodeById(r):i._activeNode();s&&(i._pos3d=[e,t,n],s.panner.setPosition(e,t,n))}return i}return i._pos3d},fade:function(e,t,n,r,i){var s=this,o=Math.abs(e-t),u=e>t?"down":"up",a=o/.01,f=n/a;if(!s._loaded)return s.on("load",function(){s.fade(e,t,n,r,i)}),s;s.volume(e,i);for(var l=1;a>=l;l++)!function(){var e=s._volume+("up"===u?.01:-0.01)*l,n=Math.round(1e3*e)/1e3,o=t;setTimeout(function(){s.volume(n,i),n===o&&r&&r()},f*l)}()},fadeIn:function(e,t,n){return this.volume(0).play().fade(0,e,t,n)},fadeOut:function(e,t,n,r){var i=this;return i.fade(i._volume,e,t,function(){n&&n(),i.pause(r),i.on("end")},r)},_nodeById:function(e){for(var t=this,n=t._audioNode[0],r=0;r<t._audioNode.length;r++)if(t._audioNode[r].id===e){n=t._audioNode[r];break}return n},_activeNode:function(){for(var e=this,t=null,n=0;n<e._audioNode.length;n++)if(!e._audioNode[n].paused){t=e._audioNode[n];break}return e._drainPool(),t},_inactiveNode:function(e){for(var t=this,n=null,r=0;r<t._audioNode.length;r++)if(t._audioNode[r].paused&&4===t._audioNode[r].readyState){e(t._audioNode[r]),n=!0;break}if(t._drainPool(),!n){var i;t._webAudio?(i=t._setupAudioNode(),e(i)):(t.load(),i=t._audioNode[t._audioNode.length-1],i.addEventListener("loadedmetadata",function(){e(i)}))}},_drainPool:function(){var e,t=this,n=0;for(e=0;e<t._audioNode.length;e++)t._audioNode[e].paused&&n++;for(e=t._audioNode.length-1;e>=0&&!(5>=n);e--)t._audioNode[e].paused&&(t._webAudio&&t._audioNode[e].disconnect(0),n--,t._audioNode.splice(e,1))},_clearEndTimer:function(e){var t=this,n=t._onendTimer.indexOf(e);n=n>=0?n:0,t._onendTimer[n]&&(clearTimeout(t._onendTimer[n]),t._onendTimer.splice(n,1))},_setupAudioNode:function(){var e=this,n=e._audioNode,r=e._audioNode.length;return n[r]=void 0===t.createGain?t.createGainNode():t.createGain(),n[r].gain.value=e._volume,n[r].paused=!0,n[r]._pos=0,n[r].readyState=4,n[r].connect(s),n[r].panner=t.createPanner(),n[r].panner.setPosition(e._pos3d[0],e._pos3d[1],e._pos3d[2]),n[r].panner.connect(n[r]),n[r]},on:function(e,t){var n=this,r=n["_on"+e];if("function"==typeof t)r.push(t);else for(var i=0;i<r.length;i++)t?r[i].call(n,t):r[i].call(n);return n},off:function(e,t){for(var n=this,r=n["_on"+e],i=""+t,s=0;s<r.length;s++)if(i===""+r[s]){r.splice(s,1);break}return n},unload:function(){for(var t=this,n=t._audioNode,r=0;r<t._audioNode.length;r++)n[r].paused||t.stop(n[r].id),t._webAudio?n[r].disconnect(0):n[r].src="";var i=u._howls.indexOf(t);null!==i&&i>=0&&u._howls.splice(i,1),delete e[t._src],t=null}},n)var c=function(n,r){if(r in e)n._duration=e[r].duration,h(n);else{var i=new XMLHttpRequest;i.open("GET",r,!0),i.responseType="arraybuffer",i.onload=function(){t.decodeAudioData(i.response,function(t){t&&(e[r]=t,h(n,t))},function(){n.on("loaderror")})},i.onerror=function(){n._webAudio&&(n._buffer=!0,n._webAudio=!1,n._audioNode=[],delete n._gainNode,n.load())};try{i.send()}catch(s){i.onerror()}}},h=function(e,t){e._duration=t?t.duration:e._duration,0===Object.getOwnPropertyNames(e._sprite).length&&(e._sprite={_default:[0,1e3*e._duration]}),e._loaded||(e._loaded=!0,e.on("load")),e._autoplay&&e.play()},p=function(n,r,i){var s=n._nodeById(i);s.bufferSource=t.createBufferSource(),s.bufferSource.buffer=e[n._src],s.bufferSource.connect(s.panner),s.bufferSource.loop=r[0],r[0]&&(s.bufferSource.loopStart=r[1],s.bufferSource.loopEnd=r[1]+r[2]),s.bufferSource.playbackRate.value=n._rate};"function"==typeof define&&define.amd&&define(function(){return{Howler:u,Howl:l}}),window.Howler=u,window.Howl=l}();function apprise(e,t,n){var r,i=function(){r=document.activeElement,t&&t.input?$(".aTextbox").focus():h.find("button").first().focus()},s={confirm:!1,verify:!1,input:!1,animate:!1,textOk:"Ok",textCancel:"Cancel",textYes:"Yes",textNo:"No",position:"center"};if(t)for(var o in s)typeof t[o]=="undefined"&&(t[o]=s[o]);var u=$(window).height(),a=$(window).width(),f=$('<div class="appriseOuter"></div>'),l=$('<div class="appriseOverlay" id="aOverlay"></div>'),c=$('<div class="appriseInner"></div>'),h=$('<div class="aButtons"></div>'),p=100;l.css({height:u,width:a}).appendTo("body").fadeIn(100,function(){$(this).css("filter","alpha(opacity=70)")}),f.appendTo("body"),c.append(e).appendTo(f),t&&t.input&&(typeof t["input"]=="string"&&c.append('<div class="aInput"><input type="text" class="aTextbox" t="aTextbox" value="'+t.input+'" /></div>'),typeof t["input"]=="object"?c.append($('<div class="aInput"></div>').append(t.input)):c.append('<div class="aInput"><input type="text" class="aTextbox" t="aTextbox" /></div>')),c.append(h),t?t.confirm||t.input?(h.append('<button value="ok">'+t.textOk+"</button>"),h.append('<button value="cancel">'+t.textCancel+"</button>")):t.verify?(h.append('<button value="ok">'+t.textYes+"</button>"),h.append('<button value="cancel">'+t.textNo+"</button>")):h.append('<button value="ok">'+t.textOk+"</button>"):h.append('<button value="ok">Ok</button>'),f.css("left",($(window).width()-$(".appriseOuter").width())/2+$(window).scrollLeft()+"px");if(t){t.position&&t.position==="center"&&(p=(u-f.height())/2);if(t.animate){var d=t.animate;isNaN(d)&&(d=400),f.css("top","-200px").show().animate({top:p},d,function(){i()})}else f.css("top",p).fadeIn(200,function(){i()})}else f.css("top",p).fadeIn(200,function(){i()});$(document).keydown(function(e){l.is(":visible")&&(e.keyCode==13&&$('.aButtons > button[value="ok"]').click(),e.keyCode==27&&$('.aButtons > button[value="cancel"]').click())});var v=$(".aTextbox").val();v||(v=!1),$(".aTextbox").keyup(function(){v=$(this).val()}),$(".aButtons > button").click(function(){l.remove(),f.remove(),$(r).focus();if(n){$(this).text("");var e=$(this).attr("value");e=="ok"?t?t.input?n(v):n(!0):n(!0):e=="cancel"&&n(!1)}})};require.define("/routes-account.js",function(e,t,n,r,i){var s=t.exports={loadRoutes:function(e){e.get("/remind-me",function(e){$CONTAINER.append(JT["pages-remindme"]())}),e.get("/change-info",function(e){$CONTAINER.append(JT["pages-changeinfo"]())})}}});require.define("/routes-admin.js",function(e,t,n,r,i){var s=t.exports={loadRoutes:function(t){e("/admin").init();var n=e("/npcs");n.init(),t.get("/admin",function(e){$CONTAINER.append(JT["admin-panel"]({message:"User admin panel."})),$("title").text("{ ::: Civic Seed - Admin Panel ::: }"),$BODY.attr("class","adminPage")}),t.get("/admin/startup",function(e){$CONTAINER.append(JT["admin-startup"]({title:"Startup",bodyClass:"admin startup",environment:CivicSeed.ENVIRONMENT,message:"Startup admin panel."})),$("title").text("{ ::: Civic Seed - Admin Panel - Startup ::: }"),$BODY.attr("class","adminPage startupPage")}),t.get("/admin/monitor",function(e){ss.rpc("admin.monitor.getInstanceNames",sessionStorage.userId,function(e,t){e?apprise(e):($CONTAINER.append(JT["admin-monitor"]({instances:t})),$("title").text("{ ::: Civic Seed - Admin Panel - Monitor ::: }"),$BODY.attr("class","adminPage"))})}),t.get("/admin/npcs",function(e){ss.rpc("admin.npcs.init",sessionStorage.userId,function(e){if(e){for(var t=0;t<e.length;t++){var r=e[t].index%142,i=Math.floor(e[t].index/142);e[t].x=r,e[t].y=i}$CONTAINER.append(JT["admin-npcs"]({npcs:e})),$("title").text("{ ::: Civic Seed - NPC Panel - Monitor ::: }"),$BODY.attr("class","npcsPage"),n.addSprites()}else console.log("error")})}),t.get("/admin/invitecodes",function(e){$CONTAINER.append(JT["admin-invitecodes"]({title:"Startup",bodyClass:"admin startup",nodeEnv:"nodeEnv",message:"Startup admin panel."}))})}}});require.define("/routes-errors.js",function(e,t,n,r,i){var s=t.exports={loadRoutes:function(e){e.get("/404",function(e){$CONTAINER.append(JT["pages-404"]())}),e.bind("routeNotFound",function(e){e.redirect("/404")})}}});require.define("/routes-main.js",function(e,t,n,r,i){var s=t.exports={loadRoutes:function(e){e.get("/",function(e){$CONTAINER.append(JT["pages-home"]())}),e.get("/about",function(e){$CONTAINER.append(JT["pages-about"]())}),e.get("/contact",function(e){$CONTAINER.append(JT["pages-contactus"]())}),e.get("/game",function(e){$game.enterGame()}),e.get("/introduction",function(e){$CONTAINER.append(JT["pages-introduction"]())})}}});require.define("/routes-middleware.js",function(e,t,n,r,i){var s=["/game"],o=["/admin","/admin/invitecodes","/admin/monitor"],u=["/admin/startup","/admin/npcs"],a=t.exports={loadMiddleware:function(e){e.before(function(e){var t=e.fullPath,n=sessionStorage.getItem("userRole");Davis.previousPath&&Davis.previousPath==="/game"&&sessionStorage.getItem("isPlaying")&&$game.exitGame(),Davis.previousPath=e.fullPath,typeof n!="string"&&(n="non-user"),$CONTAINER.empty().append(JT["partials-navigation"]({fullPath:t}));if(s.indexOf(t)>-1){if(n!=="actor")return e.redirect("/"),!1}else if(o.indexOf(t)>-1){if(n!=="superadmin"&&n!=="admin")return e.redirect("/"),!1}else if(u.indexOf(t)>-1&&n!=="superadmin")return e.redirect("/"),!1})}}});require.define("/routes-profile.js",function(e,t,n,r,i){var s=t.exports={loadRoutes:function(t){var n=e("/profile");n.init(),t.get("/profiles",function(e){ss.rpc("shared.profiles.getAllProfiles",function(e){$CONTAINER.append(JT["profiles-allprofiles"]({users:e}))})}),t.get("/profiles/:random",function(e){ss.rpc("shared.profiles.getProfileInformation",e.params.random,function(e){e?!e.profileSetup&&sessionStorage.userEmail===e.email?Davis.location.assign("change-info"):$CONTAINER.append(JT["profiles-singleprofile"](e)):console.log("error!")})})}}});require.define("/admin.js",function(e,t,n,r,i){var s,o=t.exports={gameInstances:null,allQuestions:null,allAnswers:null,players:null,init:function(){s=$(document.body),o.setupLoaders(),o.setupInviteCodes(),o.setupMonitor()},setupLoaders:function(){s.on("click","#dataLoaders .btn",function(e){var t=$(this),n=t.data().type;t.removeClass("btn-success"),ss.rpc("admin.startup.loadData",n,function(e){t.addClass("btn-success")})})},setupInviteCodes:function(){s.on("click","#inviteCodesBtn",function(e){var t=$(this);t.removeClass("btn-success");var n=$("#emailList").val().match(/\b[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}\b/gi),r=$("#instanceName").val().trim();if(r&&n){n=n.slice(0,20),emailListLength=n.length;var i=sessionStorage.getItem("userId");ss.rpc("admin.invitecodes.newGameInstance",{instanceName:r,numPlayers:emailListLength,id:i},function(e,i){e?console.log("error with db",e):i?apprise("game name already exists"):ss.rpc("admin.invitecodes.sendInvites",n,r,function(e){t.addClass("btn-success")})})}})},setupMonitor:function(){o.getQuestions(),s.on("click","#players",function(){var e=$(this).attr("data-instance");ss.rpc("admin.monitor.getPlayers",e,function(e,t){t&&(o.players=t,o.showPlayersInfo())})}),s.on("click","#questions",function(){var e=$(this).attr("data-instance");o.showQuestions(e)}),s.on("click","#chat",function(){var e=$(this).attr("data-instance");ss.rpc("admin.monitor.getRecentChat",e,function(e,t){t&&o.showChat(t)})}),s.on("click","#addPlayer",function(){var e=$(this).attr("data-instance");o.showAddPlayerForm(e)}),s.on("click","#startStop",function(){var e=$(this).attr("data-instance");o.addStartStopButton(e)}),s.on("click",".viewAnswers",function(){var e=$(this).attr("data-index");o.showPlayerAnswers(e)}),s.on("click",".stopGameButton",function(){var e=$(this).attr("data-instance");o.toggleGame(e,!1)}),s.on("click",".startGameButton",function(){var e=$(this).attr("data-instance");o.toggleGame(e,!0)}),s.on("click",".deletePlayer",function(){var e=$(this).attr("data-id"),t=$(".input"+e).val();t.indexOf("delete")>-1?o.deletePlayer(e,this):apprise("you must type delete to delete user")}),s.on("click",".allQuestion",function(){var e=$(this).attr("data-npc"),t=$(this).attr("data-instance");o.showQuestionAnswers(e,t,this)}),s.on("click",".addPlayerButton",function(e){e.preventDefault();var t=$("#addPlayerEmail").val().match(/\b[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}\b/gi),n=$(this).attr("data-instance");return t?ss.rpc("admin.invitecodes.getCount",n,function(e){e?ss.rpc("admin.invitecodes.sendInvites",t,n,e,function(e){e?apprise("added successfully"):apprise("error")}):apprise("the game is full")}):apprise("invalid email."),!1})},showPlayersInfo:function(){var e="";for(var t=0;t<o.players.length;t++){var n=o.players[t].game.playingTime,r=Math.floor(n/3600),i=n%3600,s=Math.floor(i/60),u=n%60,a=r+"h "+s+"m "+u+"s",f=o.players[t].activeSessionID?!0:!1;e+='<div class="player'+o.players[t]._id+'"><h2>'+o.players[t].firstName+" "+o.players[t].lastName+"</h2>",e+="<p>Profile unlocked: "+o.players[t].profileUnlocked+"</p>",e+="<p>Logged in: "+f+"</p>",e+="<p>Time played: "+a+"</p>",e+="<p>Resources collected: "+o.players[t].game.resourcesDiscovered+" / 42  <button data-index="+t+' class="viewAnswers btn btn-success" type="button">View Answers</button></p>',e+='<p>Enter "delete" to remove user permanently: <input class="input'+o.players[t]._id+'"></input><button data-id='+o.players[t]._id+' class="btn btn-danger deletePlayer" type="button">Delete User</button></p></div>'}$(".output").empty().append(e)},showChat:function(e){var t='<h2>Recent Chat History</h2><div class="allChat">';if(e.length===0)t+="<p>No one has spoken yet.</p>";else for(var n=0;n<e.length;n++){var r=e[n].when.substring(0,10),i=e[n].when.substring(11,20);t+='<p><span class="time">['+r+" || "+i+']</span><span class="who"> '+e[n].who+' </span><span class="what">'+e[n].what+"</span></p>"}t+="</div>",$(".output").empty().append(t)},showAddPlayerForm:function(e){var t='<h2>Add Player</h2><form id="addPlayerForm"><input placeholder="email address" id="addPlayerEmail"></input></form><p><button data-instance="'+e+'"class="btn btn-success addPlayerButton" type="button">Add Player</button></p>';$(".output").empty().append(t)},addStartStopButton:function(e){var t='<h2>Make the game active or inactive:</h2><p><button data-instance="'+e+'"class="btn btn-success startGameButton" type="button">Start Game</button></p><p><button data-instance="'+e+'"class="btn btn-warning stopGameButton" type="button">Stop Game</button></p>';$(".output").empty().append(t)},getQuestions:function(){ss.rpc("admin.monitor.init",function(e,t){t&&(o.allQuestions=t.sort(o.sortByLevel))})},showPlayerAnswers:function(e){var t=o.players[e].game.resources,n=o.allQuestions.length,r="<h2>"+o.players[e].firstName+" "+o.players[e].lastName+"</h2>";for(var i=0;i<t.length;i++){var s=t[i],u=s.index,a=0,f=!1,l=!1;while(!f)o.allQuestions[a].index===u&&(f=!0,o.allQuestions[a].resource.questionType==="open"&&(l=!0,r+='<p class="question level'+o.allQuestions[a].level+'">Q: '+o.allQuestions[a].resource.question+"</p>")),a++,a>=n&&(f=!0);l&&(r+='<div class="answer"><p>A: '+s.answers[0]+'</p><div class="extras">',s.madePublic&&(r+='<i class="fa fa-unlock-alt fa-lg"></i>'),s.seeded&&(r+='<i class="fa fa-thumbs-up fa-lg"></i> '+s.seeded.length),r+="</div></div>")}$(".output").empty().append(r)},deletePlayer:function(e){ss.rpc("admin.monitor.deletePlayer",e,function(t){if(t)console.log(t);else{var n=".player"+e;$(n).remove()}})},toggleGame:function(e,t){ss.rpc("admin.monitor.toggleGame",e,t,function(e){e?apprise("error switching game"):t?apprise("the game is now active"):apprise("the game is now inactive")})},showQuestions:function(e){var t="<h2>All Open-Ended Questions</h2>";for(var n=0;n<o.allQuestions.length;n++)o.allQuestions[n].resource.questionType==="open"&&(t+='<div class="allQuestion" data-instance="'+e+'" data-npc="'+o.allQuestions[n].index+'">',t+='<p data-npc="'+o.allQuestions[n].index+'" class="mainQ level'+o.allQuestions[n].level+'">'+o.allQuestions[n].resource.question+"</p></div>");o.getAllAnswers(e),$(".output").empty().append(t)},getAllAnswers:function(e){ss.rpc("admin.monitor.getInstanceAnswers",e,function(e,t){e?o.allAnswers=[]:t&&(o.allAnswers=t.resourceResponses)})},showQuestionAnswers:function(e,t,n){$(".allQuestion .allPlayerAnswers").remove();var r="",i=!1,s=parseInt(e,10);for(var u=0;u<o.allAnswers.length;u++)o.allAnswers[u].npc===s&&(i=!0,r+='<p class="allPlayerAnswers"><span class="subWho">'+o.allAnswers[u].name+": </span>",r+='<span class="subAnswer">'+o.allAnswers[u].answer+"</span></p>");i||(r+='<p class="allPlayerAnswers">There are no answers for this question yet.</p>'),$(n).append(r)},sortByLevel:function(e,t){return e.level<t.level?-1:e.level>t.level?1:0}}});require.define("/npcs.js",function(e,t,n,r,i){var s,o=null,u=t.exports={init:function(){s=$(document.body),u.setup(),u.loadSprites()},setup:function(){$("button").on("click",function(e){return e.preventDefault(),!1}),s.on("click",".levelFilter div",function(){var e=parseInt($(this).text(),10);$(this).toggleClass("current");var t=$(this).hasClass("current"),n=".level"+(e-1);t?$(n).show():$(n).hide()}),s.on("click",".saveChanges",function(){var e=parseInt($(this).attr("data-id"),10);u.saveChanges(e)}),s.on("click",".deleteNpc",function(){var e=parseInt($(this).attr("data-id"),10);u.deleteNpc(e)}),s.on("click",".spriteUp",function(){var e=$(this).parentsUntil(".npcs"),t=$(e[e.length-1]),n=t.attr("data-sprite"),r=$(e[1]);if(n>0){n--;var i=n*-64,s="0 "+i+"px";r.css({"background-position":s}),t.attr("data-sprite",n)}}),s.on("click",".spriteDown",function(){var e=$(this).parentsUntil(".npcs"),t=$(e[e.length-1]),n=t.attr("data-sprite"),r=$(e[1]);if(n<53){n++;var i=n*-64,s="0 "+i+"px";r.css({"background-position":s}),t.attr("data-sprite",n)}}),s.on("click",".viewResource",function(){var e=$(this).parentsUntil(".npc"),t=e.find(".url"),n="/articles/"+$(t).val()+".html";$(".article").empty().load(n,function(){$(".buffer").show(),$(this).show()})}),s.on("click",".addNpc",function(){var e=$(".npcTemplate .npc").clone();$(e).insertBefore(".addDiv")}),s.on("click",".article, .buffer",function(){$(".article, .buffer").hide()}),s.on("change",'input[type="checkbox"]',function(){var e=this.checked?!0:!1;parents=$(this).parentsUntil(".npcs"),npcParent=$(parents[parents.length-1]),e?($(npcParent).find(".resource").show(),$(npcParent).find(".prompts").show(),$(npcParent).find(".smalltalk").hide()):($(npcParent).find(".resource").hide(),$(npcParent).find(".prompts").hide(),$(npcParent).find(".smalltalk").show())}),s.on("change",'input[type="radio"]',function(){var e=$(this).val(),t=$(this).parentsUntil(".npcs"),n=$(t[t.length-1]);$(n).find(".questionOptions").hide(),e==="open"?$(n).find(".requiredDiv").show():(e==="multiple"&&$(n).find(".possibleDiv").show(),$(n).find(".answerDiv").show())})},loadSprites:function(){o=new Image,o.src=CivicSeed.CLOUD_PATH+"/img/game/npcs.png",o.onload=function(){}},addSprites:function(){var e=$(".npc");url="url("+CivicSeed.CLOUD_PATH+"/img/admin/npcs.png"+")",e.each(function(e){var t=$(this).attr("data-sprite"),n=t*-64,r="0 "+n+"px",i=$(this).find(".sprite");i.css({"background-image":url,"background-repeat":"no-repeat","background-position":r})})},saveChanges:function(e){var t=$(".npcs").find(".npc"+e),n=t.find(".information textarea, .information input"),r=t.find(".resource textarea, .resource input"),i=t.find(".prompts textarea"),s=t.find(".smalltalk textarea"),o=t.find(".skinSuit input"),a=t.find(".information .holding")[0].checked,f=t.find(".resource input:checked").val(),l=parseInt(t.attr("data-sprite"),10),c={id:e,isHolding:a,resource:{url:null,shape:null,questionType:f,answer:null,question:null,possibleAnswers:[],feedbackRight:null,feedbackWrong:null},dependsOn:null,dialog:{prompts:[],smalltalk:[]},level:null,sprite:l,index:null,name:null,skinSuit:null},h,p;n.each(function(e){var t=$(this).attr("data-area"),n=u._prettify(this.value);t==="name"?c.name=n:t==="level"?c.level=parseInt(n,10)-1:t==="x"?h=parseInt(n,10):t==="y"&&(p=parseInt(n,10))}),c.index=p*142+h,r.each(function(e){var t=$(this).attr("data-area"),n=u._prettify(this.value);t==="url"?c.resource.url=n:t==="shape"?c.resource.shape=n:t==="question"?c.resource.question=n:t==="possibleAnswers"?c.resource.possibleAnswers.push(n):t==="answer"?c.resource.answer=n:t==="requiredLength"?c.resource.requiredlength=parseInt(n,10):t==="dependsOn"?c.dependsOn=parseInt(n,10):t==="feedbackRight"?c.resource.feedbackRight=n:t==="feedbackWrong"&&(c.resource.feedbackWrong=n)}),i.each(function(e){var t=$(this).attr("data-area"),n=u._prettify(this.value);t==="prompt"&&c.dialog.prompts.push(n)}),s.each(function(e){var t=$(this).attr("data-area"),n=u._prettify(this.value);t==="smalltalk"&&c.dialog.smalltalk.push(n)});var d=o.val();d&&d.length>0&&(c.skinSuit=d);if(e<0){var v=0;$(".saveChanges").each(function(e){var t=parseInt($(this).data("id"),10);t>v&&(v=t)}),v++,c.id=v;var m="level"+c.level,g="npc"+c.id;t.removeClass().addClass("npc").addClass(m).addClass(g);var y=t.find(".saveChanges"),b=t.find(".deleteNpc");$(y).attr("data-id",c.id),$(b).attr("data-id",c.id),ss.rpc("admin.npcs.addNpc",c,function(e){if(e)apprise(e);else{var n=t.find(".saveChanges");$(n).addClass("justSaved"),setTimeout(function(){$(n).removeClass("justSaved")},1e3)}})}else ss.rpc("admin.npcs.updateInformation",c,function(e){if(e)apprise(e);else{var n=t.find(".saveChanges"),r="level"+c.level,i="npc"+c.id;t.removeClass().addClass("npc").addClass(r).addClass(i),$(n).addClass("justSaved"),setTimeout(function(){$(n).removeClass("justSaved")},1e3)}})},deleteNpc:function(e){var t=prompt('please type "delete" to permanently remove the npc.');if(t==="delete"){var n=$(".npc"+e);e<0?n.fadeOut(function(){this.remove()}):ss.rpc("admin.npcs.deleteNpc",e,function(e,t){e?console.log(e):n.fadeOut(function(){this.remove()})})}},_prettify:function(e){var t=e.toString();return t=t.trim().replace(/\s+/g," "),t=t.replace(/"([^"]*)"/g,"$1"),t=t.replace(/([A-Za-z])\'([A-Za-z])/,"$1$2"),t=t.replace(/(\s)\'([A-Za-z])/g,"$1$2"),t=t.replace(/([A-Za-z])\'(\s)/g,"$1$2"),t=t.replace(/^\'/gm,""),t}}});require.define("/profile.js",function(e,t,n,r,i){var s,o=t.exports={init:function(){s=$(document.body),s.on("click",".saveProfileChanges",function(){var e=[],t=$(".resumeText");$.each(t,function(t,n){var r=$(n).text();e.push(r)});var n={id:sessionStorage.getItem("userId"),resume:e};ss.rpc("shared.profiles.updateResume",n,function(e){e&&apprise("changes saved")})}),s.on("click",".profileToggle",function(){var e=$(this).attr("data-public"),t,n,r;e==="false"||!e?(e="true",t=!0,n="your profile is public",r="fa fa-unlock-alt fa-4x"):(e="false",t=!1,n="your profile is private",r="fa fa-lock fa-4x"),$(this).attr("data-public",e);var i=$(this).find("p");$(i).text(n);var s=$(this).find("i");$(s).removeClass().addClass(r);var o={id:sessionStorage.getItem("userId"),changeTo:t};ss.rpc("shared.profiles.setPublic",o,function(e){})}),s.on("click",".feedback",function(){var e=$(this).find(".row");$(e).toggleClass("hideth")})}}});require.define("/account.js",function(e,t,n,r,i){var s,o=function(e,t){e>0?($(".appriseOuter .countdown").html(e),e-=1,s=setTimeout(function(){o(e,t)},1e3)):(clearTimeout(s),$(".appriseOuter .countdown").html(e),t())},u=function(e){$(".appriseOverlay").remove(),$(".appriseOuter").remove(),console.log("Booting THIS user and allowing OTHER USER.",e),$game.exitGame(function(){a.deAuthenticate(function(t){ss.rpc("shared.account.approveNewSession",e)})})},a=t.exports={accountHandlers:function(){var e=$(document.body);e.on("submit","#loginForm",function(){var e=document.getElementById("username").value.toLowerCase(),t=document.getElementById("password").value;return a.authenticate(e,t),!1}),e.on("click",".signOut",function(){return sessionStorage.isPlaying==="true"?$game.exitGame(function(){a.deAuthenticate()}):a.deAuthenticate(),!1}),e.on("submit","#remindMeForm",function(){var e=document.getElementById("username").value.toLowerCase();return ss.rpc("shared.account.remindMeMyPassword",e,function(e){e?($("#username").val(""),$("#message").removeClass("error").text("A reminder email was successfully sent to you! ")):$("#message").addClass("error").text("There was an error. Please enter the correct email.")}),!1}),e.on("submit","#contactUs",function(){var e=document.getElementById("username").value,t=document.getElementById("problem").value;return ss.rpc("shared.account.sendProblem",e,t,function(e){e?$("#message").removeClass("error").text("Thanks! We'll get on it right away."):$("#message").addClass("error").text("There was an error. Email civicseed@gmail.com directly please.")}),!1}),e.on("submit","#changeInfoForm",function(){var e=document.getElementById("firstname").value.trim(),t=document.getElementById("lastname").value.trim(),n=document.getElementById("school").value.trim(),r=/^[a-zA-Z]*$/.test(e),i=/^[a-zA-Z]*$/.test(t),s={first:e,last:t,school:n};return r&&i?ss.rpc("shared.account.changeInfo",s,function(e){e?(sessionStorage.setItem("userFirstName",e.firstName),sessionStorage.setItem("userLastName",e.lastName),Davis.location.assign("/introduction")):$("#message").addClass("error").text("There was an error. Please panic.")}):apprise("only letters and no spaces please."),!1}),e.on("click","#startGame",function(){ss.rpc("shared.account.startGame")}),ss.event.on("verifyGameStatus",function(e){var t;sessionStorage.getItem("isPlaying")?(t='Are you still there? Signing out in <strong class="countdown">'+e.countdown+"</strong> seconds.",apprise(t,{verify:!0,textNo:"Sign Out"},function(t){clearTimeout(s),t?(console.log("Okay! Stay active!",e.userId),ss.rpc("shared.account.denyNewSession",{userId:e.userId,profileLink:e.profileLink})):u(e.userId)}),o(e.countdown,function(){u(e.userId)})):(t='There is an active game with your creds. Please wait while we check it.<br>This may take a few seconds (<strong class="countdown">'+e.countdown+'</strong>).					<br><br><span style="display:block;font-size:11px;text-align:center;">(If you think there is a problem, 					please use the Contact Us link to tell the admin.)</span>',apprise(t),$(".appriseInner .aButtons").remove(),o(e.countdown+5,function(){$(".appriseOverlay").remove(),$(".appriseOuter").remove(),ss.rpc("shared.account.setActiveSessionId",e.userId),sessionStorage.setItem("isPlaying",!0),$game.kickOffGame()}))}),ss.event.on("inactiveGameRedirect",function(e){Davis.location.assign("/profiles/"+e.profileLink)}),ss.event.on("denyNewSession",function(e){Davis.location.current()==="/game"&&(clearTimeout(s),sessionStorage.getItem("isPlaying")||(Davis.location.assign("/profiles/"+e.profileLink),$(".appriseOverlay").remove(),$(".appriseOuter").remove(),apprise("Game access denied (possibly already logged in). Contact Admin if you think you should have access.")))}),ss.event.on("approveNewSession",function(e){clearTimeout(s),Davis.location.current()==="/game"&&(ss.rpc("shared.account.setActiveSessionId",e),$(".appriseOverlay").remove(),$(".appriseOuter").remove(),sessionStorage.setItem("isPlaying",!0),$game.kickOffGame())})},authenticate:function(e,t){ss.rpc("shared.account.authenticate",e,t,function(e){var t;e.status?(t=e.session,sessionStorage.setItem("userId",t.id),sessionStorage.setItem("userFirstName",t.firstName),sessionStorage.setItem("userLastName",t.lastName),sessionStorage.setItem("userEmail",t.email),sessionStorage.setItem("userRole",t.role),sessionStorage.setItem("profileLink",t.profileLink),t.role==="superadmin"||t.role==="admin"?Davis.location.assign("/admin"):t.profileSetup?t.gameStarted?Davis.location.assign("/profiles/"+t.profileLink):Davis.location.assign("/introduction"):Davis.location.assign("/change-info")):apprise(e.reason)})},deAuthenticate:function(e){ss.rpc("shared.account.deAuthenticate",function(t){sessionStorage.clear(),Davis.location.assign("/"),typeof e=="function"&&e(t)})},getUserSession:function(e){ss.rpc("shared.account.getUserSession",function(t){t&&e(t)})}}});require.define("/audio.js",function(e,t,n,r,i){"use strict";var s=[],o=null,u=null,a=null,f=-1,l=-1,c=8,h=null,p="welcome...",d=0,v=CivicSeed.CLOUD_PATH+"/audio/music/",m=CivicSeed.CLOUD_PATH+"/audio/fx/",g=!1,y=null,b=[{sound:"stream",locations:[{x:30,y:10},{x:30,y:50},{x:30,y:90},{x:30,y:130},{x:30,y:170}],prox:{x:10,y:10}},{sound:"wind",locations:[{x:15,y:8},{x:60,y:50}],prox:{x:20,y:15}},{sound:"chatter",locations:[{x:100,y:30}],prox:{x:20,y:20}},{sound:"waves",locations:[{x:10,y:80}],prox:{x:20,y:20}}],w=[{location:{x:35,y:30},sounds:["forest1","forest2","forest3","bird1","bird2","bird3"],prox:{x:35,y:30},chance:.2},{location:{x:105,y:30},sounds:["churchBells","townBells","chatter","bird2","bird3"],prox:{x:20,y:20},chance:.1},{location:{x:105,y:90},sounds:["chickens","sheep1","sheep2","horse","bird3"],prox:{x:35,y:30},chance:.15},{location:{x:35,y:90},sounds:["portBells","foghorn","bird2"],prox:{x:25,y:20},chance:.1}],E=null,S=null,x=function(e){return e&&"_webAudio"in e},T=$game.$audio={ready:!1,isMute:!1,config:{soundtrackVolume:.2,environmentLoopFxVolume:.1,environmentOnceFxVolume:.3,triggerFxVolume:.4},init:function(e){CivicSeed.ENVIRONMENT!=="development"&&(y=CivicSeed.version),T.isMute=$game.$player.isMuted,T.isMute&&($game.$input.muteAudio(),$game.$audio.mute());var t=$game.$player.getPosition(),n=T.whichTrack(t.x,t.y);n===-1&&(n=4),T.loadTrack(n);var r=function(){T.ready?e():setTimeout(r,30)};r()},resetInit:function(){s=[],o=null,u=null,a=null,f=-1,l=-1,h=null,p="welcome...",d=0,g=!1,y=null,E=null,S=null,$game.$audio.ready=!1,$game.$audio.isMute=$game.$player.isMuted},loadTrack:function(e){var t=v+e+".mp3?VERSION=",n=v+e+".ogg?VERSION=";y?(t+=y,n+=y):(t+=Math.round(Math.random(1)*1e9),n+=Math.round(Math.random(1)*1e9));var r=!0;$game.$player.currentLevel>3&&$game.bossModeUnlocked&&(r=!1),s[e]=new Howl({urls:[t,n],autoplay:r,loop:!0,volume:T.config.soundtrackVolume,buffer:!0}),T.loadOtherTrack(0,e),T.loadTriggerFx(),f=e},loadOtherTrack:function(e,t){if(e!==t){var n=v+e+".mp3?VERSION=",r=v+e+".ogg?VERSION=";y?(n+=y,r+=y):(n+=Math.round(Math.random(1)*1e9),r+=Math.round(Math.random(1)*1e9)),s[e]=new Howl({urls:[n,r],autoplay:!1,loop:!0,volume:0,buffer:!0}),e++,e!==c&&T.loadOtherTrack(e,t)}else e++,e!==c&&T.loadOtherTrack(e,t)},loadTriggerFx:function(){var e=v+"triggers.mp3?VERSION=",t=v+"triggers.ogg?VERSION=";y?(e+=y,t+=y):(e+=Math.round(Math.random(1)*1e9),t+=Math.round(Math.random(1)*1e9)),o=new Howl({urls:[e,t],sprite:{chatSend:[0,500],chatReceive:[1e3,1300],npcBubble:[3e3,300],windowShow:[4e3,400],seedDrop:[5e3,500],riddleDrop1:[6e3,700],riddleDrop2:[7e3,700],riddleDrop3:[8e3,700],riddleDrop4:[9e3,700],resourceRight:[1e4,500],resourceWrong:[11e3,700],puzzleRight:[12e3,1200],puzzleWrong:[14e3,700],pieceSelect:[15e3,300],pieceDrop:[16e3,200],robot:[17e3,2800]},volume:T.config.triggerFxVolume,onload:function(){T.loadEnvironmentLoopFx()}})},loadEnvironmentLoopFx:function(){var e=v+"environmentloop.mp3?VERSION=",t=v+"environmentloop.ogg?VERSION=";y?(e+=y,t+=y):(e+=Math.round(Math.random(1)*1e9),t+=Math.round(Math.random(1)*1e9)),u=new Howl({urls:[e,t],sprite:{stream:[0,5010],chatter:[6e3,12025],wave:[19e3,16500],wind:[36e3,14350]},loop:!0,onend:function(){T.checkLoopExit()},volume:T.config.environmentLoopFxVolume,onload:function(){T.loadEnvironmentOnceFx()}})},loadEnvironmentOnceFx:function(){var e=v+"environmentonce.mp3?VERSION=",t=v+"environmentonce.ogg?VERSION=";y?(e+=y,t+=y):(e+=Math.round(Math.random(1)*1e9),t+=Math.round(Math.random(1)*1e9)),a=new Howl({urls:[e,t],sprite:{neo:[0,1520],bigger:[2e3,5300],horse:[8e3,11e3],sheep1:[11e3,1600],sheep2:[13e3,1500],chickens:[15e3,4400],forest1:[2e4,1e3],forest2:[21e3,1600],portBells:[23e3,4400],churhBells:[28e3,3150],townBells:[32e3,2400],bird1:[35e3,700],bird2:[36e3,500],bird3:[37e3,900],foghorn:[38e3,4300],chatter:[43e3,5500],forest3:[49e3,2700]},volume:T.config.environmentOnceFxVolume,onend:function(){},onload:function(){T.ready=!0}})},playTriggerFx:function(e){o.play(e)},playEnvironmentLoopFx:function(e){u.play(e)},playEnvironmentOnceFx:function(e){var t=Math.random()*2e3;setTimeout(function(){a.play(e)},t)},update:function(e,t){S={x:e,y:t};var n=T.whichTrack(e,t);s[n]._loaded&&n!==f&&!g&&(T.switchTrack(n),$game.statusUpdate({message:p,input:"status",screen:!0,log:!1})),E||T.checkEnvironmentLoopFx(n),T.checkEnvironmentOnceFx(n)},checkEnvironmentLoopFx:function(){var e=b.length,t=0;while(t<e){var n=b[t],r=n.locations.length,i=0;while(i<r){var s=T.getProximity(n.locations[i],n.prox);s&&(E=n,T.playEnvironmentLoopFx(n.sound),i=r,t=e),i++}t++}},checkEnvironmentOnceFx:function(){var e=w.length,t=0;while(t<e){var n=w[t],r=T.getProximity(n.location,n.prox);if(r){var i=Math.random();if(i<n.chance){var s=Math.floor(i/n.chance*n.sounds.length);T.playEnvironmentOnceFx(n.sounds[s]),t=e}}t++}},getProximity:function(e,t){var n=Math.abs(S.x-e.x),r=Math.abs(S.y-e.y);return n<t.x&&r<t.y?!0:!1},checkLoopExit:function(){var e=E.locations.length,t=0,n=!1;while(t<e){var r=T.getProximity(E.locations[t],E.prox);r&&(n=!0,t=e),t++}n||(u.pause(E.sound),E=null)},pauseTrack:function(){s[f].pause()},switchTrack:function(e){l=f,f=e,l!==f&&(g=!0,s[l].fadeOut(0,1e3,function(){s[l].pause()}),s[f].fadeIn(.2,3e3,function(e){g=!1}))},whichTrack:function(e,t){var n=e-($game.TOTAL_WIDTH-4)/2,r=t-($game.TOTAL_HEIGHT+8)/2,i=null,s=Math.abs(n),o=Math.abs(r);return e>=57&&e<=84&&t>=66&&t<=78?(i=5,p="entering "+$game.world.origin.name):n>0&&r>0?(i=2,p="entering "+$game.world.southeast.name):n>0&&r<0?(i=1,p="entering "+$game.world.northeast.name):n<0&&r<0?(i=0,p="entering "+$game.world.northwest.name):n<0&&r>0?(i=3,p="entering "+$game.world.southwest.name):(i=f,p="you are on the equator"),i},toggleMute:function(){return T.isMute=!T.isMute,T.isMute?T.mute():T.unmute(),$game.$player.isMuted=T.isMute,ss.rpc("game.player.updateGameInfo",{id:$game.$player.id,isMuted:$game.$player.isMuted}),T.isMute},mute:function(){Howler.mute()},unmute:function(){Howler.unmute()},fadeLow:function(){T.isMute||(s[f].volume(T.config.soundtrackVolume*.25),u.volume(T.config.environmentLoopFxVolume*.15))},fadeHi:function(){T.isMute||(s[f].volume(T.config.soundtrackVolume),u.volume(T.config.environmentLoopFxVolume))},stopAll:function(){s[f].stop(),u.stop()}}});require.define("/boss.js",function(e,t,n,r,i){"use strict";function I(){f=$("body"),l=$(".bossArea"),c=$(".bossArea .content"),h=$(".bossArea .buttons"),p=$(".bossHud .seedButton"),d=$(".bossHud .seedButton .badge"),v=$(".bossHud .clock"),m=$(".bossHud .score span")}function q(){$game.$boss.isShowing=!0,c.empty();var e="";if(s===0)e='<div class="videoFrame"><iframe src="//player.vimeo.com/video/74144898" width="600" height="337" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></div>',c.append(e);else if(s===1)ss.rpc("game.player.getRandomResumes",{instanceName:$game.$player.instanceName},function(t){if(t.length>0){o=R(t),e="<p class=\"dialog\"><span>Botanist:</span>  To find the charging modules, you will need to use my SPECIAL SEEDS. But... the seeds aren't finished yet. You'll need to add the last ingredient. Please read what your fellow players have said and provide feedback. This will help them improve their civic resumes. Review all four to receive your SPECIAL SEEDS!</p>";for(var n=0;n<o.length;n++){var r=$game.$botanist.getLevelQuestion(n);e+='<p class="resumeQuestion">Q: '+r+"</p>",e+='<p class="resumeAnswer"><span>A random peer said: </span> '+o[n].answer+"</p>",e+='<p>Do you have any feedback for his or her response? Enter it below.</p><textarea class="resume-feedback" placeholder="Type your feedback here..." maxlength="5000" autofocus></textarea>'}c.append(e)}else console.log("error")});else if(s===2){var t=CivicSeed.CLOUD_PATH+"/img/game/boss/mini_lab.jpg",n=CivicSeed.CLOUD_PATH+"/img/game/boss/charger.png",r=CivicSeed.CLOUD_PATH+"/img/game/boss/thing1.png",i=CivicSeed.CLOUD_PATH+"/img/game/boss/thing2.png",u=CivicSeed.CLOUD_PATH+"/img/game/boss/thing3.png",a=CivicSeed.CLOUD_PATH+"/img/game/boss/thing4.png";e='<p class="dialog"><span>Botanist:</span> Thanks! You got 20 special seeds.</p>',e+='<p class="detailedInstructions"><img class="minilab" src="'+t+'"> This is the basement of my lab. The CHARGING MODULES <img src="'+n+"\"> are hidden somwhere here.  To find the charging modules, you'll need to use the SPECIAL SEEDS  you earned.  These special seeds can detect and reveal the charging modules. Whenver you plant one, the color bursts will be DARKER the CLOSER it is to a charging module. It will help guide the way!</p>",e+='<p class="detailedInstructions">Once you reveal a charging module, you have to WALK OVER TO IT, and disable it by hand. Find all four to shut down the robot!  You might also find some of my other inventions down here. These can give you more seeds <img src="'+r+'"> , or more time <img src="'+i+'"> . Watch out for the red potion <img src="'+u+'">  which can erase your progress, or the watch <img src="'+a+"\">  that speeds up the timer. If you run out seeds, or run out of time, you'll have to try again.</p>",$(".bossArea .bossButton").text("Ready?"),c.append(e)}else s===3?(e='<p class="dialog"><span>Botanist:</span> You failed to defeat the robot. Why don\'t you try again?</p>',$(".bossArea .bossButton").text("Play Again").css("margin-top","50px"),c.append(e)):s===4&&ss.rpc("game.player.unlockProfile",$game.$player.id,function(t){t?console.log("error"):(e='<p class="dialog"><span>Botanist:</span> Congratulations, you defeated the robot!</p>',e+='<p class="hoorayVideo"><iframe src="//player.vimeo.com/video/74131828" width="500" height="281" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe></p>',$(".bossArea .bossButton").html('<a href="/profiles/'+sessionStorage.profileLink+'">Unlock Profile</a>'),c.append(e))})}function R(e){function u(t){var r=!1,i;while(!r)if(n===1)i=e[0],r=!0;else{var s=Math.floor(Math.random()*n);i=e[s],i._id!==$game.$player.id&&(r=!0)}return i}var t=4,n=e.length,r=[];e={};for(var i=0;i<t;i++){var s=u(i),o={id:s._id,answer:s.game.resume[i]};r.push(o)}return r}function U(){var e=[];$(".bossArea textarea").each(function(t){var n=this.value;e.push({comment:n,id:o[t].id})}),ss.rpc("game.player.resumeFeedback",e)}function z(){if(j){j=!1,B=setTimeout(function(){j=!0},200);var e=Math.floor(Math.random()*$game.VIEWPORT_WIDTH),t=Math.floor(Math.random()*$game.VIEWPORT_HEIGHT);u.x=e,u.y=t,u.revealed=!1,y++,V(),a[e][t].charger=0,a[e][t].item=-1}}function W(){a=[$game.VIEWPORT_WIDTH];var e=$game.VIEWPORT_WIDTH;while(--e>=0){a[e]=[$game.VIEWPORT_HEIGHT];var t=$game.VIEWPORT_HEIGHT;while(--t>=0){var n=nt();a[e][t]={item:n,itemRevealed:!1}}}}function X(){var e=$game.VIEWPORT_WIDTH;while(--e>=0){var t=$game.VIEWPORT_HEIGHT;while(--t>=0)a[e][t].itemRevealed=!1}}function V(){var e=$game.VIEWPORT_WIDTH;while(--e>=0){var t=$game.VIEWPORT_HEIGHT;while(--t>=0){var n=J({x:e,y:t});a[e][t].distance=n,a[e][t].charger=-1}}}function J(e){var t=Math.abs(e.x-u.x)+Math.abs(e.y-u.y);return t}function K(){$game.$renderer.clearBossLevel(),P=$game.$player.getTilesColored(),H=0,m.text(P),x=(new Date).getTime(),T=0,N="0.0",k=!1,L=0,C=90,A=1,w=20,y=0,u={},E=0,j=!0,z(),$(".bossHud .regularSeedButton .badge").text(w),setTimeout(Q,100),$game.$audio.switchTrack(7)}function Q(){T+=100,L+=100*A,N=C-Math.floor(L/1e3);var e=(new Date).getTime()-x-T;v.text(N),N<=0?Z():k||setTimeout(Q,100-e)}function G(){(!u.revealed||y<g)&&Z()}function Y(){P+=50,H+=50,m.text(P),X();var e='<div class="cutSceneBg"></div>';$(".gameboard").append(e);var t=D[y-1];$(".cutSceneBg").append(t),$(".cutSceneBg").fadeIn("fast"),$(".cutScene")[0].play(),A=0,$(".cutScene")[0].addEventListener("ended",function(){$(".cutScene")[0].removeEventListener("ended"),$(".cutSceneBg").fadeOut("fast",function(){var e="only "+(g-y+1)+" chargers left!";$game.statusUpdate({message:e,input:"status",screen:!0,log:!1}),A=1,$(".cutSceneBg").remove()}),y>=4&&H===200?(k=!0,s=4,q(),l.show()):z()})}function Z(){$(".bossHud .regularSeedButton").removeClass("hud-button-active"),$game.$player.seedMode=!1,$game.$player.resetRenderColor(),k=!0,s=3,q(),l.show()}function et(){f.on("click",".bossHud .regularSeedButton",function(){E===0&&w>0?($(this).addClass("hud-button-active"),E=1,$game.$player.seedMode=!0):E===1?($(this).removeClass("hud-button-active"),E=0,$game.$player.seedMode=!1,$game.$player.resetRenderColor()):E===2?w>0?($(this).addClass("hud-button-active"),$(".bossHud .drawSeedButton").removeClass("hud-button-active"),E=1):$game.statusUpdate({message:"you have no more seeds!",input:"status",screen:!0,log:!1}):$game.statusUpdate({message:"you have no more seeds!",input:"status",screen:!0,log:!1})}),f.on("click",".bossHud .drawSeedButton",function(){E===0?($(this).addClass("hud-button-active"),E=2,$game.$player.seedMode=!0):E===1?($(this).addClass("hud-button-active"),$(".bossHud .regularSeedButton").removeClass("hud-button-active"),E=2,$game.$player.seedMode=!1,$game.$player.resetRenderColor()):($(this).removeClass("hud-button-active"),E=0)})}function tt(e){var t=e.x-1,n=e.y-1,r=[],i=100;for(var s=0;s<3;s++)for(var o=0;o<3;o++){var u=t+s,f=n+o;if(u>=0&&u<$game.VIEWPORT_WIDTH&&f>=0&&f<$game.VIEWPORT_HEIGHT){var l=a[u][f].distance,c=a[u][f].item,h=a[u][f].charger;l<i&&(i=l),r.push({val:l,x:u,y:f,item:c,charger:h}),h===0&&rt(u,f),c>-1&&(a[u][f].itemRevealed=!0,c<2&&it({x:u,y:f,item:c}))}}for(var p=0;p<r.length;p++){var d=.8-(r[p].val-i)*.2+.1;r[p].color=S+d+")"}$game.$renderer.renderBossTiles(r)}function nt(){var e=Math.floor(Math.random()*200);return e<4?e:-1}function rt(e,t){a[e][t].charger=1,$game.statusUpdate({message:"you found a charger! Go to it to disable it.",input:"status",screen:!0,log:!1}),u.revealed=!0}function it(e){a[e.x][e.y].itemRevealed&&(a[e.x][e.y].item=-1,e.item===0?($game.statusUpdate({message:"uh oh...time warp!",input:"status",screen:!0,log:!1}),A=4,O=setTimeout(function(){A=1},5e3),setTimeout(function(){$game.$renderer.clearMapTile(e.x*$game.TILE_SIZE,e.y*$game.TILE_SIZE)},2e3)):e.item===1?($game.statusUpdate({message:"wipeout!",input:"status",screen:!0,log:!1}),setTimeout(function(){X(),$game.$renderer.clearBossLevel()},1e3),a[u.x][u.y].charger=0):e.item===2?($game.statusUpdate({message:"time freeze, nice!",input:"status",screen:!0,log:!1}),A=0,clearTimeout(O),O=setTimeout(function(){A=1},5e3),$game.$renderer.clearMapTile(e.x*$game.TILE_SIZE,e.y*$game.TILE_SIZE)):e.item===3&&($game.statusUpdate({message:"bonus seeds!",input:"status",screen:!0,log:!1}),w+=3,$(".bossHud .regularSeedButton .badge").text(w),$game.$renderer.clearMapTile(e.x*$game.TILE_SIZE,e.y*$game.TILE_SIZE)))}function st(e){function r(n){this.removeEventListener("canplaythrough",r),D.push(t),e+=1,e<_&&st(e)}var t=document.createElement("video"),n=e;CivicSeed.ENVIRONMENT==="development"?t.src=Modernizr.video.h264?M+e+".mp4":M+n+".webm?VERSION="+Math.round(Math.random(1)*1e9):t.src=Modernizr.video.h264?M+e+".mp4?VERSION="+CivicSeed.VERSION:M+n+".webm?VERSION="+CivicSeed.VERSION,t.load(),t.className="cutScene",t.addEventListener("canplaythrough",r),t.addEventListener("error",function(e){console.log("vid error")})}var s,o,u={},a,f,l,c,h,p,d,v,m,g=4,y,b,w,E=0,S,x,T,N,C,k,L,A,O,M=CivicSeed.CLOUD_PATH+"/audio/cutScenes/",_=4,D=[],P,H,B,j,F=$game.$boss={isShowing:!1,init:function(e){I(),W(),$(".regularGameHud").fadeOut("fast"),et(),l.show(),S="rgba(255,0,0,",s=0,q(),st(0),$("#background").addClass("labBackground"),typeof e=="function"&&e()},resetInit:function(){s=null,o=null,u={},a=null,y=null,b=null,w=null,E=0,S=null,x=null,T=null,N=null,C=null,k=null,L=null,A=null,O=null,D=[],P=null,H=null,$game.$boss.isShowing=!1},nextSlide:function(){s!==4&&(s++,s===2?$(".bossHud").show():s>2&&l.fadeOut("fast",function(){$game.$boss.isShowing=!1,K()}),q())},dropSeed:function(e){k||(E===1?(w--,$game.$audio.playTriggerFx("seedDrop"),$(".bossHud .regularSeedButton .badge").text(w),tt(e),w<=0&&(E=0,$game.$player.seedMode=!1,$game.$player.resetRenderColor(),$(".bossHud .regularSeedButton").removeClass("hud-button-active"),G())):E===2&&(b--,$(".bossHud .drawSeedButton .badge").text(b),b<=0&&(E=0,$game.$player.seedMode=!1,$game.$player.resetRenderColor())))},endMove:function(e,t){k||(a[e][t].charger===1?(Y(),$game.$renderer.clearBossLevel()):a[e][t].item>-1&&it({x:e,y:t,item:a[e][t].item}))}}});require.define("/botanist.js",function(e,t,n,r,i){"use strict";function D(){x=$(".botanistArea"),T=$(".inventoryItem"),N=$(".tangramArea"),C=$(".botanistContent textarea"),k=$(".inventory"),L=$(".inventory button"),A=$(".inventoryPuzzle"),O=$(".botanistContent"),M=$(".botanistArea .message")}var s=null,o=null,u=!1,a=null,f=0,l=0,c=0,h={},p=null,d=null,v=null,m=0,g=0,y=0,b={orange:"rgb(236,113,41)",lightOrange:"rgb(237,173,135)",blue:"rgb(14,152,212)",lightBlue:"rgb(109,195,233)",green:"rgb(76,212,206)",lightGreen:"rgb(164,238,235)"},w=5,E=["What motivates you to civically engage? Your answer will become a permanent part of your Civic Resume, so think carefully!","Please describe your past experience and skills in civic engagement. Your answer will become a permanent part of your Civic Resume, so think carefully!","What aspect of civic engagement interests you the most? What type of projects do you want to work on? Your answer will become a permanent part of your Civic Resume, so think carefully!","What outcomes do you hope to achieve for yourself through civic engagement? What are you hoping to learn, and where do you want your civic engagement to lead? Your answer will become a permanent part of your Civic Resume, so think carefully!"],S=!1,x=null,T=null,N=null,C=null,k=null,L=null,A=null,O=null,M=null,_=$game.$botanist={index:0,numSteps:64,counter:Math.floor(Math.random()*64),curFrame:0,numFrames:4,dialog:null,tangram:null,name:null,isChat:!1,isShowing:!1,isSolving:!1,ready:!1,_nudgePlayerInterval:null,_nudgePlayerTimeout:null,tutorialState:0,init:function(e){ss.rpc("game.npc.loadBotanist",function(t){$game.$botanist.index=t.id,$game.$botanist.dialog=t.dialog,$game.$botanist.name=t.name,$game.$botanist.tangram=t.tangram,s={x:t.x,y:t.y},o={kind:"botanist",srcX:0,srcY:0,curX:t.x,curY:t.y,prevX:t.x,prevY:t.y},D(),$game.$botanist.setupTangram(),$game.$botanist.getMaster(),$game.$botanist.setState($game.$player.botanistState),$game.$botanist.ready=!0,e()})},resetInit:function(){s=null,o=null,u=!1,a=null,f=0,l=0,c=0,h={},p=null,d=null,v=null,m=0,g=0,y=0,S=!1,x=null,T=null,N=null,C=null,k=null,L=null,A=null,O=null,M=null,$game.$botanist.index=0,$game.$botanist.counter=Math.floor(Math.random()*64),$game.$botanist.curFrame=0,$game.$botanist.dialog=null,$game.$botanist.tangram=null,$game.$botanist.name=null,$game.$botanist.isChat=!1,$game.$botanist.isShowing=!1,$game.$botanist.isSolving=!1,$game.$botanist.ready=!1,_._nudgePlayerInterval=null,_._nudgePlayerTimeout=null,_.tutorialState=0},clear:function(){$game.$renderer.clearBotanist(o)},getRenderInfo:function(){return u?o:!1},update:function(){$game.inTransit?$game.inTransit&&$game.$botanist.getMaster():u&&$game.$botanist.idle()},getState:function(){return $game.$player.botanistState},setState:function(e){$game.$player.botanistState=e,ss.rpc("game.player.updateGameInfo",{id:$game.$player.id,botanistState:e}),o.srcY=e===2?160:0},getMaster:function(){var e=$game.$map.masterToLocal(s.x,s.y);if(e){var t=e.x*$game.TILE_SIZE,n=e.y*$game.TILE_SIZE,r=e.x*$game.TILE_SIZE,i=e.y*$game.TILE_SIZE;o.prevX=t,o.prevY=n,o.curX=r,o.curY=i,u=!0}else u=!1},idle:function(){m+=1,o.srcY===0?m>=24?(m=0,o.srcX=0):m==18?o.srcX=192:m==12?o.srcX=384:m==6&&(o.srcX=576):o.srcX=0},show:function(){var e=$game.$player.currentLevel;clearInterval(_._nudgePlayerInterval),clearTimeout(_._nudgePlayerTimeout);var t=$game.$map.masterToLocal(71,74);$game.$player.beginMove(t.x,t.y);if(e>=4)return;switch($game.$player.botanistState){case 0:e===0?_.doTutorial(_.tutorialState):_.chat(_.dialog[e].instructions,null,function(){_.setState(1),_.show()});break;case 1:$game.$botanist.showPrompt(0);break;case 2:var n=$game.$player.getInventoryLength()>0?1:0;_.chat(_.dialog[e].hint[n]);break;case 3:$game.$botanist.showPrompt(1);break;case 4:$game.$botanist.showRiddle(2)}},nudgePlayer:function(){function e(){$game.alert("Talk to the botanist"),$game.$renderer.pingMinimap(70,71)}e(),_._nudgePlayerInterval=setInterval(e,16e3)},chat:function(e,t,n){$game.$npc.showSpeechBubble(_.name,e,t,n)},doTutorial:function(e){var t="";switch(e){case 0:t=_.dialog[0].instructions,_.chat(t,null,function(){$game.highlightUI(".seedButton"),$game.$player.setSeeds("regular",1),_.tutorialState=1});break;case 1:$game.$player.getSeedsDropped()<1?(t=["To plant a seed, click the leaf icon at the bottom of the screen, and then click the area where you wish to plant. Try and plant it, then talk to me again."],$game.highlightUI(".seedButton"),_.chat(t,null,function(){$game.alert("Plant a seed by clicking the seed icon")})):(t=[_.dialog[0].instructions2],S=!0,$game.$player.saveMapImage(!0),$game.highlightUI(".progressButton"),_.chat(t,null,function(){$game.alert("Look at the progress window"),_.nudgePlayer(),_.setState(1)}))}},showPrompt:function(e){var t=$game.$botanist.dialog[$game.$player.currentLevel].riddle.prompts[e];_.chat(t,function(){e===1&&($game.$botanist.isSolving=!0,$game.alert("drag a piece to the board to use it"),x.addClass("puzzle-mode")),$game.$botanist.showRiddle(e)})},inventoryShowRiddle:function(){$game.$botanist.isShowing||(k.slideUp(),$game.$botanist.isChat=!0,$game.$botanist.showRiddle(0))},showRiddle:function(e){c=e,l=0,e===1?$game.$botanist.isChat=!0:e===2&&(l=2),$game.$botanist.addContent(),$game.$botanist.addButtons(),$game.$npc.hideSpeechBubble(function(){x.fadeIn(function(){$game.$botanist.isShowing=!0,l===0&&!$game.$player.firstTime&&N.show()})})},addButtons:function(){$(".botanistArea button").hide(),c===0?l===0?$game.$player.firstTime?$(".botanistArea .nextButton").show():$(".botanistArea .closeButton").show():$(".botanistArea .closeButton").show():l===0?($(".botanistArea .answerButton").show(),$(".botanistArea .clearBoardButton").show()):l===1?$(".botanistArea .nextButton").show():$(".botanistArea .answerButton").show()},nextSlide:function(){l+=1,$game.$botanist.addContent(),$game.$botanist.addButtons()},previousSlide:function(){l-=1,$game.$botanist.addContent(),$game.$botanist.addButtons()},addContent:function(){$(".botanistArea .speaker").text($game.$botanist.name);if(c===0){if(l===0){O.empty(),_.getState()>1?M.text("Here is the notebook page to view again."):(M.text("Here is the page. You will be able to view it at any time in your inventory."),$game.$player.tangramToInventory(),_.setState(2));var e=CivicSeed.CLOUD_PATH+"/img/game/tangram/puzzle"+$game.$player.currentLevel+".png";$(".tangramOutline").html('<img src="'+e+'">'),$(".tangramArea").show()}else if($game.$player.currentLevel===0){$game.$player.firstTime=!1;var t={id:$game.$player.id,firstTime:$game.$player.firstTime};ss.rpc("game.player.updateGameInfo",t),$game.$player.tangramToInventory(),_.setState(2),$game.$player.checkBotanistState(),$(".tangramArea").hide(),M.text("The pieces you need to complete this puzzle lie in Brightwood Forest, located in the northwest."),O.html('<p class="miniExample" ><img src="/img/game/minimap.png"></p><p>Go out and talk to the people you see. When you think you have all the pieces, come back to the center of the map and talk to me. Good luck!</p>')}}else if(l===0){L.hide(),k.slideDown(function(){$game.$player.inventoryShowing=!1,T.attr("draggable","true")}),M.text("OK. Take the pieces you have gathered and drop them into the outline to create your seeds.");var n=CivicSeed.CLOUD_PATH+"/img/game/tangram/puzzle"+$game.$player.currentLevel+".png",r=CivicSeed.CLOUD_PATH+"/img/game/trash.png",i='<img src="'+n+'"><img src="'+r+'" class="trash">';$(".tangramOutline").html(i),$(".inventoryPuzzle").hide(),$(".inventoryHelp").show()}else if(l===1){x.animate({height:"450px"}),k.slideUp(function(){$game.$player.inventoryShowing=!1,L.show(),T.remove()});var s=$game.$botanist.dialog[$game.$player.currentLevel].riddle.response;M.text(s);var o="<p>You earned a promotion to "+$game.playerRanks[$game.$player.currentLevel+1]+"!</p>",u=CivicSeed.CLOUD_PATH+"/img/game/seed_chips.png";o+='<div class="seedChips"><img src="'+u+'"></div>',O.html(o)}else{var a=E[$game.$player.currentLevel];M.text(a);var f='<textarea placeholder="Type your answer here..." maxlength="5000" autofocus></textarea>';O.html(f)}},showTangram:function(){},hideResource:function(){$game.$player.firstTime&&$game.$player.botanistState===2&&($game.statusUpdate({message:"Level 1: Looking Inward.  See the log below for more details.",input:"status",screen:!0,log:!1}),$game.statusUpdate({message:"Level 1 is about understanding one's own motivations, goals, social identities, ethics and values in the context of a larger society.  Before beginning work in the community, it is important to look within, and reflect on where you are coming from in order to move forward. The more you understand yourself, the better equipped you will be to becoming an aware and effective active citizen.",input:"status",screen:!1,log:!0})),N.hide(),x.fadeOut(function(){$game.$botanist.isShowing=!1,$(".botanist button").hide(),$(this).removeClass("puzzle-mode"),$game.$botanist.isChat=!1,$game.$botanist.isSolving=!1,$game.$botanist.clearBoard(),$(".inventoryItem").css("opacity",1),$game.$player.botanistState===0&&$game.$player.currentLevel<4&&($game.highlightUI(".progressButton"),$game.showProgress())}),$game.$player.inventoryShowing?k.slideDown(function(){$game.$player.inventoryShowing=!0}):k.slideUp(function(){$game.$player.inventoryShowing=!1,L.show(),$(".inventoryPuzzle").show(),$(".inventoryHelp").hide()})},submitAnswer:function(){if(l===0){var e=$(".puzzleSvg > path"),t=!0,n=0,r=$game.$botanist.tangram[$game.$player.currentLevel].answer.length,i="",s=!1,o=!1;e.each(function(e,i){var u=$(this).attr("class"),a=u.substring(2,u.length),f=$(this).attr("transform"),l=f.substring(10,f.length-1),c=l.split(","),h=parseInt(c[0],10),p=parseInt(c[1],10),d=r,v=!1,m=!1;while(--d>-1){var g=$game.$botanist.tangram[$game.$player.currentLevel].answer[d];g.id===a&&(v=!0,h===g.x&&p===g.y?(n+=1,m=!0):m=!1)}v?v&&!m&&(o=!0,t=!1,$(".br"+a).remove(),$(".r"+a).css("opacity",1).attr("draggable","true")):(s=!0,t=!1,$(".br"+a).remove(),$(".r"+a).css("opacity",1).attr("draggable","true"))}),e.length===0?(t=!1,w-=1,i="At least TRY to solve it!"):s?(t=!1,w-=1,i="Oh! Thats not quite right. Think more about how the pieces relate to one another, and try again."):e.length<r?(t=!1,w-=1,i="You are missing some pieces. Be sure to read the notebook clues carefully to help pick out the right pieces."):o&&(t=!1,w-=1,i="So close! You had the right pieces, just fix the placement.");if(t){if(n===r){l=1,$game.$botanist.addContent(),$game.$botanist.addButtons(),$(".puzzleSvg").empty(),N.hide(),$game.$player.emptyInventory();var u=w<0?0:w,a=$game.$player.currentLevel+1,f=30+a*4+a*4*u;$game.$player.addSeeds("draw",f),_.setState(4)}}else $game.$botanist.clearBoard(),$game.$botanist.feedback(i)}else{w=5;var c=$.trim($(".botanistContent textarea").val());c.length===0?this.feedback("Please answer the question!"):($game.$player.resumeAnswer(c),$game.$player.nextLevel(),$game.$botanist.hideResource())}},setupTangram:function(){p=d3.select(".tangramArea").append("svg").attr("class","puzzleSvg"),d=d3.behavior.drag().origin(Object).on("drag",$game.$botanist.dragMove).on("dragstart",$game.$botanist.dragMoveStart).on("dragend",$game.$botanist.dropMove)},dragStart:function(e){if($game.$botanist.isSolving){N.unbind("dragover").unbind("drop");var t=e.data,n=e.originalEvent.dataTransfer;n.setData("text/plain",t.npc),$(".tangramArea").bind("dragover",$game.$botanist.dragOver).bind("drop",$game.$botanist.drop)}},dragEnd:function(e){e.preventDefault()},dragOver:function(e){return e.preventDefault&&e.preventDefault(),!1},drop:function(e){e.preventDefault(),e.stopPropagation&&e.stopPropagation();var t=e.originalEvent.dataTransfer.getData("text/plain"),n=t.split(","),r=n[0],i=n[1],s="br"+i,o=e.originalEvent.layerX,u=e.originalEvent.layerY,a=$game.$resources.getShape(r),f=a.path,l=b[a.fill];return $(".r"+i).css("opacity",".4").attr("draggable","false"),v=p.append("path").attr("class",s).data([{x:o,y:u,id:i,color:l}]).attr("d",a.path).attr("fill",l).attr("stroke","rgb(255,255,255)").attr("stroke-width",0).attr("transform","translate("+o+","+u+")").call(d),N.unbind("dragover").unbind("drop"),e.originalEvent.dataTransfer.clearData(),!1},dragMoveStart:function(e){_.hideFeedback(),g=d3.mouse(this)[0],y=d3.mouse(this)[1],d3.select(".br"+e.id).attr("stroke-width",3)},dragMove:function(e){var t=d3.event.sourceEvent.layerX,n=d3.event.sourceEvent.layerY,r=t-g,i=n-y,s=!1;t>825&&t<890&&n>170&&n<300?($(".trash").addClass("active"),s=!0):($(".trash").removeClass("active"),s=!1);var o="translate("+r+", "+i+")";d3.select(".br"+e.id).attr("transform",o).attr("opacity",function(){return s?.5:1})},dropMove:function(e){var t=d3.event.sourceEvent.layerX,n=d3.event.sourceEvent.layerY,r=$game.$botanist.snapTo(t-g),i=$game.$botanist.snapTo(n-y),s="translate("+r+", "+i+")";d3.select(".br"+e.id).attr("stroke-width",0).attr("transform",s),t>825&&t<890&&n>170&&n<300?($(".br"+e.id).remove(),$(".r"+e.id).css("opacity",1).attr("draggable","true"),$(".trash").removeClass("active")):d3.select(".br"+e.id).attr("stroke-width",0).attr("transform",s)},clearBoard:function(){$(".puzzleSvg").empty(),$(".inventoryItem").css("opacity",1).attr("draggable","true")},snapTo:function(e){var t=e,n=10,r=n/2,i=e%n-r;return i>-1?t+=r-i:t+=-r-i,t},feedback:function(e){var t=$(".botanistArea .check");t.find(".feedback").text(e),t.find("button").bind("click",_.hideFeedback).show(),t.fadeIn(200)},hideFeedback:function(){var e=$(".botanistArea .check");e.is(":visible")&&e.fadeOut(200)},getLevelQuestion:function(e){return E[e]},disable:function(){u=!1}}});require.define("/chat.js",function(e,t,n,r,i){function f(e,t){var n=e/2,r=null,i=null,s=null,o=0;t?s=t.position:s=$game.$player.getRenderPosition();if(s.x>470){var u=940-s.x;n>u?r=s.x-n-(n-u):r=s.x-n+16}else n>s.x?r=s.x-n+(n-s.x)+10:r=s.x-n+16;s.y<=1*$game.TILE_SIZE?i=$game.TILE_SIZE-o:i=s.y-($game.TILE_SIZE*2+o),t?$(t.chatIdSelector).css({top:i,left:r,width:e}):$(a).css({top:i,left:r,width:e})}var s=!1,o=null,u=null,a=null;$game.$chat={init:function(e){u="player"+$game.$player.id,a="#"+u,$gameboard=$(".gameboard"),e()},resetInit:function(){s=!1,o=null,u=null,a=null},message:function(e){var t=e.message,n=!1;e.name!==$game.$player.firstName&&(n=e);var r=t.length+4,i=r*150+1e3,l=Math.floor(r*8)+20;i=i>11500?11500:i;if(!!n)return r=t.length+n.name.length+2,l=Math.floor(r*8)+20,n.isChatting?$(n.chatIdSelector).text(n.name+": "+t):$(".gameboard").append("<p class='playerChat' id="+n.chatId+">"+n.name+": "+t+"</p>"),$game.$audio.playTriggerFx("chatReceive"),f(l,n),i;s?(clearTimeout(o),$(a).text("me: "+t)):$gameboard.append("<p class='playerChat' id="+u+">me: "+t+"</p>"),o=setTimeout($game.$chat.hideChat,i),f(l),s=!0,$game.$log.addMessage(e)},hideChat:function(e){clearTimeout(o),$(a).fadeOut("fast",function(){$(this).remove(),s=!1})}}});require.define("/events.js",function(e,t,n,r,i){"use strict";var s=$game.$events=t.exports={registerVariables:function(){},init:function(){ss.event.on("ss-addPlayer",function(e,t){$game.$others.add(e.info),e.info._id!==$game.$player.id&&$game.statusUpdate({message:e.info.firstName+" has joined!",input:"status",screen:!0,log:!0})}),ss.event.on("ss-removePlayer",function(e,t){e.id!=$game.$player.id&&$game.$others.remove(e.id)}),ss.event.on("ss-playerMoved",function(e,t){e.id!=$game.$player.id&&$game.$others.sendMoveInfo(e.moves,e.id)}),ss.event.on("ss-seedDropped",function(e,t){$game.$map.newBomb(e.bombed,e.id),$game.$player.id!==e.id&&$game.$others.updateTilesColored(e.id,e.tilesColored)}),ss.event.on("ss-newMessage",function(e,t){e.input="chat",$game.$player.firstName===e.name?$game.$chat.message(e):$game.$others.message(e)}),ss.event.on("ss-statusUpdate",function(e,t){}),ss.event.on("ss-progressChange",function(e,t){$game.updatePercent(e.dropped)}),ss.event.on("ss-leaderChange",function(e,t){$game.updateLeaderboard(e)}),ss.event.on("ss-addAnswer",function(e,t){$game.$resources.addAnswer(e)}),ss.event.on("ss-removeAnswer",function(e,t){$game.$resources.removeAnswer(e)}),ss.event.on("ss-levelChange",function(e,t){$game.$others.levelChange(e.id,e.level)}),ss.event.on("ss-seedPledged",function(e,t){$game.$player.id===e.id&&($game.statusUpdate({message:e.pledger+" liked a response of yours. Here, have some seeds.",input:"status",screen:!0,log:!0}),$game.$player.addSeeds("regular",3),$game.$player.updateResource(e))}),ss.event.on("ss-bossModeUnlocked",function(){$game.bossModeUnlocked=!0,$game.$player.currentLevel>3&&$game.toBossLevel()}),ss.event.on("ss-beam",function(e){e.id!==$game.$player.id&&$game.$others.beam(e)}),ss.event.on("ss-collaborativeChallenge",function(e){for(var t=0;t<e.players.length;t++)if(e.players[t]===$game.$player.id){$game.statusUpdate({message:"Nice work you did a collaborative challenge! Have "+e.seeds+" paintbrush seeds.",input:"status",screen:!0,log:!0}),$game.$player.addSeeds("draw",e.seeds);break}}),ss.event.on("ss-skinSuitChange",function(e){e.id!==$game.$player.id&&$game.$others.skinSuitChange(e)})}}});require.define("/game.js",function(e,t,n,r,i){function L(){k.$player.init(function(){A()})}function A(){ss.rpc("game.player.getGameInfo",function(e){k.bossModeUnlocked=e.bossModeUnlocked,k.resourceCount=e.resourceCount,u={seedsDropped:e.seedsDropped,seedsDroppedGoal:e.seedsDroppedGoal,leaderboard:e.leaderboard,percent:Math.floor(e.seedsDropped/e.seedsDroppedGoal*100),prevPercent:Math.floor(e.seedsDropped/e.seedsDroppedGoal*100)},k.$player.setPositionInfo(),k.$renderer.init(function(){O()})})}function O(){k.$map.init(function(){q(),M()})}function M(){k.$others.init(function(){_()})}function _(){k.$npc.init(function(){D()})}function D(){k.$resources.init(function(){P()})}function P(){k.$botanist.init(function(){H()})}function H(){k.$robot.init(function(){B()})}function B(){k.$audio.init(function(){j()})}function j(){k.$chat.init(function(){F()})}function F(){k.$log.init(function(){I()})}function I(){k.$player.currentLevel<4&&(k.$player.fillInventory(),k.$player.createInventoryOutlines());var e=k.$player.getColorMap();e!==undefined&&k.$renderer.imageToCanvas(e),k.$map.createCollectiveImage(),ss.rpc("game.chat.init"),R()}function q(){var e=k.$player.getPosition(),t=e.x===0?0:e.x-1,n=e.y===0?0:e.y-1,r=Math.floor(t/(k.VIEWPORT_WIDTH-2)),i=Math.floor(n/(k.VIEWPORT_HEIGHT-2)),s=r*(k.VIEWPORT_WIDTH-2),o=i*(k.VIEWPORT_HEIGHT-2);k.masterX=s,k.masterY=o,k.$map.setBoundaries()}function R(e){k.bossModeUnlocked&&k.$player.currentLevel>3&&k.$boss.init(function(){}),k.$map.firstStart(function(){e||$(".loading").fadeOut(function(){$(this).remove(),k.ready=!0,k.running=!0,k.$renderer.renderAllTiles(),k.tick(),k.$player.displayNpcComments(),k.$player.firstTime?(k.alert("Welcome to Civic Seed!"),k.$botanist._nudgePlayerTimeout=window.setTimeout(function(){k.alert("Talk to the botanist")},4e3)):k.$player.botanistState===0&&k.$botanist.nudgePlayer()})})}var s=0;window.requestAnimationFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){var n=(new Date).getTime(),r=Math.max(0,16-(n-s)),i=window.setTimeout(function(){e(n+r)},r);return s=n+r,i}}();var o=0,u=null,a=["fuck","shit","bitch","cunt","damn","penis","vagina","crap","screw","suck","piss","whore","slut"],f=["Level 1: Looking Inward","Level 2: Expanding Outward","Level 3: Working Together","Level 4: Looking Forward","Game Over: Profile Unlocked"],l=null,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k=t.exports={VIEWPORT_WIDTH:30,VIEWPORT_HEIGHT:15,TOTAL_WIDTH:142,TOTAL_HEIGHT:132,TILE_SIZE:32,STEP_PIXELS:4,PIXEL_RATIO:1,currentTiles:[],inTransit:!1,running:!1,ready:!1,showingProgress:!1,showingSkinventory:!1,resourceCount:[],graph:null,masterX:null,masterY:null,playerRanks:["Novice Gardener","Apprentice Gardener","Expert Gardener","Master Gardener","Super Master Gardener"],bossModeUnlocked:null,world:{origin:{shortname:"botanists garden",name:"the Botanists Garden"},northwest:{shortname:"forest",name:"Brightwood Forest"},northeast:{shortname:"town",name:"Calliope Town"},southeast:{shortname:"ranch",name:"The Ranch"},southwest:{shortname:"port",name:"the Port District"},nowhere:{shortname:"equator",name:"No Mans Land"}},startNewAction:!0,instantiated:!1,init:function(t){c=e("/map"),$render=e("/render"),p=e("/npc"),d=e("/resources"),$skins=e("/skins"),v=e("/player"),m=e("/others"),g=e("/robot"),y=e("/botanist"),b=e("/mouse"),w=e("/audio"),E=e("/pathfinder"),S=e("/events"),x=e("/input"),T=e("/chat"),N=e("/log"),C=e("/boss"),S.init(),x.init(),$WINDOW.on("beforeunload",function(){if(sessionStorage.isPlaying==="true"){var e=k.exitGame();return e}}),k.instantiated=!0},reInit:function(){k.resetInit(),k.$map.resetInit(),k.$renderer.resetInit(),k.$npc.resetInit(),k.$resources.resetInit(),k.$skins.resetInit(),k.$player.resetInit(),k.$others.resetInit(),k.$robot.resetInit(),k.$botanist.resetInit(),k.$mouse.resetInit(),k.$audio.resetInit(),k.$input.resetInit(),k.$chat.resetInit(),k.$log.resetInit(),k.$boss.resetInit()},resetInit:function(){s=0,o=0,u=null,l=null,k.currentTiles=[],k.inTransit=!1,k.running=!1,k.ready=!1,k.showingProgress=!1,k.showingSkinventory=!1,k.resourceCount=[],k.graph=null,k.masterX=null,k.masterY=null,k.bossModeUnlocked=null,k.startNewAction=!0},enterGame:function(e){ss.rpc("shared.account.checkGameSession",function(e){k.instantiated?k.reInit():k.init(),e.status?(sessionStorage.setItem("isPlaying",!0),k.kickOffGame()):(e.profileLink&&Davis.location.assign("/profiles/"+e.profileLink),apprise('There seems to have been an error accessing the game.<br><br><span style="display:block;font-size:11px;text-align:center;">(If you think there is a problem, please contact the website administrator.)</span>'))})},kickOffGame:function(){$CONTAINER.append(JT["game-gameboard"]()),$CONTAINER.append(JT["game-resourceStage"]()),$CONTAINER.append(JT["game-hud"]()),S.registerVariables(),x.registerVariables(),L()},pause:function(){$(".pauseMenu").fadeIn(),k.running=!1},resume:function(){$(".pauseMenu").slideUp(function(){k.running=!0,k.tick()})},beginTransition:function(){k.inTransit=!0,o=0,k.$chat.hideChat(),k.$others.hideAllChats(),$(".npc-bubble").remove(),k.stepTransition()},stepTransition:function(){o!==k.$map.numberOfSteps?(o+=1,k.$map.transitionMap(o)):k.endTransition()},endTransition:function(){k.inTransit=!1,k.$player.isMoving=!1,k.$player.resetRenderValues(),k.$others.resetRenderValues(),k.$map.createPathGrid(function(){k.$map.stepDirection=null}),k.$player.displayNpcComments(),k.$player.saveTimeToDB()},tick:function(){if(k.running){if(k.$player.currentLevel<4||!k.bossModeUnlocked&&k.$player.currentLevel>3)k.$others.update(),k.$npc.update(),k.$botanist.update(),k.$robot.update();k.$player.update(),k.$renderer.renderFrame(),requestAnimationFrame(k.tick)}},showProgress:function(){var e=k.$map.saveImage();k.$map.createCollectiveImage();var t=k.$player.getTilesColored(),n=k.$player.getResourcesDiscovered();$(".levelImages img").removeClass("currentLevelImage"),$(".levelImages img:nth-child("+(k.$player.currentLevel+1)+")").addClass("currentLevelImage"),$(".personalInfo .currentLevel").text(k.playerRanks[k.$player.currentLevel]),$(".colorMapYou img").attr("src",e).attr("width","426px");var r=k.$player.getPlayingTime(),i=Math.floor(r/3600),s=r%3600,o=Math.floor(s/60),a=r%60,f=i+"h "+o+"m "+a+"s",l=k.$player.currentLevel+1,c="<p>top seeders:</p><ol>";for(var h=0;h<u.leaderboard.length;h++)c+="<li>"+u.leaderboard[h].name+" &mdash; "+u.leaderboard[h].count+"</li>";c+="</ol>",c+='<p class="yourSeeds">You ('+t+")</p>";var p=k.$player.compileAnswers(),d=u.percent+"%",v=k.$player.getResourcesDiscovered();$(".displayPercent .progress .bar").css("width",d),p&&$(".displayMyAnswers").empty().append(p),$(".displayTime").html('<i class="fa fa-clock-o fa-lg"></i> '+f),$(".topSeeders").empty().append(c),$(".numCollected").text(v+" / 42")},statusUpdate:function(e){var t=$(".status-update");if(e.screen){t.find("span").text(e.message),t.fadeIn(100),clearTimeout(l);var n=e.message.length,r=n*100+500;l=setTimeout(function(){t.fadeOut(150)},r)}e.log&&k.$log.addMessage(e)},alert:function(e){k.statusUpdate({message:e,input:"status",screen:!0,log:!1})},log:function(e){k.statusUpdate({message:e,input:"status",screen:!1,log:!0})},broadcast:function(e){k.statusUpdate({message:e,input:"status",screen:!0,log:!0})},debug:function(e){console.error("CIVIC SEED DEBUG MESSAGE: "+e)},highlightUI:function(e){$(".hud .hud-button").removeClass("hud-button-highlight"),$(e).addClass("hud-button-highlight")},unhighlightUI:function(e){$(e).removeClass("hud-button-highlight")},getBadgeCount:function(e){return window.parseInt($(e).find(".badge").text())||0},setBadgeCount:function(e,t){var n=$(e).find(".badge");n.text(t),t>0||n.hasClass("always-show")?n.show():t<=0&&!n.hasClass("always-show")&&n.hide()},addBadgeCount:function(e,t){var n=this.getBadgeCount(e)+t;this.setBadgeCount(e,n)},checkPotty:function(e){var t=e.toLowerCase();for(var n=0;n<a.length;n++)if(t.indexOf(a[n])>-1)return"I have a potty mouth and I am sorry for cussing.";return e},updateLeaderboard:function(e){var t=!0;u.leaderboard.length>0&&(t=u.leaderboard[0].name===e.board[0].name?!1:!0),t&&k.statusUpdate({message:e.board[0].name+" is top seeder!",input:"status",screen:!0,log:!0}),u.leaderboard=e.board},updatePercent:function(e){u.prevPercent=u.percent,u.seedsDropped=e,u.percent=Math.floor(u.seedsDropped/u.seedsDroppedGoal*100),u.percent>99&&!k.bossModeUnlocked&&k.statusUpdate({message:"The meter is full! The color has been restored.",input:"status",screen:!0,log:!0}),u.prevPercent!=u.percent&&(u.prevPercent=u.percent,u.percent%5===0)},exitGame:function(e){sessionStorage.removeItem("isPlaying"),k.running=!1,k.$audio.stopAll(),k.bossModeUnlocked||k.$player.saveTimeToDB(),k.$map.removePlayer(k.$player.id),ss.rpc("game.player.exitPlayer",k.$player.id,k.$player.firstName,function(){typeof e=="function"&&e()})},toBossLevel:function(){k.$audio.pauseTrack(),k.$renderer.clearMap(),k.$player.setPositionInfo(),k.$botanist.disable(),k.$robot.disable(),k.$others.disable(),q(),R(!0)}}});require.define("/input.js",function(e,t,n,r,i){"use strict";var s,o,u,a,f,l=$game.$input=t.exports={registerVariables:function(){s=$("#chatText"),o=$(".chatBox"),u=$(".inventory"),a=$(".progressArea"),f=!1},init:function(){$BODY.on("mousemove",".gameboard",function(e){if(!$game.inTransit&&$game.running){var t={x:e.pageX,y:e.pageY,offX:this.offsetLeft,offY:this.offsetTop,debug:!1};$game.$mouse.updateMouse(t,!1)}}),$BODY.on("click",".gameboard",function(t){var n=e();if(n){var r={x:t.pageX,y:t.pageY,offX:this.offsetLeft,offY:this.offsetTop,debug:!0};$game.$mouse.updateMouse(r,!0)}}),$BODY.on("click",".skinventoryButton",function(){l.toggleSkinventory()}),$BODY.on("click",".progressButton",function(){l.toggleProgress()}),$BODY.on("click",".progressArea a i",function(e){return e.preventDefault(),l.closeProgress(),!1}),$BODY.on("click",".helpButton",function(){l.toggleHelp()}),$BODY.on("click",".helpArea a i",function(e){return e.preventDefault(),l.closeHelp(),!1}),$BODY.on("click",".inventoryButton, .inventory button",function(){var t=e();return(t||$game.$player.inventoryShowing)&&l.toggleInventory(),!1}),$BODY.on("click",".seedButton",function(){var t=e();t&&l.toggleSeedMode()}),$BODY.on("click",".regularButton",function(){$(".drawButton").removeClass("selected"),$(".regularButton").addClass("selected"),$game.$player.startSeeding("regular")}),$BODY.on("click",".drawButton",function(){$(".regularButton").removeClass("selected"),$(".drawButton").addClass("selected"),$game.$player.startSeeding("draw"),$BODY.on("mousedown touchstart",".gameboard",function(){$game.$player.drawFirstSeed(),$game.$mouse.drawMode=!0}),$BODY.on("mouseup touchend",".gameboard",function(){$game.$mouse.drawMode=!1})}),$BODY.on("click",".collectedButton",function(){$(".collectedResources").show()}),$BODY.on("click",".collectedResources .backToProgress",function(){$(".collectedResources").hide()}),$BODY.on("click","#resource-area a.close-overlay",function(e){return e.preventDefault(),$game.$resources.hideResource(),!1}),$BODY.on("click",".skinventory .outer",function(){if(!$(this).hasClass("locked")){var e=$(this).parent().data("part"),t=$(this).data("name");$(this).parent().children().removeClass("equipped"),$(this).addClass("equipped"),$game.$player.setSkinSuit(t,e)}}),$BODY.on("click",".skinventory .closeButton",function(e){return e.preventDefault(),l.closeSkinventory(),!1}),$BODY.on("click","#speech-bubble, .inventory",function(e){e.stopImmediatePropagation()}),$BODY.on("mouseenter",".scrollable, .content-box",function(){$(this).scroll(function(){$("body").css("overflow","hidden")})}),$BODY.on("mouseleave",".scrollable, .content-box",function(){$("body").css("overflow","auto")}),$BODY.on("click","#chatButton",function(e){e.preventDefault();var t=s.val(),n={msg:$game.checkPotty(t),name:$game.$player.firstName,id:$game.$player.id,log:t,instanceName:$game.$player.instanceName};return $game.$audio.playTriggerFx("chatSend"),c.trigger(n.msg)===!1&&c.cheat(n.msg)===!1&&ss.rpc("game.chat.sendMessage",n,function(e){}),s.val(""),!1}),$BODY.on("click",".hud-log-button",function(){l.toggleGameLog()}),$BODY.on("click","#game-log",function(){$game.$log.clearUnread()}),$BODY.on("click",".botanistArea a i, .botanistArea .closeButton",function(e){return e.preventDefault(),$game.$botanist.hideResource(),!1}),$BODY.on("click",".botanistArea .nextButton",function(e){$game.$botanist.nextSlide()}),$BODY.on("click",".botanistArea .backButton",function(e){$game.$botanist.previousSlide()}),$BODY.on("click",".botanistArea .answerButton",function(e){return e.preventDefault(),$game.$botanist.submitAnswer(),!1}),$BODY.on("click",".botanistArea .clearBoardButton",function(e){return e.preventDefault(),$game.$botanist.clearBoard(),!1}),$BODY.on("click",".muteButton",function(){l.toggleMute()}),$BODY.on("mouseenter",".hud-button a",function(){var e=$(this).attr("title");$(this).tooltip("show")}),$BODY.on("click",".public-button button",function(){$game.$player.makePublic($(this).attr("data-npc")),$(this).parent().removeClass("public-button").addClass("private-button"),$(this).parent().find("i").removeClass("fa-lock").addClass("fa-unlock-alt"),$(this).text("Make Private")}),$BODY.on("click",".private-button button",function(){$game.$player.makePrivate($(this).attr("data-npc")),$(this).parent().removeClass("private-button").addClass("public-button"),$(this).parent().find("i").removeClass("fa-unlock-alt").addClass("fa-lock"),$(this).text("Make Public")}),$BODY.on("click",".pledge-button button",function(){var e={id:$(this).attr("data-player"),pledger:$game.$player.firstName,npc:$(this).attr("data-npc")},t=$game.$player.getPledges();t>0?ss.rpc("game.player.pledgeSeed",e,function(e){$game.$player.updatePledges(-1),$game.$resources.showCheckMessage("Thanks! (they will say). You can seed "+(t-1)+" more answers this level."),$game.$player.checkFlag("pledge-reward")&&($game.$player.addSeeds("draw",10),c.outfitLog("You gained 10 paintbrush seeds for seeding another players response."))}):$game.$resources.showCheckMessage("You cannot seed any more answers this level.")}),$BODY.on("click",".bossArea .bossButton",function(){$game.$boss.nextSlide()}),$BODY.on("click",".tabbable li a",function(e){return e.preventDefault(),!1}),$BODY.on("click",".hud-button-highlight",function(){$game.unhighlightUI(this)});var e=function(){return!$game.inTransit&&!$game.$player.isMoving&&!$game.$resources.isShowing&&!$game.showingProgress&&!$game.$player.seedventoryShowing&&$game.running&&!$game.$botanist.isChat&&!f&&!$game.$boss.isShowing&&!$game.showingSkinventory?!0:!1},t=function(){return $("input, textarea").is(":focus")?!1:!0};$BODY.keydown(function(n){n.which===27&&(l.closeInventory(),l.closeProgress(),l.closeHelp(),l.endSeedMode(),s.is(":focus")&&s.blur());if(!e())return;if(!t())return;if(n.ctrlKey===!0||n.metaKey===!0||n.altKey===!0)return;switch(n.which){case 87:case 38:case 104:case 56:n.preventDefault(),l.moveUp();break;case 65:case 37:case 100:case 52:n.preventDefault(),l.moveLeft();break;case 83:case 40:case 98:case 50:n.preventDefault(),l.moveDown();break;case 68:case 39:case 102:case 54:n.preventDefault(),l.moveRight();break;case 84:case 13:n.preventDefault(),l.focusChatInput();break;case 73:l.toggleInventory();break;case 69:l.toggleSeedMode();break;case 77:l.toggleMinimap();break;case 67:l.toggleSkinventory();break;case 76:l.toggleGameLog();break;case 80:l.toggleProgress();break;case 86:l.toggleMute();break;case 72:case 191:l.toggleHelp();break;default:}})},moveUp:function(){$game.$player.moveUp()},moveDown:function(){$game.$player.moveDown()},moveLeft:function(){$game.$player.moveLeft()},moveRight:function(){$game.$player.moveRight()},focusChatInput:function(){s.focus()},toggleMinimap:function(){$("#minimapPlayer").toggleClass("hide")},toggleSeedMode:function(){$game.$player.seedMode!==!1?l.endSeedMode():l.startSeedMode()},startSeedMode:function(){$game.$player.seedMode=!0,$(".hud .seedButton").addClass("hud-button-active"),l.openSeedventory()},endSeedMode:function(){$game.$player.seedMode=!1,$game.$player.seedventoryShowing&&l.closeSeedventory(),$BODY.off("mousedown touchend",".gameboard"),$BODY.off("mouseup touchend",".gameboard"),$(".graffiti").hide(),$game.$mouse.drawMode=!1,$game.$player.seedPlanting=!1,$game.$player.resetRenderColor(),$(".hud .seedButton").removeClass("hud-button-active"),$game.$player.saveMapImage(),$game.$player.saveSeeds()},openSeedventory:function(){$game.$player.openSeedventory()},closeSeedventory:function(){$(".seedventory").slideUp(function(){$game.$player.seedventoryShowing=!1})},toggleInventory:function(){$game.$player.inventoryShowing?l.closeInventory():l.openInventory()},openInventory:function(e){$game.$player.inventoryShowing=!0,$(".inventoryButton").addClass("hud-button-active"),$game.$player.getInventoryLength()>0&&$game.alert("click items to view again"),u.slideDown(300,e)},closeInventory:function(e){u.slideUp(300,function(){$game.$player.inventoryShowing=!1,$(".inventoryButton").removeClass("hud-button-active"),typeof e=="function"&&e()})},toggleSkinventory:function(){$game.showingSkinventory=!$game.showingSkinventory,$(".skinventoryButton").toggleClass("hud-button-active"),$(".skinventory").toggle(),$game.showingSkinventory===!0&&$game.setBadgeCount(".skinventoryButton",0)},closeSkinventory:function(){$game.showingSkinventory=!1,$(".skinventoryButton").removeClass("hud-button-active"),$(".skinventory").hide()},toggleGameLog:function(){$game.$log.clearUnread();if(!$("#game-log").is(":visible")){$("#game-log-overlay").hide();var e=$(window).height();$("html, body").stop().animate({scrollTop:e},250),$("#game-log").show()}else $("#game-log").hide(),$("#game-log-overlay").fadeIn(200)},toggleProgress:function(){$game.showingProgress=!$game.showingProgress,$game.showingProgress&&$game.showProgress(),$(".progressButton").toggleClass("hud-button-active"),a.toggle()},closeProgress:function(){$game.showingProgress=!1,$(".progressButton").removeClass("hud-button-active"),a.hide()},toggleHelp:function(){f=!f,$(".helpButton").toggleClass("hud-button-active"),$(".helpArea").toggle()},closeHelp:function(){f=!1,$(".helpButton").removeClass("hud-button-active"),$(".helpArea").hide()},toggleMute:function(){return $game.$audio.toggleMute()===!0?l.muteAudio():l.unmuteAudio()},muteAudio:function(){$(".muteButton i").removeClass("fa fa-volume-up").addClass("fa fa-volume-off")},unmuteAudio:function(){$(".muteButton i").removeClass("fa fa-volume-off").addClass("fa fa-volume-up")},resetInit:function(){f=null}},c={trigger:function(e){switch(e){case"FOREST":if(!$game.$player.checkFlag("teleport-forest"))return!1;c.outfitLog("Teleporting to "+$game.world.northwest.name+"!"),$game.$player.beamMeUpScotty([15,22]);break;case"TOWN":if(!$game.$player.checkFlag("teleport-town"))return!1;c.outfitLog("Teleporting to "+$game.world.northeast.name+"!"),$game.$player.beamMeUpScotty([99,29]);break;case"RANCH":if(!$game.$player.checkFlag("teleport-ranch"))return!1;c.outfitLog("Teleporting to "+$game.world.southeast.name+"!"),$game.$player.beamMeUpScotty([131,96]);break;case"PORT":if(!$game.$player.checkFlag("teleport-port"))return!1;c.outfitLog("Teleporting to "+$game.world.southwest.name+"!"),$game.$player.beamMeUpScotty([47,99]);break;case"kazaam":c.outfitLog("Starting collaborative challenge."),ss.rpc("game.player.collaborativeChallenge",function(e){e&&$game.log("Whoops: you came alone, you get no bone(us).")});break;default:return!1}},cheat:function(e){switch(e.toLowerCase()){case"beam me up scotty":case"beam me up, Scotty!":c.cheatLog("Teleporting to botanist."),$game.$player.beamMeUpScotty([70,74]);break;case"show me the money":c.cheatLog("Adding 200 seeds."),$game.$player.addSeeds("regular",200);break;case"like one of your french girls":c.cheatLog("Adding 200 paint seeds."),$game.$player.addSeeds("draw",200);break;case"loki":c.cheatLog("Debug seed amount."),$game.$player.setSeeds("regular",0),$game.$player.setSeeds("draw",3);break;case"ding me":c.cheatLog("Leveling up!"),$game.$player.nextLevel();break;case"suit alors":c.cheatLog("All suits unlocked!");var t=$game.$skins.getSetsList();for(var n in t)$game.$skins.unlockSkin(t[n]);break;case"birthday suit":c.cheatLog("All suits removed!"),$game.$skins.resetSkinventory();break;case"pleasantville":c.cheatLog("Welcome to Pleasantville!"),$game.bossModeUnlocked=!0,$game.$player.currentLevel=4,$game.$boss.init();break;default:return!1}},log:function(e,t,n){$game.log('<span class="color-'+e+'">['+t+"]</span>"+" "+n)},outfitLog:function(e){this.log("lightpurple","Outfit effect",e)},cheatLog:function(e){this.log("yellow","Cheat code activated",e)}}});require.define("/log.js",function(e,t,n,r,i){"use strict";function l(){s=$("#game-log")}var s,o,u=50,a=0,f=$game.$log={ready:!1,init:function(e){l(),$game.$log.ready=!0,$game.log("Welcome to Civic Seed"),$game.$log.clearUnread(),e()},resetInit:function(){o=null,u=50,a=0,$game.$log.ready=!1},addMessage:function(e){if($game.$log.ready){if($("#game-log").is(":visible")){o++,a++;var t=o;o>10&&(t="10+",$game.alert("There are new messages in your game log below")),$game.setBadgeCount(".hud-log-button",t)}var n=Date(),r=n.substring(0,10)+n.substring(15,24),i;e.input==="chat"?(i='<p class="globalChat"><span class="date">'+r+"</span>",i+='<span class="playerName">'+e.name+": </span>"+e.message+"</p>"):(i='<p class="status"><span class="date">'+r+"</span>",i+=e.message+"</p>"),a>u&&($("#game-log p").last().remove(),$("#game-log-overlay p").first().remove()),s.prepend(i);var f=document.getElementById("game-log-overlay");f.innerHTML+=i,f.scrollTop=f.scrollHeight}},clearUnread:function(){$game.setBadgeCount(".hud-log-button",0),o=0}}});require.define("/map.js",function(e,t,n,r,i){"use strict";function b(e,t){$game.$map.dataLoaded=!1;var n=e.x,r=e.y,i=e.x+e.numX,o=e.y+e.numY;ss.rpc("game.map.getMapData",n,r,i,o,function(n,r){var i=null;s=new Array(e.numX);var o=e.numX;while(--o>=0){s[o]=new Array(e.numY);var u=e.numY;while(--u>=0)i=u*e.numX+o%e.numX,s[o][u]=n[i]}var a=r.length,f=0,l=0,c=0,h=s.length,p=s[0].length;while(c<a){var d=!1;while(!d)s[f][l].mapIndex===r[c].mapIndex&&(s[f][l].colored=!0,d=!0),f++,f>=h&&(f=0,l++,l>=p&&(console.log("errrr"),d=!0));c++}$game.$map.dataLoaded=!0,t()})}function w(e){$game.$map.currentTiles=[$game.VIEWPORT_WIDTH];var t=$game.VIEWPORT_WIDTH;while(--t>=0){$game.$map.currentTiles[t]=[$game.VIEWPORT_HEIGHT];var n=$game.VIEWPORT_HEIGHT;while(--n>=0)$game.$map.currentTiles[t][n]=s[t][n]}s=[],e()}function E(){$game.$map.currentTiles=[$game.VIEWPORT_WIDTH];var e=$game.VIEWPORT_WIDTH;while(--e>=0){$game.$map.currentTiles[e]=[$game.VIEWPORT_HEIGHT];var t=$game.VIEWPORT_HEIGHT;while(--t>=0)$game.$map.currentTiles[e][t]={x:e,y:t,tileState:-1,isMapEdge:!0,background:0,background2:0,background3:0,foreground:0,foreground2:0,mapIndex:t*$game.VIEWPORT_WIDTH+e}}}var s=null,o=null,u=null,a=0,f=0,l=0,c=0,s=[],h=0,p=0,d=0,v=0,m=0,g=0,y=$game.$map={coloredTiles:[],growingSeed:!1,seedsInProgress:[],collectiveImage:null,ready:!1,miniMap:{},currentTiles:null,dataLoaded:!1,numberOfSteps:0,stepDirection:null,init:function(e){var t=$game.$player.id,n=$game.$player.getPosition(),r=$game.$player.getColor();$game.$map.addPlayer(t,n.x,n.y,r),ss.rpc("game.map.init",function(){$game.$map.ready=!0,e()})},resetInit:function(){s=null,o=null,u=null,a=0,f=0,l=0,c=0,s=[],h=0,p=0,d=0,v=0,m=0,g=0,$game.$map.coloredTiles=[],$game.$map.growingSeed=!1,$game.$map.seedsInProgress=[],$game.$map.collectiveImage=null,$game.$map.ready=!1,$game.$map.miniMap={},$game.$map.currentTiles=null,$game.$map.dataLoaded=!1,$game.$map.numberOfSteps=0,$game.$map.stepDirection=null},firstStart:function(e){if($game.bossModeUnlocked&&$game.$player.currentLevel>3)$("#minimapPlayer").toggleClass("hide"),E(),$game.$map.createPathGrid(function(){e()},!0);else{var t={x:$game.masterX,y:$game.masterY,numX:$game.VIEWPORT_WIDTH,numY:$game.VIEWPORT_HEIGHT};b(t,function(){w(function(){$game.$map.createPathGrid(function(){e()})})})}},createPathGrid:function(e,t){o=null,u=null,o=new Array($game.VIEWPORT_HEIGHT);var n=$game.VIEWPORT_HEIGHT;while(--n>=0){o[n]=new Array($game.VIEWPORT_WIDTH);var r=$game.VIEWPORT_WIDTH;while(--r>=0)if(t)o[n][r]=1;else{var i=$game.$map.getTileState(r,n),s;i===-1?s=1:s=0,o[n][r]=s}}u=new Graph(o),e()},getTileState:function(e,t){var n=$game.$map.currentTiles[e][t].tileState;if(t<$game.VIEWPORT_HEIGHT-1){var r=$game.$map.currentTiles[e][t+1].tileState;r>=0&&(n=r)}return n},isMapEdge:function(e,t,n){var r=$game.$map.currentTiles[e][t].isMapEdge;n(r)},addPlayer:function(e,t,n,r){$game.$map.miniMap[e]={},$game.$map.miniMap[e].x=t,$game.$map.miniMap[e].y=n,$game.$map.miniMap[e].col=r,$game.$map.render()},updatePlayer:function(e,t,n){$game.$renderer.clearMiniMap(),$game.$map.miniMap[e].x=t,$game.$map.miniMap[e].y=n,$game.$map.render()},removePlayer:function(e){$game.$renderer.clearMiniMap(),delete $game.$map.miniMap[e],$game.$map.render()},render:function(){$game.$renderer.renderMiniMapConstants(),$.each($game.$map.miniMap,function(e,t){$game.$renderer.renderMiniPlayer(t)})},newBomb:function(e,t){for(var n=0;n<e.length;n+=1){var r=$game.$map.masterToLocal(e[n].x,e[n].y),i=null;r&&(i=$game.$map.currentTiles[r.x][r.y],i.colored=!0,$game.$renderer.clearMapTile(r.x*$game.TILE_SIZE,r.y*$game.TILE_SIZE),$game.$renderer.renderTile(r.x,r.y),t===$game.$player.id&&$game.$renderer.renderMiniTile(e[n].x,e[n].y))}},saveImage:function(){var e=document.getElementById("minimapTile"),t=e.toDataURL("img/png");return t},createCollectiveImage:function(){$(".colorMapEveryone").empty(),ss.rpc("game.player.getAllImages",$game.$player.id,function(e){var t=$game.$map.saveImage(),n=e.length;while(--n>-1)$(".colorMapEveryone").append('<img src="'+e[n]+'">');$(".colorMapEveryone").append('<img src="'+t+'">')})},findPath:function(e,t,n){var r=u.nodes[e.y][e.x],i=u.nodes[t.y][t.x];$game.$astar.search(u.nodes,r,i,function(e){n(e)})},calculateNext:function(e,t){var n,r,i,s;e===0?(a=$game.masterX-($game.VIEWPORT_WIDTH-2),l=-1,h=-1,$game.$map.numberOfSteps=$game.VIEWPORT_WIDTH-2,$game.$map.stepDirection="left",n=$game.VIEWPORT_WIDTH-2,r=$game.VIEWPORT_HEIGHT,i=a,s=$game.masterY):e===$game.VIEWPORT_WIDTH-1?(a=$game.masterX+$game.VIEWPORT_WIDTH-2,l=1,h=1,$game.$map.numberOfSteps=$game.VIEWPORT_WIDTH-2,$game.$map.stepDirection="right",n=$game.VIEWPORT_WIDTH-2,r=$game.VIEWPORT_HEIGHT,i=a+2,s=$game.masterY):t===0?(f=$game.masterY-($game.VIEWPORT_HEIGHT-2),c=-1,h=-$game.totalVIEWPORT_HEIGHT,$game.$map.numberOfSteps=$game.VIEWPORT_HEIGHT-2,$game.$map.stepDirection="up",n=$game.VIEWPORT_WIDTH,r=$game.VIEWPORT_HEIGHT-2,i=$game.masterX,s=f):t===$game.VIEWPORT_HEIGHT-1&&(f=$game.masterY+$game.VIEWPORT_HEIGHT-2,c=1,h=$game.totalVIEWPORT_HEIGHT,$game.$map.numberOfSteps=$game.VIEWPORT_HEIGHT-2,$game.$map.stepDirection="down",n=$game.VIEWPORT_WIDTH,r=$game.VIEWPORT_HEIGHT-2,i=$game.masterX,s=f+2),b({x:i,y:s,numX:n,numY:r},function(){return})},transitionMap:function(e){var t,n;if($game.$map.stepDirection==="right"){t=0;while(t<$game.VIEWPORT_WIDTH-1){n=0;while(n<$game.VIEWPORT_HEIGHT)$game.$map.currentTiles[t][n]=$game.$map.currentTiles[t+1][n],n+=1;t+=1}n=$game.VIEWPORT_HEIGHT;while(--n>=0)$game.$map.currentTiles[$game.VIEWPORT_WIDTH-1][n]=s[e-1][n];$game.masterX+=1,$game.$player.slide(1,0),$game.$others.slide(1,0)}if($game.$map.stepDirection==="left"){t=$game.VIEWPORT_WIDTH-1;while(t>0){n=0;while(n<$game.VIEWPORT_HEIGHT)$game.$map.currentTiles[t][n]=$game.$map.currentTiles[t-1][n],n+=1;t-=1}n=$game.VIEWPORT_HEIGHT;while(--n>=0)$game.$map.currentTiles[0][n]=s[s.length-e][n];$game.masterX-=1,$game.$player.slide(-1,0),$game.$others.slide(-1,0)}if($game.$map.stepDirection==="up"){n=$game.VIEWPORT_HEIGHT-1;while(n>0){t=0;while(t<$game.VIEWPORT_WIDTH)$game.$map.currentTiles[t][n]=$game.$map.currentTiles[t][n-1],t+=1;n-=1}t=$game.VIEWPORT_WIDTH;while(--t>=0)$game.$map.currentTiles[t][0]=s[t][s[0].length-e];$game.masterY-=1,$game.$player.slide(0,-1),$game.$others.slide(0,-1)}if($game.$map.stepDirection==="down"){n=0;while(n<$game.VIEWPORT_HEIGHT-1){t=0;while(t<$game.VIEWPORT_WIDTH)$game.$map.currentTiles[t][n]=$game.$map.currentTiles[t][n+1],t+=1;n+=1}t=$game.VIEWPORT_WIDTH;while(--t>=0)$game.$map.currentTiles[t][$game.VIEWPORT_HEIGHT-1]=s[t][e-1];$game.masterY+=1,$game.$player.slide(0,1),$game.$others.slide(0,1)}d=$game.masterX,v=$game.masterX+$game.VIEWPORT_WIDTH,m=$game.masterY,g=$game.masterY+$game.VIEWPORT_HEIGHT+1,requestAnimationFrame($game.stepTransition)},masterToLocal:function(e,t,n){var r={x:e-d,y:t-m};return r.y<=$game.VIEWPORT_HEIGHT-1&&r.y>=0&&r.x<=$game.VIEWPORT_WIDTH-1&&r.x>=0?r:n?r:!1},setBoundaries:function(){d=$game.masterX,v=$game.masterX+$game.VIEWPORT_WIDTH,m=$game.masterY,g=$game.masterY+$game.VIEWPORT_HEIGHT+1}}});require.define("/mouse.js",function(e,t,n,r,i){var s=0,o=0,u=0,a=0,f=!1,l=0;$game.$mouse={drawMode:!1,resetInit:function(){s=0,o=0,u=0,a=0,f=!1,l=0,$game.$mouse.drawMode=!1},updateMouse:function(e,t){var n=e.x-e.offX,r=e.y-e.offY;s=u,o=a;var i=Math.floor(n/32),f=Math.floor(r/32);i>$game.VIEWPORT_WIDTH-1?u=$game.VIEWPORT_WIDTH-1:i<0?u=0:u=i,f>$game.VIEWPORT_HEIGHT-1?a=$game.VIEWPORT_HEIGHT-1:f<0?a=0:a=f,e.debug&&console.log($game.$map.currentTiles[u][a]);if(u!==s||a!==o){var l={pX:s,pY:o,cX:u,cY:a};$game.$renderer.renderMouse(l),$game.$mouse.drawMode&&$game.$player.drawSeed({x:u,y:a})}if(t)if($game.bossModeUnlocked&&$game.$player.currentLevel>3)$game.$player.seedMode?$game.$boss.dropSeed({x:u,y:a}):$game.$player.beginMove(u,a);else if($game.$player.seedMode){if(!$game.$player.awaitingBomb){var c={mouse:!0,x:u,y:a,mode:$game.$player.seedMode},h=$game.$player.dropSeed(c);h||$(".seedButton").removeClass("hud-button-active")}}else{var p=$game.$map.currentTiles[u][a].x,d=$game.$map.currentTiles[u][a].y,v=$game.$others.playerCard(p,d,!0);if(!v){var m=$game.$map.getTileState(u,a);m===-1&&!$game.$player.pathfinding?($game.$player.beginMove(u,a),$game.$npc.isChat&&$game.$npc.hideSpeechBubble(),$game.$botanist.isChat&&$game.$botanist.hideChat()):m>=0&&(m!==$game.$botanist.index&&!$game.$player.pathfinding?($game.$npc.isChat&&$game.$npc.hideSpeechBubble(),$game.$npc.selectNpc(m),$game.$player.beginMove(u-2,a+1)):($("#speech-bubble button").hide(),$game.$botanist.show()))}}},getCurrentPosition:function(){return{x:u,y:a}}}});require.define("/npc.js",function(e,t,n,r,i){"use strict";var s=!1,o={},u=null,a=$game.$npc={ready:!1,hideTimer:null,isResource:!1,isChat:!1,init:function(e){ss.rpc("game.npc.getNpcs",function(t){o={},$.each(t,function(e,t){$game.$npc.addNpc(t)}),s=!0,$game.$npc.ready=!0,e()})},resetInit:function(){s=!1,o={},u=null,$game.$npc.ready=!1,$game.$npc.hideTimer=null,$game.$npc.isResource=!1,$game.$npc.isChat=!1},addNpc:function(e){var t=$game.$npc.createNpc(e);t.getMaster(),o[e.index]=t},update:function(){$.each(o,function(e,t){t.update()})},clear:function(){$.each(o,function(e,t){t.clear()})},getRenderInfo:function(){var e=[];return(!$game.bossModeUnlocked&&$game.$player.currentLevel>3||$game.$player.currentLevel<=3)&&$.each(o,function(t,n){var r=n.getRenderInfo();r&&e.push(r)}),e},createNpc:function(e){var t={name:e.name,id:e.id,index:e.index,dialog:e.dialog,dependsOn:e.dependsOn,level:e.level,isHolding:e.isHolding,resource:e.resource,onScreen:null,numSteps:64,counter:Math.floor(Math.random()*64),curFrame:0,numFrames:4,skinSuit:e.skinSuit,info:{x:e.index%$game.TOTAL_WIDTH,y:Math.floor(e.index/$game.TOTAL_WIDTH),spriteY:e.sprite*64},renderInfo:{prevX:e.index%$game.TOTAL_WIDTH*$game.TILE_SIZE,prevY:Math.floor(e.index/$game.TOTAL_WIDTH)*$game.TILE_SIZE,curX:e.index%$game.TOTAL_WIDTH*$game.TILE_SIZE,curY:Math.floor(e.index/$game.TOTAL_WIDTH)*$game.TILE_SIZE,srcX:0,srcY:0,kind:"npc"},update:function(){$game.inTransit?$game.inTransit&&t.getMaster():t.idle()},getMaster:function(){var e=$game.$map.masterToLocal(t.info.x,t.info.y);if(e){var n=e.x*$game.TILE_SIZE,r=e.y*$game.TILE_SIZE,i=e.x*$game.TILE_SIZE,s=e.y*$game.TILE_SIZE;t.renderInfo.prevX=n,t.renderInfo.prevY=r,t.renderInfo.curX=i,t.renderInfo.curY=s,t.onScreen=!0}else t.onScreen=!1},idle:function(){t.counter+=1,t.counter>=56?(t.counter=0,t.renderInfo.srcX=0,t.renderInfo.srcY=t.info.spriteY):t.counter==24?(t.renderInfo.srcX=32,t.renderInfo.srcY=t.info.spriteY):t.counter==28?(t.renderInfo.srcX=64,t.renderInfo.srcY=t.info.spriteY):t.counter==32&&(t.renderInfo.srcX=96,t.renderInfo.srcY=t.info.spriteY)},clear:function(){$game.$renderer.clearCharacter(t.renderInfo)},getLevel:function(){return this.level+1},getRenderInfo:function(){return t.onScreen?t.renderInfo:!1},isLocked:function(){var e=this.dependsOn;return e!==null?$game.$player.checkForResource(e)?!1:!0:!1},getSmalltalk:function(){var e="",t="";if(this.isHolding){switch($game.$player.currentLevel){case 0:t="northwest";break;case 1:t="northeast";break;case 2:t="southeast";break;case 3:t="southwest"}e="You should go explore "+$game.world[t].name+", in the "+t+"."}else $game.$player.currentLevel===this.level?e=this.dialog.smalltalk[1]:$game.$player.currentLevel<this.level?e=this.dialog.smalltalk[2]:e=this.dialog.smalltalk[0];return e}};return t},activate:function(e){var t=a.getNpc(e);$game.$player.npcOnDeck=!1;if($game.$botanist.getState()===0&&$game.$player.getLevel()===1&&$game.$botanist.tutorialState===0)a.showSpeechBubble(t.name,"You should really see the Botanist before exploring the world.");else if($game.$botanist.getState()<2)a.showSpeechBubble(t.name,"The Botanist still has more to tell you! Head back to The Botanists Garden to hear the rest.");else if(t.isHolding&&$game.$player.getLevel()>=t.getLevel())if(t.isLocked()){var n="Before I help you out, you need to go see "+a.getNpc(t.dependsOn).name+". Come back when you have their resource.";a.showSpeechBubble(t.name,n)}else a.createPrompt(t);else a.showSpeechBubble(t.name,t.getSmalltalk())},showSpeechBubble:function(e,t,n,r){function l(e){s.find(".dialog").addClass("fit"),f=t[e],s.find(".message").text(f),e<t.length-1?s.find(".nextButton").off("click").on("click",function(t){t.stopImmediatePropagation(),l(e+1)}).show():(s.find(".nextButton").off("click").hide(),o===!0?c():s.find(".closeButton").on("click",function(e){e.stopImmediatePropagation(),a.hideSpeechBubble(r)}).show())}function c(){s.find(".dialog").addClass("fit"),s.find(".yesButton").on("click",function(e){e.stopImmediatePropagation(),a.hideSpeechBubble(n)}).show(),s.find(".noButton").on("click",function(e){e.stopImmediatePropagation(),a.hideSpeechBubble(r)}).show()}function h(){var e=document.createElement("button");e.id="callback-button",e.addEventListener("click",function t(n){n.preventDefault(),r(),e.removeEventListener("click",t)}),s.querySelector(".buttonCorner").appendChild(e)}var i=document.getElementById("speech-bubble"),s=$(i),o=!1,u=!1,f=null;s.is(":visible")&&(i.style.display="none"),a.isChat=!0,$game.$audio.playTriggerFx("npcBubble"),s.find(".speaker").text(e),s.find(".dialog").removeClass("fit"),s.find("button").hide(),_.isArray(t)?(u=!0,l(0)):(f=t,s.find(".message").text(f)),typeof n=="function"&&u===!1&&(o=!0,c()),!u&&!o&&typeof r=="function"&&h(),s.fadeIn(300,function(){if(!u&&!o){var e=f.length*50;e<2e3&&(e=2e3),a.hideTimer=setTimeout(a.hideSpeechBubble,e)}})},hideSpeechBubble:function(e){clearTimeout($game.$npc.hideTimer);var t=$("#speech-bubble");$game.$npc.isChat=!1,t.find(".nextButton").off("click"),t.find(".closeButton").off("click"),t.find(".yesButton").off("click"),t.find(".noButton").off("click"),t.fadeOut(300,function(){typeof e=="function"&&e();var n=t.find(".callback-button");n.length>0&&(n.triggerHandler("click"),n.remove())})},createPrompt:function(e){var t=$game.$player.getPrompt(e.index),n=e.dialog.prompts[t];t===2&&(n+=" Want to view again?"),a.showSpeechBubble(e.name,n,function(){$game.$resources.showResource(e.index)})},selectNpc:function(e){var t=String(e);u=o[t],u||(e+=$game.TOTAL_WIDTH,t=String(e),u=o[t]),$game.$player.npcOnDeck=e},getNpc:function(e){var t=o[e];return t||(e+=$game.TOTAL_WIDTH,t=o[e]),t},getLevel:function(e){return e?a.getNpc(e).getLevel():($game.debug("Getting NPC level with _curNpc global is deprecated. Please provide an NPC by index directly."),u.level+1)},getNpcLevel:function(e){$game.debug("$npc.getNpcLevel() is deprecated. Use $npc.getLevel() or npc.getLevel() (on NPC object) instead."),a.getLevel(e)},getNpcData:function(){return o},getName:function(e){return o[e].name},getOnScreenNpcs:function(){var e=[];return $.each(o,function(t,n){n.onScreen&&e.push(n.index)}),e},getNpcCoords:function(e){var t=String(e),n=o[t];return{x:n.renderInfo.curX,y:n.renderInfo.curY}}}});require.define("/others.js",function(e,t,n,r,i){_onScreenPlayers={},$game.$others={ready:!1,init:function(e){ss.rpc("game.player.getOthers",function(t){_onScreenPlayers={};for(var n=0;n<t.length;n++)$game.$others.add(t[n]);$game.$others.ready=!0,e()})},resetInit:function(){_onScreenPlayers={},$game.$others.ready=!1},add:function(e){if(e._id!=$game.$player.id){var t=$game.$others.createOther(e);_onScreenPlayers[t.id]=t,t.updateRenderInfo(),$game.$renderer.createCanvasForPlayer(t.id,t.skinSuit),$game.$map.addPlayer(t.id,e.game.position.x,e.game.position.y,"rgb(200,200,200)")}},update:function(){$.each(_onScreenPlayers,function(e,t){t.update()})},clear:function(){$.each(_onScreenPlayers,function(e,t){t.clear()})},slide:function(e,t){$.each(_onScreenPlayers,function(n,r){r.slide(e,t)})},resetRenderValues:function(){$.each(_onScreenPlayers,function(e,t){t.resetRenderValues()})},hideAllChats:function(){$.each(_onScreenPlayers,function(e,t){t.hideChat()})},message:function(e){$.each(_onScreenPlayers,function(t,n){n.id===e.id&&n.message(e)})},remove:function(e){_onScreenPlayers[e].clear(),$game.$map.removePlayer(e),delete _onScreenPlayers[e]},playerCard:function(e,t,n){return $.each(_onScreenPlayers,function(r,i){if(i.info.x===e&&i.info.y===t)return n&&i.showPlayerCard(),!0}),!1},updateTilesColored:function(e,t){$.each(_onScreenPlayers,function(n,r){r.id===e&&r.setTilesColored(t)})},levelChange:function(e,t){$.each(_onScreenPlayers,function(n,r){r.id===e&&r.changeLevel(t)})},createOther:function(e){var t={name:e.firstName,id:e._id,isMoving:!1,currentStep:0,currentMove:0,currentStepIncX:0,currentStepIncY:0,curFrame:0,numFrames:4,numSteps:8,direction:0,idleCounter:0,getMaster:!0,chatId:"player"+e.id,chatIdSelector:"#player"+e.id,hideTimer:null,isChatting:!1,offScreen:!0,tilesColored:e.game.tilesColored,rank:e.game.rank,level:e.game.currentLevel,skinSuit:e.game.skinSuit,info:{x:e.game.position.x,y:e.game.position.y,srcX:0,srcY:0,offX:0,offY:0,prevOffX:0,prevOffY:0},renderInfo:{srcX:0,srcY:0,curX:e.x,curY:e.y,prevX:e.x,prevY:e.y,kind:"player",firstName:e.firstName,id:e._id},update:function(){t.isMoving?(t.move(),t.getMaster=!0):$game.inTransit?$game.inTransit&&(t.getMaster=!0):t.idle(),t.getMaster&&t.updateRenderInfo()},updateRenderInfo:function(){var e=$game.$map.masterToLocal(t.info.x,t.info.y);if(e){var n=e.x*$game.TILE_SIZE+t.info.prevOffX*$game.STEP_PIXELS,r=e.y*$game.TILE_SIZE+t.info.prevOffY*$game.STEP_PIXELS,i=e.x*$game.TILE_SIZE+t.info.offX*$game.STEP_PIXELS,s=e.y*$game.TILE_SIZE+t.info.offY*$game.STEP_PIXELS;t.renderInfo.prevX=n,t.renderInfo.prevY=r,t.renderInfo.srcX=t.info.srcX,t.renderInfo.srcY=t.info.srcY,t.renderInfo.curX=i,t.renderInfo.curY=s,t.offScreen=!1}else t.offScreen=!0},idle:function(){t.idleCounter+=1,t.idleCounter>=64?(t.idleCounter=0,t.info.srcX=0,t.info.srcY=0,t.getMaster=!0):t.idleCounter==48?(t.info.srcX=32,t.info.srcY=0,t.getMaster=!0):t.getMaster=!1},clear:function(){$game.$renderer.clearCharacter(t.renderInfo)},slide:function(e,n){t.info.prevOffX=e*t.numSteps,t.info.prevOffY=n*t.numSteps},resetRenderValues:function(){t.info.prevOffX=0,t.info.prevOffY=0},getRenderInfo:function(){return t.offScreen?!1:t.renderInfo},getPlayerInfo:function(){},beginMove:function(e){t.seriesOfMoves=new Array(e.length),t.seriesOfMoves=e,t.currentMove=1,t.currentStep=0,t.isMoving=!0,t.hideChat()},endMove:function(){t.isMoving=!1,t.info.srcX=0,t.info.srcY=0,t.info.offX=0,t.info.offY=0,t.info.prevOffX=0,t.info.prevOffY=0,$game.$map.updatePlayer(t.id,t.info.x,t.info.y)},move:function(){t.currentStep>=t.numSteps&&(t.currentStep=0,t.info.x=t.seriesOfMoves[t.currentMove].masterX,t.info.y=t.seriesOfMoves[t.currentMove].masterY,t.currentMove+=1,$game.$map.updatePlayer(t.id,t.info.x,t.info.y)),t.currentMove>=t.seriesOfMoves.length?t.endMove():(t.currentStep+=1,t.currentStep===1?(t.currentStepIncX=t.seriesOfMoves[t.currentMove].masterX-t.info.x,t.currentStepIncY=t.seriesOfMoves[t.currentMove].masterY-t.info.y,t.info.prevOffX=0,t.info.prevOffY=0,t.currentStepIncX===1?t.direction=2:t.currentStepIncX===-1?t.direction=1:t.currentStepIncY===-1?t.direction=4:t.direction=3):(t.info.prevOffX=t.info.offX,t.info.prevOffY=t.info.offY),t.info.offX=t.currentStep*t.currentStepIncX,t.info.offY=t.currentStep*t.currentStepIncY,(t.currentStep-1)%8===0&&(t.curFrame+=1,t.curFrame>=t.numFrames&&(t.curFrame=0)),t.info.srcX=t.curFrame*$game.TILE_SIZE,t.info.srcY=t.direction*$game.TILE_SIZE*2)},message:function(e){if(!t.offScreen){var n={x:t.renderInfo.curX,y:t.renderInfo.curY};e.isChatting=t.isChatting,e.chatId=t.chatId,e.chatIdSelector=t.chatIdSelector,e.position=n,clearTimeout(t.hideTimer),t.isChatting=!0;var r=$game.$chat.message(e);t.hideTimer=setTimeout(t.hideChat,r)}$game.$log.addMessage(e)},hideChat:function(){clearTimeout(t.hideTimer),$(t.chatIdSelector).fadeOut("fast",function(){$(this).remove(),t.isChatting=!1})},setTilesColored:function(e){t.tilesColored=e},showPlayerCard:function(){var e=t.name+" is a "+$game.playerRanks[t.level]+" who has colored "+t.tilesColored+" tiles";t.offScreen||$game.statusUpdate({message:e,input:"status",screen:!0,log:!1})},changeLevel:function(e){t.level=e},beam:function(e){t.info.x=e.x,t.info.y=e.y,t.updateRenderInfo(),$game.$map.updatePlayer(t.id,t.info.x,t.info.y)},skinSuitChange:function(e){t.skinSuit=e.skinSuit,$game.$renderer.createCanvasForPlayer(e.id,e.skinSuit)}};return t},getRenderInfo:function(){var e=[];return $.each(_onScreenPlayers,function(t,n){var r=n.getRenderInfo();r&&e.push(r)}),e},sendMoveInfo:function(e,t){_onScreenPlayers[t]&&_onScreenPlayers[t].beginMove(e)},beam:function(e){$.each(_onScreenPlayers,function(t,n){n.id===e.id&&n.beam(e)})},disable:function(){$.each(_onScreenPlayers,function(e,t){t.offScreen=!0})},skinSuitChange:function(e){$.each(_onScreenPlayers,function(t,n){n.id===e.id&&n.skinSuitChange(e)})}}});require.define("/pathfinder.js",function(e,t,n,r,i){function o(e){var t=[];for(var n=0;n<e.length;n++){t[n]=[];for(var r=0,i=e[n];r<i.length;r++)t[n][r]=new u(n,r,i[r])}this.input=e,this.nodes=t}function u(e,t,n){this.data={},this.x=e,this.y=t,this.pos={x:e,y:t},this.type=n}function a(e){this.content=[],this.scoreFunction=e}var s={OPEN:1,WALL:0};window.Graph=o,o.prototype.toString=function(){var e="\n",t=this.nodes,n,r,i,s;for(var o=0,u=t.length;o<u;o++){n="",r=t[o];for(i=0,s=r.length;i<s;i++)n+=r[i].type+" ";e=e+n+"\n"}return e},u.prototype.toString=function(){return"["+this.x+" "+this.y+"]"},u.prototype.isWall=function(){return this.type==s.WALL},a.prototype={push:function(e){this.content.push(e),this.sinkDown(this.content.length-1)},pop:function(){var e=this.content[0],t=this.content.pop();return this.content.length>0&&(this.content[0]=t,this.bubbleUp(0)),e},remove:function(e){var t=this.content.indexOf(e),n=this.content.pop();t!==this.content.length-1&&(this.content[t]=n,this.scoreFunction(n)<this.scoreFunction(e)?this.sinkDown(t):this.bubbleUp(t))},size:function(){return this.content.length},rescoreElement:function(e){this.sinkDown(this.content.indexOf(e))},sinkDown:function(e){var t=this.content[e];while(e>0){var n=(e+1>>1)-1,r=this.content[n];if(!(this.scoreFunction(t)<this.scoreFunction(r)))break;this.content[n]=t,this.content[e]=r,e=n}},bubbleUp:function(e){var t=this.content.length,n=this.content[e],r=this.scoreFunction(n);for(;;){var i=e+1<<1,s=i-1,o=null;if(s<t){var u=this.content[s],a=this.scoreFunction(u);a<r&&(o=s)}if(i<t){var f=this.content[i],l=this.scoreFunction(f);l<(o===null?r:a)&&(o=i)}if(o===null)break;this.content[e]=this.content[o],this.content[o]=n,e=o}}},$game.$astar={init:function(e){for(var t=0,n=e.length;t<n;t++)for(var r=0,i=e[t].length;r<i;r++){var s=e[t][r];s.f=0,s.g=0,s.h=0,s.cost=s.type,s.visited=!1,s.closed=!1,s.parent=null,s.masterX=$game.$map.currentTiles[r][t].x,s.masterY=$game.$map.currentTiles[r][t].y}},heap:function(){return new a(function(e){return e.f})},search:function(e,t,n,r,i,s){$game.$astar.init(e),s=s||$game.$astar.manhattan,i=!!i;var o=$game.$astar.heap();o.push(t);while(o.size()>0){var u=o.pop();if(u===n){var a=u,f=[];while(a.parent)f.push(a),a=a.parent;f.push(t);var l=f.reverse();return r(l),!0}u.closed=!0;var c=$game.$astar.neighbors(e,u,i);for(var h=0,p=c.length;h<p;h++){var d=c[h];if(d.closed||d.isWall())continue;var v=u.g+d.cost,m=d.visited;if(!m||v<d.g)d.visited=!0,d.parent=u,d.h=d.h||s(d.pos,n.pos),d.g=v,d.f=d.g+d.h,m?o.rescoreElement(d):o.push(d)}}return r([]),!1},manhattan:function(e,t){var n=Math.abs(t.x-e.x),r=Math.abs(t.y-e.y);return n+r},neighbors:function(e,t,n){var r=[],i=t.x,s=t.y;return e[i-1]&&e[i-1][s]&&r.push(e[i-1][s]),e[i+1]&&e[i+1][s]&&r.push(e[i+1][s]),e[i]&&e[i][s-1]&&r.push(e[i][s-1]),e[i]&&e[i][s+1]&&r.push(e[i][s+1]),n&&(e[i-1]&&e[i-1][s-1]&&r.push(e[i-1][s-1]),e[i+1]&&e[i+1][s-1]&&r.push(e[i+1][s-1]),e[i-1]&&e[i-1][s+1]&&r.push(e[i-1][s+1]),e[i+1]&&e[i+1][s+1]&&r.push(e[i+1][s+1])),r}}});require.define("/player.js",function(e,t,n,r,i){"use strict";function W(e){var t={id:$game.$player.id,resource:e,inventory:M,resourcesDiscovered:F,index:e.index};ss.rpc("game.player.saveResource",t)}function X(){y=$(".waitingForSeed"),b=$(".gameboard"),w=$(".inventory > .pieces"),E=$(".graffiti"),S=$(".graffiti p span")}function V(e){T=e.game.seeds,g=T.dropped,C=st(e.game.resources),k=e.game.position,M=e.game.inventory,D=e.game.colorMap,P=e.game.resume,H=e.game.playingTime,B=e.game.tilesColored,j=e.game.pledges,F=e.game.resourcesDiscovered,I=e.game.skinSuit,C||(C={}),$game.$player.id=e.id,$game.$player.firstName=e.firstName,$game.$player.currentLevel=e.game.currentLevel,$game.$player.botanistState=e.game.botanistState,$game.$player.firstTime=e.game.firstTime,$game.$player.instanceName=e.game.instanceName,$game.$player.seenRobot=e.game.seenRobot,$game.$player.isMuted=e.game.isMuted}function J(e){var t=Math.floor(e.sz/2),n=e.mX-t,r=e.mY-t,i=e.x-t,s=e.y-t,o=[],u=e.mode,a=null,f=null,l=null,c=0;while(c<e.sz){var h=0;while(h<e.sz)n+h>-1&&n+h<$game.TOTAL_WIDTH&&r+c>-1&&r+c<$game.TOTAL_HEIGHT&&(l=(r+c)*$game.TOTAL_WIDTH+(n+h),a={x:n+h,y:r+c,mapIndex:l,instanceName:$game.$player.instanceName},o.push(a)),h+=1;c+=1}if(o.length>0){var p={bombed:o,options:e,x1:n,y1:r,x2:n+e.sz,y2:r+e.sz,kind:"regular"};K(p)}}function K(e){$game.$player.awaitingBomb=!0;var t={id:$game.$player.id,name:$game.$player.firstName,x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,tilesColored:B,instanceName:$game.$player.instanceName,kind:e.kind},n=$game.$map.masterToLocal(e.options.mX,e.options.mY);y.css({top:n.y*32,left:n.x*32}).show(),ss.rpc("game.player.dropSeed",e.bombed,t,function(t){$game.$player.awaitingBomb=!1,y.fadeOut(),t>0&&(T.dropped+=1,$game.$audio.playTriggerFx("seedDrop"),B+=t,e.kind==="regular"?($game.$player.addSeeds("regular",-1),T.regular===0&&($game.$player.seedMode=!1,v.colorNum=O,$game.$player.seedPlanting=!1,$game.alert("You are out of seeds!"),$(".seedButton").removeClass("hud-button-active"),$game.$player.saveMapImage(!0),it())):($game.$player.addSeeds("draw",0),T.draw===0&&($game.$mouse.drawMode=!1,$BODY.off("mousedown touchstart",".gameboard"),$game.$player.seedMode=!1,v.colorNum=O,$game.$player.seedPlanting=!1,E.hide(),$game.alert("You are out of seeds!"),$(".seedButton").removeClass("hud-button-active"),$game.$player.saveMapImage(!0),it())))})}function Q(){N=T.regular+T.draw,$game.setBadgeCount(".seedButton",N),$game.setBadgeCount(".regularButton",T.regular),$game.setBadgeCount(".drawButton",T.draw)}function G(){var e=$game.$map.masterToLocal(d.x,d.y);if(e){var t=e.x*$game.TILE_SIZE+d.prevOffX*$game.STEP_PIXELS,n=e.y*$game.TILE_SIZE+d.prevOffY*$game.STEP_PIXELS,r=e.x*$game.TILE_SIZE+d.offX*$game.STEP_PIXELS,i=e.y*$game.TILE_SIZE+d.offY*$game.STEP_PIXELS;v.prevX=t,v.prevY=n,v.srcX=d.srcX,v.srcY=d.srcY,v.curX=r,v.curY=i}}function Y(){$game.$player.isMoving=!0,$game.$player.currentStep>=u&&($game.$player.currentStep=0,d.x=$game.$player.seriesOfMoves[$game.$player.currentMove].masterX,d.y=$game.$player.seriesOfMoves[$game.$player.currentMove].masterY,$game.$player.currentMove+=1,$game.$map.updatePlayer($game.$player.id,d.x,d.y)),$game.$player.currentMove>=$game.$player.seriesOfMoves.length?$game.bossModeUnlocked&&$game.$player.currentLevel>3?(d.offX=0,d.offY=0,d.srcX=0,d.srcY=0,d.prevOffX=0,d.prevOffY=0,$game.$player.isMoving=!1,$game.$boss.endMove(d.x,d.y)):et():($game.$player.currentStep+=1,$game.$player.currentStep===1?(a=$game.$player.seriesOfMoves[$game.$player.currentMove].masterX-d.x,f=$game.$player.seriesOfMoves[$game.$player.currentMove].masterY-d.y,d.prevOffX=0,d.prevOffY=0,a===1?l=2:a===-1?l=1:f===-1?l=4:l=3):(d.prevOffX=d.offX,d.prevOffY=d.offY),d.offX=$game.$player.currentStep*a,d.offY=$game.$player.currentStep*f,($game.$player.currentStep-1)%8===0&&(s+=1,s>=o&&(s=0)),d.srcX=s*$game.TILE_SIZE,d.srcY=l*$game.TILE_SIZE*2)}function Z(e){$game.$player.seriesOfMoves=new Array(e.length),$game.$player.seriesOfMoves=e,$game.$player.currentMove=1,$game.$player.currentStep=0,$game.$player.isMoving=!0,$game.$chat.hideChat()}function et(){var e={id:$game.$player.id,position:{x:d.x,y:d.y}};ss.rpc("game.player.savePosition",e),$game.$map.updatePlayer($game.$player.id,d.x,d.y),d.offX=0,d.offY=0,d.srcX=0,d.srcY=0,d.prevOffX=0,d.prevOffY=0,$game.$player.isMoving=!1;if(c){var t=function(){$game.$map.dataLoaded?$game.beginTransition():setTimeout(t,50)};t()}else if($game.$player.npcOnDeck){var n=$game.$player.npcOnDeck;$game.$npc.activate(n)}}function tt(){h+=1,$game.$player.seedMode&&(h%32<16?v.colorNum=0:v.colorNum=O),h>=64?(h=0,d.srcX=0,d.srcY=0,p=!0,v.squat=!1):h===48?(d.srcX=32,d.srcY=0,p=!0,v.squat=!0):p=!1}function nt(e){var t="r"+e.name,n="level"+($game.$player.currentLevel+1),r=CivicSeed.CLOUD_PATH+"/img/game/resources/"+n+"/small/"+e.name+".png";w.prepend('<img class="inventoryItem '+t+'"src="'+r+'" data-placement="top" data-original-title="'+e.tagline+'">'),$("."+t).bind("mouseenter",function(){$(this).tooltip("show")}),$game.setBadgeCount(".inventoryButton",U.getInventoryLength()),$("img.inventoryItem."+t).bind("click",function(){$game.$resources.examineResource(e.npc)}).bind("dragstart",{npc:e.npc+","+e.name},$game.$botanist.dragStart)}function rt(){$game.$player.firstName==="Demo"?$game.$boss.init(function(){}):ss.rpc("game.player.gameOver",$game.$player.id,function(e){if(e)if($game.bossModeUnlocked&&$game.$player.currentLevel>3)$game.$boss.init(function(){});else{var t='<div class="hooray"><h2>You beat the game, hooray!</h2><p>But the color has not yet returned to the world... If you have more seeds go and color the world. I will contact you when it has returned.</div>';$(".gameboard").append(t)}})}function it(){var e={id:$game.$player.id,seeds:T,tilesColored:B};ss.rpc("game.player.updateGameInfo",e)}function st(e){var t={};for(var n=0;n<e.length;n++)t[e[n].index]=e[n],t[e[n].index].arrayLookup=n;return t}function ot(e){for(var t=0;t<M.length;t++)if(M[t].npc===e)return!0;return!1}var s=0,o=4,u=8,a=0,f=0,l=0,c=null,h=0,p=!0,d=null,v=null,m=[4,5,6,5],g=null,y=null,b=null,w=null,E=null,S=null,x=null,T=null,N=null,C=null,k=null,L=null,A=null,O=null,M=null,D=null,P=null,H=null,B=null,j=null,F=null,I=null,q=null,R={},U=$game.$player={firstName:null,id:null,game:null,instanceName:null,currentLevel:null,botanistState:null,firstTime:null,seenRobot:null,seriesOfMoves:null,currentMove:0,currentStep:0,isMoving:!1,inventoryShowing:!1,seedventoryShowing:!1,seedPlanting:!1,npcOnDeck:!1,ready:!1,seedMode:!1,awaitingBomb:!1,pathfinding:!1,init:function(e){ss.rpc("game.player.init",function(t){x=(new Date).getTime()/1e3,d={srcX:0,srcY:0,x:t.game.position.x,y:t.game.position.y,offX:0,offY:0,prevOffX:0,prevOffY:0},$game.$player.game=t.game,V(t);var n={_id:t.id,firstName:t.firstName,game:{tilesColored:t.game.tilesColored,rank:t.game.rank,currentLevel:t.game.currentLevel,position:t.game.position,skinSuit:t.game.skinSuit}};ss.rpc("game.player.tellOthers",n),v={colorNum:O,srcX:0,srcY:0,curX:d.x*$game.TILE_SIZE,curY:d.y*$game.TILE_SIZE,prevX:d.x*$game.TILE_SIZE,prevY:d.y*$game.TILE_SIZE,kind:"player",level:$game.$player.currentLevel,firstName:$game.$player.firstName,id:$game.$player.id},X(),Q(),G(),$game.$player.ready=!0,e()})},resetInit:function(){s=0,a=0,f=0,l=0,c=null,h=0,p=!0,d=null,v=null,g=null,y=null,b=null,w=null,E=null,S=null,x=null,T=null,N=null,C=null,k=null,L=null,A=null,O=0,M=null,D=null,P=null,H=null,B=null,j=null,F=null,I=null,q=null,$game.$player.firsName=null,$game.$player.id=null,$game.$player.game=null,$game.$player.instanceName=null,$game.$player.currentLevel=null,$game.$player.botanistState=null,$game.$player.firstTime=null,$game.$player.seenRobot=null,$game.$player.seriesOfMoves=null,$game.$player.currentMove=0,$game.$player.currentStep=0,$game.$player.isMoving=!1,$game.$player.inventoryShowing=!1,$game.$player.seedventoryShowing=!1,$game.$player.seedPlanting=!1,$game.$player.npcOnDeck=!1,$game.$player.ready=!1,$game.$player.seedMode=!1,$game.$player.awaitingBomb=!1,$game.$player.pathfinding=!1},update:function(){$game.$player.isMoving?(Y(),p=!0):$game.inTransit?$game.inTransit&&(p=!0):tt(),p&&G()},clear:function(){$game.$renderer.clearCharacter(v)},beginMove:function(e,t){$game.$player.inventoryShowing&&$game.$input.closeInventory();var n=U.getLocalPosition();$game.$player.pathfinding=!0,d.offX=0,d.offY=0,$game.bossModeUnlocked&&$game.$player.currentLevel>3?$game.$map.findPath({x:d.x,y:d.y},{x:e,y:t},function(e){$game.$player.pathfinding=!1,e.length>0&&Z(e)}):$game.$map.isMapEdge(e,t,function(n){c=!1;if(!n){if(e===0||e===$game.VIEWPORT_WIDTH-1||t===0||t===$game.VIEWPORT_HEIGHT-1)c=!0,$game.$map.calculateNext(e,t)}else $game.statusUpdate({message:"Edge of the world!",input:"status",screen:!0,log:!1});var r=$game.$map.masterToLocal(d.x,d.y),i={x:e,y:t};$game.$map.findPath(r,i,function(e){$game.$player.pathfinding=!1,e.length>0?(Z(e),ss.rpc("game.player.movePlayer",e,$game.$player.id,function(){var e=$game.$map.currentTiles[i.x][i.y].x,t=$game.$map.currentTiles[i.x][i.y].y;$game.$audio.update(e,t)})):$game.$player.npcOnDeck=!1})})},moveUp:function(){var e=U.getLocalPosition();$game.$player.beginMove(e.x,e.y-1)},moveDown:function(){var e=U.getLocalPosition();$game.$player.beginMove(e.x,e.y+1)},moveLeft:function(){var e=U.getLocalPosition();$game.$player.beginMove(e.x-1,e.y)},moveRight:function(){var e=U.getLocalPosition();$game.$player.beginMove(e.x+1,e.y)},slide:function(e,t){d.prevOffX=e*u,d.prevOffY=t*u},resetRenderValues:function(){d.prevOffX=0,d.prevOffY=0},dropSeed:function(e){e.x!==undefined&&e.x>=0&&(e.mX=$game.$map.currentTiles[e.x][e.y].x,e.mY=$game.$map.currentTiles[e.x][e.y].y);var t=e.mode;if(t==="regular")return T.regular<1?!1:(e.sz=3,J(e),!0);var n=$.map(q,function(e,t){return[e]});if(n.length>0){var r=R.maxX-R.minX,i=R.maxY-R.minY,s=r>i?r:i,o=$game.$map.currentTiles[R.minX][R.minY],u=$game.$map.currentTiles[R.maxX][R.maxY],a=$game.$map.currentTiles[15][7].x,f=$game.$map.currentTiles[15][7].y,l={bombed:n,options:{mX:a,mY:f},x1:o.x,y1:o.y,x2:u.x,y2:u.y,kind:"draw"};return K(l),!0}},getPrompt:function(e){return C[e]?C[e].result?2:1:0},answerResource:function(e){var t={answers:[e.answer],attempts:1,result:e.correct,seeded:[],questionType:e.questionType,index:e.index},n=null;C[e.index]&&(n=C[e.index]),n?(n.answers.push(t.answers[0]),n.attempts+=1,n.result=t.result):(C[e.index]=t,n=C[e.index]),e.skinSuit&&$game.$skins.unlockSkin(e.skinSuit);if(e.correct){F+=1;var r=6-n.attempts,i=r<0?0:r;return $game.$player.addSeeds("regular",i),i}},saveMapImage:function(e){if(T.dropped-g>4||e){D=$game.$map.saveImage();var t={id:$game.$player.id,colorMap:D};ss.rpc("game.player.updateGameInfo",t),g=T.dropped}},checkBotanistState:function(){if($game.$player.botanistState>1){var e=$game.$botanist.tangram[$game.$player.currentLevel].answer,t=e.length;while(--t>-1){var n=e[t].id,r=!1;$.each(C,function(e,t){if(t){var i=$game.$resources.getShapeName(e);i===n&&(r=!0)}});if(!r)return!1}$game.$botanist.setState(3);var i={id:$game.$player.id,botanistState:$game.$player.botanistState};ss.rpc("game.player.updateGameInfo",i),M.length===$game.resourceCount[$game.$player.currentLevel]&&($game.alert("You collected all the pieces, to the botanist!"),setTimeout(function(){$game.$player.beamMeUpScotty()},3e3))}},getAnswer:function(e){return C[e]},fillInventory:function(){var e=U.getInventory();$game.setBadgeCount(".inventoryButton",e.length);for(var t=0;t<e.length;t++)nt(e[t]);U.botanistState>1&&U.tangramToInventory()},tangramToInventory:function(){var e="puzzle"+$game.$player.currentLevel,t=CivicSeed.CLOUD_PATH+"/img/game/tangram/"+e+"small.png";w.append('<div class="inventoryItem inventoryPuzzle '+e+'"><img src="'+t+'" draggable = "false"></div>'),$("."+e).bind("click",$game.$botanist.inventoryShowRiddle)},emptyInventory:function(){M=[],$(".inventoryItem").remove(),$game.setBadgeCount(".inventoryButton",0)},createInventoryOutlines:function(){var e=$(".inventory > .outlines");e.empty();for(var t=0;t<$game.resourceCount[$game.$player.currentLevel];t+=1)e.append('<div class="inventoryOutline"></div>')},nextLevel:function(){$game.$player.currentLevel+=1,$game.$player.seenRobot=!1,$game.$botanist.setState(0),j=5,ss.rpc("game.player.updateGameInfo",{id:$game.$player.id,botanistState:$game.$player.botanistState,seenRobot:$game.$player.seenRobot,pledges:j,inventory:[],currentLevel:$game.$player.currentLevel}),$game.log("Congrats! You have completed level "+$game.$player.currentLevel+"!");if($game.$player.currentLevel<4){$game.$botanist.nudgePlayer(),$game.$robot.setPosition(),v.level=$game.$player.currentLevel,$game.$player.createInventoryOutlines();var e=$game.$player.currentLevel+1;ss.rpc("game.player.levelChange",$game.$player.id,$game.$player.currentLevel)}else $game.bossModeUnlocked&&$game.toBossLevel()},getPlayingTime:function(){var e=(new Date).getTime()/1e3,t=Math.round(e-x+H);return t},openSeedventory:function(){T.draw>0?($game.alert("Choose a seed to plant"),$(".seedventory").slideDown(function(){T.regular>0&&$(".regularButton").addClass("active"),T.draw>0&&$(".drawButton").addClass("active"),$game.$player.seedventoryShowing=!0})):T.regular>0?($game.$player.seedPlanting=!0,$game.$player.seedMode="regular",$game.alert("Click anywhere to plant a seed and watch color bloom there")):($game.alert("You have no seeds"),$game.$input.endSeedMode())},startSeeding:function(e){$game.$player.seedMode=e,$(".seedventory").slideUp(function(){$game.$player.seedventoryShowing=!1,$game.$player.seedPlanting=!0});var t;e==="regular"?t="Click anywhere to plant a seed and watch color bloom there":(t="Paintbrush mode activated - click and drag to draw",E.show(),S.text(T.draw)),$game.alert(t)},makePublic:function(e){C[e]&&(C[e].madePublic=!0,ss.rpc("game.npc.makeResponsePublic",{playerId:$game.$player.id,npcId:e,instanceName:$game.$player.instanceName}))},makePrivate:function(e){C[e]&&(C[e].madePublic=!1,ss.rpc("game.npc.makeResponsePrivate",{playerId:$game.$player.id,npcId:e,instanceName:$game.$player.instanceName}))},compileAnswers:function(){var e="";return $.each(C,function(t,n){if(n.questionType==="open"){var r=n.answers[n.answers.length-1],i=$game.$resources.getQuestion(t),s=n.seeded.length;e+='<p class="theQuestion"><strong>Q:</strong> '+i+'</p><div class="theAnswer"><p class="answerText">'+r+"</p>",s>0&&(e+='<p class="seededCount">'+s+" likes</p>"),e+="</div>"}}),e},checkForResource:function(e){return C[e]?!0:!1},setSeeds:function(e,t){T[e]=t,ss.rpc("game.player.updateGameInfo",{id:$game.$player.id,seeds:T}),Q()},addSeeds:function(e,t){var n=T[e]+t;U.setSeeds(e,n)},resumeAnswer:function(e){P.push(e);var t={id:$game.$player.id,resume:P};ss.rpc("game.player.updateGameInfo",t)},updatePledges:function(e){j+=e;var t={id:$game.$player.id,pledges:j};ss.rpc("game.player.updateGameInfo",t)},resetRenderColor:function(){v.colorNum=O},getPosition:function(){return d},getLocalPosition:function(){return $game.$map.masterToLocal(d.x,d.y)},getColor:function(){return L},getColorNum:function(){return v.colorNum},getRenderInfo:function(){return v},getColorMap:function(){return D},getTilesColored:function(){return B},getResourcesDiscovered:function(){return F},getSkinSuit:function(){return I},getSeedsDropped:function(){return T.dropped},getInventoryLength:function(){return M.length},getInventory:function(e){return e!==undefined?M[e]:M},getLevel:function(){return U.currentLevel+1},getPledges:function(){return j},getColorString:function(){return A},getRenderPosition:function(){return{x:v.curX,y:v.curY}},beamMeUpScotty:function(e){$game.inTransit=!0,$(".beamMeUp").show(),d.x=e[0]||70,d.y=e[1]||74,v.curX=d.x*$game.TILE_SIZE,v.curY=d.y*$game.TILE_SIZE,v.prevX=d.x*$game.TILE_SIZE,v.prevY=d.y*$game.TILE_SIZE;var t=d.x===0?0:d.x-1,n=d.y===0?0:d.y-1,r=Math.floor(t/($game.VIEWPORT_WIDTH-2)),i=Math.floor(n/($game.VIEWPORT_HEIGHT-2)),s=r*($game.VIEWPORT_WIDTH-2),o=i*($game.VIEWPORT_HEIGHT-2);$game.masterX=s,$game.masterY=o,$game.$map.setBoundaries(),$game.$map.firstStart(function(){$game.$renderer.renderAllTiles(),setTimeout(function(){$game.inTransit=!1,$(".beamMeUp").fadeOut(),$game.$player.displayNpcComments()},1e3);var e={id:$game.$player.id,x:d.x,y:d.y};ss.rpc("game.player.beam",e),$game.$map.updatePlayer($game.$player.id,d.x,d.y)})},updateResource:function(e){C[e.npc]&&C[e.npc].seeded.push(e.pledger)},setTagline:function(e,t){var n=null,r=$game.$npc.getNpc(e.index).level,i=e.shape;C[e.index]&&(n=C[e.index],n.tagline=t),$game.$player.currentLevel===r&&(ot(e.index)||(M.push({name:i,npc:e.index,tagline:t}),nt({name:i,npc:e.index,tagline:t})));var s={npc:e.index,id:$game.$player.id,name:$game.$player.firstName,answer:n.answers[n.answers.length-1],madePublic:!1,instanceName:$game.$player.instanceName,questionType:n.questionType};$game.$player.firstName!=="Demo"&&ss.rpc("game.npc.saveResponse",s),W(n),$game.$player.displayNpcComments()},saveAnswer:function(e,t){},displayNpcComments:function(){$(".npc-bubble").remove();var e=$game.$npc.getOnScreenNpcs();for(var t=0;t<e.length;t++)if(C[e[t]]){var n=$game.$npc.getNpcCoords(e[t]),r="npcBubble"+e[t],i;C[e[t]].questionType==="open"?i=$game.$resources.getNumResponses(e[t]):i="*";var s=$('<p class="npc-bubble" data-npc="'+e[t]+'" id="'+r+'">'+i+"</p>");b.append(s),$("#"+r).css({top:n.y-68,left:n.x}),C[e[t]].questionType==="open"&&$("#"+r).bind("click",function(){var e=$(this).attr("data-npc");$game.$resources.examineResponses(e)}),$("#"+r).bind("mouseenter",function(){var e=$(this).text(),t;isNaN(e)?t="You answered this question correctly":(t="There are no public answers, click to make yours public",e>0&&(t="Click to view "+e+" public answers")),$game.statusUpdate({message:t,input:"status",screen:!0,log:!1})})}},saveTimeToDB:function(){var e=(new Date).getTime()/1e3,t=parseInt(e-x,10);H+=t;var n={id:$game.$player.id,playingTime:H};x=e,ss.rpc("game.player.updateGameInfo",n)},saveSeeds:function(){it()},drawSeed:function(e){if(T.draw>0){var t=!1;if($game.$player.seedMode==="draw"){var n=$game.$map.currentTiles[e.x][e.y],r=n.mapIndex,i=String(r);q[r]||($game.$player.addSeeds("draw",-1),S.text(T.draw),t=!0,q[r]={x:n.x,y:n.y,mapIndex:r,instanceName:$game.$player.instanceName},e.x<R.minX&&(R.minX=e.x),e.y<R.minY&&(R.minY=e.y),e.x>R.maxX&&(R.maxX=e.x),e.y>R.maxY&&(R.maxY=e.y)),t&&($game.$map.currentTiles[e.x][e.y].colored=!0,$game.$renderer.clearMapTile(e.x*$game.TILE_SIZE,e.y*$game.TILE_SIZE),$game.$renderer.renderTile(e.x,e.y))}}else $game.$player.dropSeed({mode:"draw"}),$game.$mouse.drawMode=!1,$game.$player.seedMode=!1,$BODY.off("mousedown touchstart",".gameboard"),$game.$player.seedPlanting=!1,$game.alert("You are out of seeds!"),it()},drawFirstSeed:function(){var e=$game.$mouse.getCurrentPosition();q={},R={minX:29,maxX:0,minY:14,maxY:0},$game.$player.drawSeed(e)},setPositionInfo:function(){$game.bossModeUnlocked&&$game.$player.currentLevel>3&&(d.x=15,d.y=8)},debug:function(){console.log(C)},checkSeedLevel:function(){T.draw<=0&&($game.$mouse.drawMode=!1)},setSkinSuit:function(e,t){t!==undefined?I[t]=e:(I.head=e,I.torso=e,I.legs=e),ss.rpc("game.player.changeSkinSuit",{id:$game.$player.id,skinSuit:I}),$game.$renderer.createCanvasForPlayer($game.$player.id,!1),$game.$skins.renderSkinformation()},checkFlag:function(e){return _.contains(z.flags,e)},setFlag:function(e){return this.checkFlag(e)?!1:(z.flags.push(e),!0)},flag:function(e){return this.setFlag(e)},removeFlag:function(e){e?z.flags=_.reject(z.flags,function(t){return t===e}):z.flags=[]}},z={flags:[]}});require.define("/render.js",function(e,t,n,r,i){"use strict";var s={},o=null,u=[],a=0,f=0,l=0,c=0,h=[],p=[],d=null,v=null,m={},g={},y={},b={},w=null,E=null,S=null,x=null,T=null,N=null,C=0,k=0,L=!1,A=!1,O=0,M=0,D=$game.$renderer={ready:!1,colors:{black:"rgb(34,34,34)",white:"rgb(255,255,255)",gray:"rgb(153,153,153)",purple:"rgb(55,59,109)",orange:"rgb(255,180,124)",green:"rgb(167,228,149)",blue:"rgb(121,204,206)",yellow:"rgb(247,215,61)",red:"rgb(249,79,51)"},init:function(e){window.devicePixelRatio&&(console.log("Pixel density is = "+window.devicePixelRatio),$game.PIXEL_RATIO=window.devicePixelRatio),v=P.createCanvas("offscreenBackground"),w=document.getElementById("background").getContext("2d"),E=document.getElementById("foreground").getContext("2d"),S=P.initCanvas("characters"),x=P.initCanvas("interface"),T=P.initCanvas("minimapPlayer"),N=P.initCanvas("minimapTile"),x.shadowColor="#000",x.fillStyle="#fff",x.textAlign="center",x.textBaseline="bottom",x.font="12pt Inconsolata, monospace",E.strokeStyle="rgba(0,255,0,.4)",E.lineWidth=4,E.save(),u=["tilesheet_gray","tilesheet_color","npcs","botanist","robot","boss_items","tiny_botanist","cursors"],O=$game.$player.getColorNum(),M=$game.$player.currentLevel,D.loadTilesheets(0);var t=function(){D.ready?e():setTimeout(t,30)};t()},resetInit:function(){s={},o=null,u=[],a=0,f=0,l=0,c=0,h=[],p=[],d=null,v=null,m={},g={},y={},b={},w=null,E=null,S=null,x=null,T=null,N=null,C=0,k=0,L=!1,A=!1,O=0,M=0,$game.$renderer.ready=!1},loadTilesheets:function(e){var t=u[e];s[t]=new Image,s[t].src=CivicSeed.CLOUD_PATH+"/img/game/"+t+".png",s[t].onload=function(){var n=e+1;e===u.length-1?D.loadSkinSuitImages():(e===0?(h[0]=document.createElement("canvas"),h[0].setAttribute("width",s[t].width),h[0].setAttribute("height",s[t].height),p[0]=h[0].getContext("2d"),a=s[t].width/$game.TILE_SIZE,f=s[t].height/$game.TILE_SIZE,p[0].drawImage(s[t],0,0)):e===1&&(h[1]=document.createElement("canvas"),h[1].setAttribute("width",s[t].width),h[1].setAttribute("height",s[t].height),p[1]=h[1].getContext("2d"),p[1].drawImage(s[t],0,0)),D.loadTilesheets(n))}},loadSkinSuitImages:function(e){e===undefined&&(e=0);var t=e+1,n=$game.$skins.getSetsList(),r=n[e],i=CivicSeed.CLOUD_PATH+"/img/game/skins/"+r+".png",s=new Image;s.src=i,s.onload=function(){m[r]=document.createElement("canvas"),m[r].setAttribute("width",s.width),m[r].setAttribute("height",s.height),g[r]=m[r].getContext("2d"),g[r].drawImage(s,0,0);if(t===n.length){D.ready=!0,l=s.width,c=s.height,$game.$skins.renderSkinventory(),D.createCanvasForPlayer($game.$player.id,!1);return}D.loadSkinSuitImages(t)}},renderFrame:function(){D.clearAll(),$game.inTransit&&D.renderAllTiles(),D.makeQueue(function(e){var t=e.length;while(--t>-1)e[t].kind==="npc"?D.renderNpc(e[t]):e[t].kind==="botanist"?D.renderBotanist(e[t]):e[t].kind==="robot"?D.renderRobot(e[t]):D.renderPlayer(e[t])})},makeQueue:function(e){var t=$game.$player.getRenderInfo(),n=[t],r=$game.$others.getRenderInfo(),i=$game.$npc.getRenderInfo(),s=$game.$botanist.getRenderInfo(),o=$game.$robot.getRenderInfo(),u=n.concat(r,i);s&&u.push(s),o&&u.push(o),u.sort(function(e,t){return t.curY-e.curY}),e(u)},renderTile:function(e,t){var n=$game.$map.currentTiles[e][t],r=n.background-1,i=n.background2-1,s=n.background3-1,o=n.foreground-1,u=n.foreground2-1,a=n.tileState,f=n.colored,l={b1:r,b2:i,b3:s,destX:e,destY:t,colored:f};D.drawMapTile(l);var c={f1:o,f2:u,destX:e,destY:t,colored:f};(o>-1||u>-1)&&D.drawForegroundTile(c)},clearMapTile:function(e,t){w.clearRect(e,t,$game.TILE_SIZE,$game.TILE_SIZE)},drawMapTile:function(e){var t,n,r=e.colored?1:0;r===1&&w.drawImage(h[r],4*$game.TILE_SIZE,0,$game.TILE_SIZE,$game.TILE_SIZE,e.destX*$game.TILE_SIZE,e.destY*$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE),e.b1>-1&&(t=e.b1%a,n=Math.floor(e.b1/a),w.drawImage(h[r],t*$game.TILE_SIZE,n*$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE,e.destX*$game.TILE_SIZE,e.destY*$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE)),e.b2>-1&&(t=e.b2%a,n=Math.floor(e.b2/a),w.drawImage(h[r],t*$game.TILE_SIZE,n*$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE,e.destX*$game.TILE_SIZE,e.destY*$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE)),e.b3>-1&&(t=e.b3%a,n=Math.floor(e.b3/a),w.drawImage(h[r],t*$game.TILE_SIZE,n*$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE,e.destX*$game.TILE_SIZE,e.destY*$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE))},drawForegroundTile:function(e){var t,n,r=e.colored?1:0;e.f1>-1&&(t=e.f1%a,n=Math.floor(e.f1/a),E.drawImage(h[r],t*$game.TILE_SIZE,n*$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE,e.destX*$game.TILE_SIZE,e.destY*$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE)),e.f2>-1&&(t=e.f2%a,n=Math.floor(e.f2/a),E.drawImage(h[r],t*$game.TILE_SIZE,n*$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE,e.destX*$game.TILE_SIZE,e.destY*$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE))},createCanvasForPlayer:function(e,t){b[e]?b[e].clearRect(0,0,l,c):(y[e]=document.createElement("canvas"),y[e].setAttribute("width",l),y[e].setAttribute("height",c),b[e]=y[e].getContext("2d"));var n=t;n||(n=$game.$player.getSkinSuit());var r=$game.TILE_SIZE*2,i=Math.floor(c/r),s=0,o=30,u=15,a=19;for(s=0;s<i;s++)b[e].drawImage(m[n.head],0,s*r,l,o,0,s*r,l,o);for(s=0;s<i;s++)b[e].drawImage(m[n.torso],0,s*r+o,l,u,0,s*r+o,l,u);for(s=0;s<i;s++)b[e].drawImage(m[n.legs],0,s*r+o+u,l,a,0,s*r+o+u,l,a)},renderPlayer:function(e){S.drawImage(y[e.id],e.srcX,e.srcY,$game.TILE_SIZE,$game.TILE_SIZE*2,e.curX,e.curY-$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE*2),x.save(),x.shadowBlur=3,x.shadowOffsetX=0,x.shadowOffsetY=0,x.fillText(e.firstName,e.curX+$game.TILE_SIZE/2,e.curY-$game.TILE_SIZE),x.restore()},clearAll:function(){S.clearRect(0,0,$game.VIEWPORT_WIDTH*$game.TILE_SIZE,$game.VIEWPORT_HEIGHT*$game.TILE_SIZE),x.clearRect(0,0,$game.VIEWPORT_WIDTH*$game.TILE_SIZE,$game.VIEWPORT_HEIGHT*$game.TILE_SIZE)},clearCharacter:function(e){S.clearRect(e.prevX,e.prevY-$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE*2)},renderAllTiles:function(){E.clearRect(0,0,$game.VIEWPORT_WIDTH*$game.TILE_SIZE,$game.VIEWPORT_HEIGHT*$game.TILE_SIZE),v.clearRect(0,0,$game.VIEWPORT_WIDTH*$game.TILE_SIZE,$game.VIEWPORT_HEIGHT*$game.TILE_SIZE),w.clearRect(0,0,$game.VIEWPORT_WIDTH*$game.TILE_SIZE,$game.VIEWPORT_HEIGHT*$game.TILE_SIZE);var e=$game.VIEWPORT_WIDTH;while(--e>=0){var t=$game.VIEWPORT_HEIGHT;while(--t>=0)D.renderTile(e,t)}S.clearRect(0,0,$game.VIEWPORT_WIDTH*$game.TILE_SIZE,$game.VIEWPORT_HEIGHT*$game.TILE_SIZE)},renderNpc:function(e){S.drawImage(s.npcs,e.srcX,e.srcY,$game.TILE_SIZE,$game.TILE_SIZE*2,e.curX,e.curY-$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE*2)},renderMouse:function(e){var t=e.cX*$game.TILE_SIZE,n=e.cY*$game.TILE_SIZE,r=$game.$map.getTileState(e.cX,e.cY);E.clearRect(C*$game.TILE_SIZE,k*$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE);var i=$game.$map.currentTiles[C][k],o=i.foreground-1,u=i.foreground2-1,a=i.colored,f={f1:o,f2:u,destX:C,destY:k,colored:a};D.drawForegroundTile(f);var l;$game.$player.seedMode?l=$game.TILE_SIZE*3:r===-1?l=0:r===-2?l=$game.TILE_SIZE:l=$game.TILE_SIZE*2,E.drawImage(s.cursors,l,0,$game.TILE_SIZE,$game.TILE_SIZE,t,n,$game.TILE_SIZE,$game.TILE_SIZE),C=e.cX,k=e.cY},clearMiniMap:function(){T.clearRect(0,0,$game.TOTAL_WIDTH,$game.TOTAL_HEIGHT)},renderMiniPlayer:function(e){T.fillStyle=this.colors.white,T.fillRect(e.x,e.y,4,4)},renderMiniMapConstants:function(){T.fillStyle=this.colors.gray,T.fillRect(0,72,142,1),T.fillRect(71,0,1,132),T.drawImage(s.tiny_botanist,0,0,20,16,60,64,20,16)},renderMiniTile:function(e,t){var n="rgb(124,202,176)";N.fillStyle=n,N.fillRect(e,t,1,1)},pingMinimap:function(e,t){var n=P.createCanvas("minimap-ping",142,132,!0,{right:"0",zIndex:"6"});n.fillStyle=this.colors.red,n.fillRect(e,t,20,20),$("#minimap-ping").remove()},clearBotanist:function(e){S.clearRect(e.prevX,e.prevY-$game.TILE_SIZE*4,$game.TILE_SIZE*6,$game.TILE_SIZE*5)},clearRobot:function(e){S.clearRect(e.prevX,e.prevY-$game.TILE_SIZE*4,$game.TILE_SIZE*6,$game.TILE_SIZE*5)},renderBotanist:function(e){S.drawImage(s.botanist,e.srcX,e.srcY,$game.TILE_SIZE*6,$game.TILE_SIZE*5,e.curX,e.curY-$game.TILE_SIZE*4,$game.TILE_SIZE*6,$game.TILE_SIZE*5)},renderRobot:function(e){S.drawImage(s.robot,e.srcX,e.srcY,64,64,e.curX,e.curY-$game.TILE_SIZE*1,64,64)},imageToCanvas:function(e){var t=new Image;t.onload=function(){N.drawImage(t,0,0)},t.src=e},renderBossTiles:function(e){for(var t=0;t<e.length;t++)D.clearMapTile(e[t].x*$game.TILE_SIZE,e[t].y*$game.TILE_SIZE),w.fillStyle=e[t].color,w.fillRect(e[t].x*$game.TILE_SIZE,e[t].y*$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE),e[t].item>-1&&w.drawImage(s.boss_items,e[t].item*$game.TILE_SIZE,0,$game.TILE_SIZE,$game.TILE_SIZE,e[t].x*$game.TILE_SIZE,e[t].y*$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE),e[t].charger>-1&&w.drawImage(s.boss_items,128,0,$game.TILE_SIZE,$game.TILE_SIZE,e[t].x*$game.TILE_SIZE,e[t].y*$game.TILE_SIZE,$game.TILE_SIZE,$game.TILE_SIZE)},clearBossLevel:function(){w.clearRect(0,0,$game.TILE_SIZE*$game.VIEWPORT_WIDTH,$game.TILE_SIZE*$game.VIEWPORT_HEIGHT)},clearMap:function(){w.clearRect(0,0,$game.TILE_SIZE*$game.VIEWPORT_WIDTH,$game.TILE_SIZE*$game.VIEWPORT_HEIGHT),E.clearRect(0,0,$game.VIEWPORT_WIDTH*$game.TILE_SIZE,$game.VIEWPORT)}},P={createCanvas:function(e,t,n,r,i){var s=document.createElement("canvas");return s.id=e,s.width=t||$game.VIEWPORT_WIDTH*$game.TILE_SIZE,s.height=n||$game.VIEWPORT_HEIGHT*$game.TILE_SIZE,r===!0&&(_.each(i,function(e,t){s.style[t]=e}),$(".gameboard").append(s)),this.initCanvas(s)},initCanvas:function(e){var t=typeof e=="object"?e:document.getElementById(e),n=t.getContext("2d"),r=t.width,i=t.height;return $game.PIXEL_RATIO>1&&($(t).attr("width",r*$game.PIXEL_RATIO),$(t).attr("height",i*$game.PIXEL_RATIO),$(t).css("width",r),$(t).css("height",i),n.scale($game.PIXEL_RATIO,$game.PIXEL_RATIO)),n}}});require.define("/resources.js",function(e,t,n,r,i){"use strict";var s=[],o=$game.$resources={isShowing:!1,ready:!1,init:function(e){var t=$game.$npc.getNpcData();ss.rpc("game.npc.getResponses",$game.$player.instanceName,function(n){$.each(t,function(e,t){if(t.isHolding){var n=String(t.index);s[n]=t.resource,s[n].index=t.index,s[n].playerAnswers=[],s[n].skinSuit=t.skinSuit}});var r=n[0].resourceResponses;$.each(r,function(e,t){if(t.madePublic){var n=String(t.npc);s[n].playerAnswers.push(t)}}),$game.$resources.ready=!0,e()})},resetInit:function(){s=[],$game.$resources.isShowing=!1,$game.$resources.ready=!1},debug:function(){console.log(s)},showResource:function(e){var t=document.getElementById("resource-area"),n=s[e];o.isShowing=!0,u.loadArticle(n,function(){$game.$audio.playTriggerFx("windowShow"),$game.$audio.fadeLow(),u.addContent(e,1),$(t).fadeIn(300)})},examineResource:function(e){var t=document.getElementById("resource-area");$game.$input.closeInventory(function(){o.showResource(e),t.querySelector(".close-button, .close-overlay").addEventListener("click",function n(){$game.$input.openInventory(),$game.$player.inventoryShowing=$game.$botanist.isSolving?!1:!0,this.removeEventListener("click",n)})})},hideResource:function(e){var t=document.getElementById("resource-area");$(t).fadeOut(300,function(){u.resetSlides(),u.resetButtons(),u.temporaryAnswer="",o.isShowing=!1,$game.$audio.fadeHi(),$game.$player.checkBotanistState(),typeof e=="function"&&e()})},examineResponses:function(e){var t=document.getElementById("resource-area"),n=t.querySelector(".resource-responses"),r=s[e];u.addContent(e,4),n.style.display="block",_.each(t.querySelectorAll(".resource-content, .resource-article, .resource-question"),function(e){e.style.display="none"}),$(t).is(":hidden")&&(o.isShowing=!0,$(t).fadeIn(300))},showCheckMessage:function(e,t){var n=$("#resource-area .check"),r=n.find(".message-feedback");n.find(".check-dialog").hide(),n.show(),r.find(".feedback").text(e),r.find("button").on("click",function(){o.hideCheckMessage(t)}).show(),r.fadeIn(200)},hideCheckMessage:function(e){var t=$("#resource-area .check");t.is(":visible")&&t.fadeOut(200,e)},getShape:function(e){var t=String(e),n=s[t].shape;return u.shapes[$game.$player.currentLevel][n]},getShapeName:function(e){var t=String(e),n=s[t].shape;return n},getTagline:function(e){var t=String(e);return s[t].tagline},addAnswer:function(e){var t=String(e.npc);s[t].playerAnswers.push(e),$game.$player.displayNpcComments()},removeAnswer:function(e){var t=String(e.npc),n=!1,r=0;while(!n)s[t].playerAnswers[r].id===e.id&&(s[t].playerAnswers.splice(r,1),n=!0),r++,r>=s[t].playerAnswers.length&&(n=!0);$game.$player.displayNpcComments()},getQuestion:function(e){var t=String(e);return s[t].question},getNumResponses:function(e){var t=String(e);return s[t].playerAnswers.length}},u={temporaryAnswer:"",seedsToAdd:0,resetSlides:function(){var e=document.getElementById("resource-area");_.each(e.querySelectorAll(".resource-content, .resource-article, .resource-question, .resource-responses"),function(e){e.style.display="none"}),e.querySelector(".resource-article").innerHTML=""},resetButtons:function(){var e=document.getElementById("resource-area").querySelector(".buttons");_.each(e.querySelectorAll("button"),function(e){var t=e.cloneNode(!0);e=e.parentNode.replaceChild(t,e),t.style.display="none"})},loadArticle:function(e,t){var n=CivicSeed.CLOUD_PATH+"/articles/"+e.url+".html";$("#resource-stage").empty().load(n,t)},loadTangram:function(e){function h(e){var t=e.node().getBBox();return[t.x+t.width/2,t.y+t.height/2]}var t=document.getElementById("resource-area").querySelector(".tangram"),n=t.offsetWidth,r=t.offsetHeight,i=$game.$resources.getShape(e.index),s={orange:"rgb(236,113,41)",lightOrange:"rgb(237,173,135)",blue:"rgb(14,152,212)",lightBlue:"rgb(109,195,233)",green:"rgb(76,212,206)",lightGreen:"rgb(164,238,235)"},o=s[i.fill];t.innerHMTL="",d3.select("svg").remove();var u=d3.select("#resource-area .tangram").append("svg").attr("class","tangram-svg"),a=u.append("path").attr("d",i.path).attr("fill",o).attr("stroke","rgb(255,255,255)").attr("stroke-width",0),f=h(a),l=n/2-f[0],c=r/2-f[1];a.attr("transform","translate("+l+","+c+")")},loadQuestion:function(e){var t=document.getElementById("resource-area"),n=t.querySelector(".resource-question"),r=n.querySelector("form"),i=e.questionType,s="";n.querySelector(".question").textContent=e.question;switch(e.questionType){case"multiple":for(var o=0;o<e.possibleAnswers.length;o++)s+='<input name="resourceMultipleChoice" type ="radio" id="answer_'+o+'" value="'+e.possibleAnswers[o]+'"><label for="answer_'+o+'">'+e.possibleAnswers[o]+"</label><br>";break;case"open":s='<textarea class="open-response" placeholder="Type your answer here..." maxlength="5000" autofocus>'+u.temporaryAnswer+'</textarea></form><p class="privacy-message">Your answer will be private by default. You can later choose to make it public to earn special seeds.</p>';break;case"truefalse":s='<input name="resourceMultipleChoice" type="radio" id="true" value="true"><label for="true">true</label><br><input name="resourceMultipleChoice" type="radio" id="false" value="false"><label for="false">false</label>';break;case"yesno":s='<input name="resourceMultipleChoice" type="radio" id="yes" value="yes"><label for="yes">yes</label><br><input name="resourceMultipleChoice" type="radio" id="no" value="no"><label for="no">no</label>';break;default:s="Whoops! The game tried to set up a type of question that doesnt exist!"}r.innerHTML=s},loadRewards:function(e){var t=document.getElementById("resource-area").querySelector(".resource-content"),n=$game.$npc.getNpc(e.index),r=n.level,i=$game.$player.currentLevel,s=e.feedbackRight.length<1?"Thanks for sharing.":e.feedbackRight,o="",a=$game.$skins.getSkin(e.skinSuit);r<i?o=s+" Here, take "+u.seedsToAdd+" seeds!":(u.loadTangram(e),o=s+" Here, take this puzzle piece, and "+u.seedsToAdd+" seeds!"),a&&(o+=" You unlocked the "+a.name+" suit! Try it on or browse your other suits by clicking the changing room button below."),$game.$audio.playTriggerFx("resourceRight"),t.querySelector(".speaker").textContent=n.name,t.querySelector(".message").textContent=o},loadResponses:function(e){var t=document.getElementById("resource-area").querySelector(".resource-responses"),n=$game.$player.getAnswer(e.index),r=!1,i="",s="",o=$game.$npc.getNpc(e.index),u="";for(var a=0;a<e.playerAnswers.length;a++){var f=e.playerAnswers[a];f.id===$game.$player.id?r=!0:s+='<li class="response"><p><span>'+f.name+": </span>"+f.answer+'</p><div class="pledge-button"><button class="btn btn-success" data-npc="'+e.index+'" data-player="'+f.id+'">Seed It!</button></div></li>'}s!==""?u="Here are some recent answers by your peers.":(r?u="Your answer is shown below, but other players have not made their answers public.":u="There are no public answers. If you make your answer public, other players can give you more seeds!",s='<li class="response response-notice"><p>More answers from your peers will appear shortly.  Be sure to check back.</p></li>'),i+='<li class="response your-response"><p><span>You said: </span>'+n.answers[n.answers.length-1]+"</p>",r?i+='<div class="private-button"><button class="btn btn-info" data-npc="'+e.index+'">Make Private</button> <i class="fa fa-unlock-alt fa-lg"></i></div>':i+='<div class="public-button"><button class="btn btn-info" data-npc="'+e.index+'">Make Public</button> <i class="fa fa-lock fa-lg"></i></div>',i+="</li>",t.querySelector(".question").innerHTML="Q: "+e.question,t.querySelector(".content-box ul").innerHTML=i+s,t.querySelector(".speaker").textContent=o.name,t.querySelector(".message").textContent=u},addContent:function(e,t,n){function m(t,n,i,s){var a=r.querySelector(".buttons"),f=a.querySelector(".back-button"),l=a.querySelector(".next-button"),h=a.querySelector(".answer-button"),p=a.querySelector(".save-button"),d=a.querySelector(".close-button");switch(t){case"next":l.style.display="inline-block",l.addEventListener("click",function(){typeof s=="function"&&s(),u.addContent(e,n,i)});break;case"back":f.style.display="inline-block",f.addEventListener("click",function(){typeof s=="function"&&s(),u.addContent(e,n,i)});break;case"answer":h.style.display="inline-block",h.addEventListener("click",function(){typeof s=="function"&&s();if(c.questionType==="open"&&u.validateOpenResponse(c)!==!0)return;u.checkAnswer(c)===!0?(u.submitAnswer(c,!0),u.addContent(e,3)):(u.submitAnswer(c,!1),u.showFeedbackWrong(c))});break;case"save":p.style.display="inline-block",p.addEventListener("click",function(){typeof s=="function"&&s();if(u.validateTagline(c)!==!0)return;n?u.addContent(e,n):o.hideResource()});break;case"close":d.style.display="inline-block",d.addEventListener("click",function(){o.hideResource(s)});break;default:$game.debug("Warning: the game attempted to add a button a resource that does not exist.")}return!0}var r=document.getElementById("resource-area"),i=$game.$player.getLevel(),a=$game.$player.getAnswer(e),f=a?!0:!1,l=a&&a.result?!0:!1,c=s[e],h=$("#resource-stage .pages > section"),p=h.length;u.resetSlides(),u.resetButtons();switch(t){case 1:n||(n=0),(n<0||n===p)&&this.addContent("next",4);var d=h.get(n).innerHTML;$(".resource-article").html(d).show(),n<p-1?m("next",1,n+1):n===p-1&&(l&&c.questionType==="open"?m("next",4):l?m("close"):m("next",2)),n>0&&m("back",1,n-1);break;case 2:u.loadQuestion(c),r.querySelector(".resource-question").style.display="block",m("answer"),m("back",1,p-1,function(){c.questionType==="open"&&(u.temporaryAnswer=r.querySelector(".open-response").value)});break;case 3:var v=r.querySelector(".tagline-input input");r.querySelector(".resource-content").style.display="block",u.loadRewards(c),v.value="",v.focus(),$("#resource-area a.close-overlay").on("click.onCloseCheck",function(e){e.stopImmediatePropagation();if(u.validateTagline(c)!==!0)return;$(this).off("click.onCloseCheck")}),c.questionType==="open"?m("save",4):m("save");break;case 4:u.loadResponses(c),r.querySelector(".resource-responses").style.display="block",m("close");break;default:o.hideResource(function(){$game.debug("Error Code 4992 dump!"),console.log(e),console.log(c),console.log(t),console.log(n),$game.$npc.showSpeechBubble("Error Code 4992",["The game failed to provide a slide to display, or tried to display a slide that doesnt exist. See console for log details."])})}},validateTagline:function(e){function r(){t.focus()}var t=document.getElementById("resource-area").querySelector(".tagline-input input"),n=t.value.trim();return n.length===0?(o.showCheckMessage("You should create a custom tagline!",r),!1):($game.$player.setTagline(e,n),!0)},validateOpenResponse:function(e){function n(){document.querySelector(".open-response").focus()}var t=this.getAnswer(e);return t.length===0?(o.showCheckMessage("Please answer the question!",n),!1):e.requiredLength&&t.length<e.requiredLength?(u.popupCheck(e,n),!1):!0},popupCheck:function(e,t){var n=$("#resource-area .check");n.find(".check-dialog").hide(),n.find(".confirm-skimpy").show(),n.find(".sure-button").on("click",function(){o.hideCheckMessage(),u.submitAnswer(e,!0);var t=$("#resource-stage .pages > section").length;u.addContent(e.index,3)}).show(),n.find(".retry-button").on("click",function(){o.hideCheckMessage(t)}).show(),n.fadeIn(200)},checkAnswer:function(e){var t=this.getAnswer(e);return e.questionType==="open"?!0:t===e.answer?!0:!1},getAnswer:function(e){return e.questionType==="open"?document.getElementById("resource-area").querySelector(".open-response").value.trim():$("input[name=resourceMultipleChoice]:checked").val()},submitAnswer:function(e,t){var n=this.getAnswer(e),r=$game.$npc.getNpc(e.index).level,i=0,s={index:e.index,answer:n,npcLevel:r,questionType:e.questionType};t===!0?(s.correct=!0,s.skinSuit=e.skinSuit,i=$game.$player.answerResource(s),(e.questionType==="truefalse"||e.questionType==="yesno")&&i<5&&i>2&&(i=2),$game.$player.saveAnswer(e,s)):t===!1?(s.correct=!1,i=$game.$player.answerResource(s),$game.$player.saveAnswer(e,s)):$game.debug("Warning: an answer was submitted via _resources.submitAnswer() without indicating whether it is correct or incorrect."),u.seedsToAdd=i},showFeedbackWrong:function(e){var t=$game.$npc.getNpc(e.index).name,n=e.feedbackWrong;o.hideResource(function(){$game.$audio.playTriggerFx("resourceWrong"),$game.$npc.showSpeechBubble(t,n)})},shapes:[{correct1:{path:"m0,0l0,70l80,0l0,-70l-80,0z",fill:"lightGreen"},wrong1:{path:"m0,0l50,-50l50,50l-50,50l-50,-50z",fill:"blue"},wrong2:{path:"m0,0l0,-90l60,0l0,-50l-140,0l0,140l80,0z",fill:"lightBlue"},correct2:{path:"m0,0l-50,50l50,50l0,-100z",fill:"orange"},wrong3:{path:"m0,0c0,0 60,0 60,0c0,0 0,-50 0,-50c0,0 -60,0 -60,0c0,0 0,50 0,50z",fill:"orange"},correct3:{path:"m0,0l-100,0l0,50l60,0l0,20l80,0l0,-20l60,0l0,-50l-100,0z",fill:"green"},wrong4:{path:"m0,0l0,100l-50,-50l50,-50z",fill:"lightOrange"},wrong5:{path:"m0,0l0,-50l200,0l0,50l-200,0z",fill:"green"},wrong6:{path:"m0,0l80,0l0,90l-80,0l0,-90z",fill:"lightGreen"},correct4:{path:"m0,0l0,100l50,-50l-50,-50z",fill:"lightOrange"}},{correct1:{path:"m0,0l-60,0l0,120l-40,0l0,-160l140,0l0,160l-40,0l0,-120z",fill:"green"},wrong1:{path:"m0,0l0,-80l-170,0l-10,0l0,200l120,0l0,-120l60,0z",fill:"orange"},wrong2:{path:"m0,0c0,0 0,-200 0,-200c0,0 -120,0 -120,0c0,0 0,200 0,200c0,0 120,0 120,0z",fill:"lightOrange"},wrong3:{path:"m0,0l100,-40l100,0l100,40l-300,0z",fill:"green"},wrong4:{path:"m0,0l100,0l0,-40l-50,-40l-50,40l0,40z",fill:"lightGreen"},wrong5:{path:"m0,0l150,0l0,-120l-50,40l0,30l0,10l-100,40z",fill:"blue"},wrong6:{path:"m0,0c0,0 0,110 0,110c0,0 0,10 0,10c0,0 150,0 150,0c0,0 -100,-40 -100,-40c0,0 0,-40 0,-40c0,0 -50,-40 -50,-40z",fill:"lightBlue"},correct2:{path:"m0,0l300,0l-100,-40l-100,0l-100,40z",fill:"lightOrange"},correct3:{path:"m0,0c0,0 0,-200 0,-200c0,0 150,0 150,0c0,0 0,40 0,40c0,0 -70,0 -70,0c0,0 0,160 0,160c0,0 -80,0 -80,0z",fill:"lightGreen"},wrong7:{path:"m0,0l0,-200l150,0l0,40l-70,0l0,160l-80,0z",fill:"orange"},correct4:{path:"m0,0l0,-200l-150,0l0,40l70,0l0,160l80,0z",fill:"blue"},wrong8:{path:"m0,0l0,-200l-150,0l0,40l70,0l0,160l80,0z",fill:"lightOrange"},correct5:{path:"m0,0l100,0c0,0 0,-40 0,-40c0,0 -50,-40 -50,-40c0,0 -50,40 -50,40c0,0 0,40 0,40z",fill:"orange"},wrong9:{path:"m0,0l0,-160l-140,0l0,160l40,0l0,-120l60,0l0,120l40,0z",fill:"blue"}},{correct1:{path:"m0,0c0,0 0,-30 0,-30c0,0 70,0 70,0c0,0 0,30 0,30c0,0 -20,0 -20,0c0,0 0,-10 0,-10c0,0 -30,0 -30,0c0,0 0,10 0,10c0,0 -20,0 -20,0z",fill:"orange"},correct2:{path:"m0,0l-20,20l-20,40l0,110l100,0l0,-70l-60,0l0,-100z",fill:"lightOrange"},correct3:{path:"m0,0l0,-60l300,0l10,20l0,40l-310,0z",fill:"green"},correct4:{path:"m0,0l0,70c0,0 100,0 100,0c0,0 0,-70 0,-70c0,0 -100,0 -100,0z",fill:"lightGreen"},correct5:{path:"m0,0l0,-70l150,0l0,70l-150,0z",fill:"lightBlue"},wrong1:{path:"m0,0l20,0l0,-10l30,0l0,10l20,0l0,-30l-70,0l0,30z",fill:"blue"},wrong2:{path:"m0,0l0,60l260,0l-20,-40l-20,-20l-220,0z",fill:"lightOrange"},correct6:{path:"m0,0l0,40l300,0l-10,-20l-20,-20l-270,0z",fill:"blue"},wrong3:{path:"m0,0l90,0l0,-60l-50,0l-20,20l-20,40z",fill:"green"}},{correct1:{path:"m0,0l-120,0l0,40l240,0c0,0 0,-40 0,-40c0,0 -120,0 -120,0z",fill:"orange"},wrong1:{path:"m0,0l0,-40l240,0l0,40l-240,0z",fill:"blue"},wrong2:{path:"m0,0l80,0l0,-90l-100,0l20,90z",fill:"lightOrange"},correct2:{path:"m0,0l-60,0l-40,-180l100,0l-60,60l40,0l20,50l0,70z",fill:"lightGreen"},wrong3:{path:"m0,0l-100,0l0,90l80,0l20,-90z",fill:"green"},wrong4:{path:"m0,0l-20,-90l160,0l-20,90l-120,0z",fill:"lightGreen"},correct3:{path:"m0,0l100,0l-40,180l-60,0l0,-70l20,-50l40,0l-60,-60z",fill:"blue"},correct4:{path:"m0,0l60,60l-40,0l-20,-20l-20,20l-40,0l60,-60z",fill:"lightOrange"},wrong5:{path:"m0,0l120,0l0,220l-60,0l-40,-180l-20,0l0,-40z",fill:"orange"},correct5:{path:"m0,0l20,20l-20,50l-20,-50l20,-20z",fill:"green"}}]}});require.define("/robot.js",function(e,t,n,r,i){var s=[{x:0,y:14},{x:113,y:27},{x:113,y:79},{x:0,y:79},{x:0,y:0},{x:0,y:0}],o=[{x:7,y:20,d:-1,target:-3},{x:137,y:33,d:1,target:145},{x:137,y:124,d:1,target:145},{x:7,y:84,d:-1,target:-3},{x:0,y:0,d:0,target:0},{x:0,y:0,d:0,target:0}],u=null,a=null,f=!1,l=!1;$game.$robot={ready:!1,active:!1,currentStep:0,numSteps:16,counter:Math.floor(Math.random()*64),curFrame:0,numFrames:4,isMoving:!1,init:function(e){$game.bossModeUnlocked?e():(u={x:0,y:0},a={kind:"robot",prevX:0,prevY:0,curX:0,curY:0,srcX:0,srcY:0},$game.$player.seenRobot||$game.$robot.setPosition(),e())},resetInit:function(){u=null,a=null,f=!1,l=!1,$game.$robot.ready=!1,$game.$robot.active=!1,$game.$robot.currentStep=0,$game.$robot.counter=Math.floor(Math.random()*64),$game.$robot.curFrame=0,$game.$robot.isMoving=!1},setPosition:function(){u=o[$game.$player.currentLevel],u.offX=0,u.offY=0,u.prevOffX=0,u.prevOffY=0,a.dir=o[$game.$player.currentLevel].d,$game.$robot.isMoving=!1,$game.$robot.active=!0,$game.$robot.counter=Math.floor(Math.random()*64),$game.$robot.curFrame=0,$game.$robot.currentStep=0,a.dir===-1?a.srcY=0:a.srcY=64},update:function(){if($game.$robot.active)if(f)l?$game.$robot.move():$game.$robot.idleCheckTrigger();else{var e=$game.$map.masterToLocal(u.x,u.y);e&&(f=!0)}},updateRenderInfo:function(){var e=$game.$map.masterToLocal(u.x,u.y,!0);if(e){var t=e.x*$game.TILE_SIZE+u.prevOffX*$game.STEP_PIXELS/2,n=e.y*$game.TILE_SIZE+u.prevOffY*$game.STEP_PIXELS/2,r=e.x*$game.TILE_SIZE+u.offX*$game.STEP_PIXELS/2,i=e.y*$game.TILE_SIZE+u.offY*$game.STEP_PIXELS/2;a.prevX=t,a.prevY=n,a.curX=r,a.curY=i,$game.$robot.isMoving?a.dir===-1?a.srcY=0:a.srcY=64:a.dir===-1?a.srcY=128:a.srcY=192}},idleCheckTrigger:function(){$game.$robot.currentStep++,$game.$robot.currentStep%8===0&&($game.$robot.currentStep>$game.$robot.numSteps&&($game.$robot.currentStep=0),$game.$robot.curFrame++,$game.$robot.curFrame===$game.$robot.numFrames&&($game.$robot.curFrame=0),a.srcX=$game.TILE_SIZE*$game.$robot.curFrame*2),$game.$robot.updateRenderInfo();var e=$game.$player.getPosition(),t=Math.abs(e.x-(u.x+1)),n=Math.abs(e.y-u.y);if(t+n<6){l=!0,$game.$audio.playTriggerFx("robot"),$game.statusUpdate({message:"You just saw a strange robot!",input:"status",screen:!0,log:!0}),$game.$player.seenRobot=!0,$game.$robot.isMoving=!0,$game.$robot.currentStep=0,$game.$robot.counter=0,$game.$robot.curFrame=0;var r={id:$game.$player.id,seenRobot:$game.$player.seenRobot};ss.rpc("game.player.updateGameInfo",r)}},move:function(){f&&($game.$robot.currentStep>=$game.$robot.numSteps&&($game.$robot.currentStep=0,u.x+=u.d),u.x===u.target?(f=!1,$game.$robot.active=!1):($game.$robot.currentStep+=1,$game.$robot.currentStep===1?($game.$robot.currentStepIncX=u.d,$game.$robot.currentStepIncY=0,u.prevOffX=0,u.prevOffY=0):(u.prevOffX=u.offX,u.prevOffY=u.offY,$game.$robot.currentStep%4===0&&(a.srcX=$game.TILE_SIZE*($game.$robot.currentStep/4)*2-64)),u.offX=$game.$robot.currentStep*$game.$robot.currentStepIncX,u.offY=$game.$robot.currentStep*$game.$robot.currentStepIncY,$game.$robot.updateRenderInfo()))},clear:function(){$game.$renderer.clearRobot(a)},getRenderInfo:function(){return f?a:!1},getLoc:function(){return s[$game.$player.currentLevel]},disable:function(){f=!1}}});require.define("/skins.js",function(e,t,n,r,i){"use strict";var s=$game.$skins={ready:!1,data:{outfits:{basic:{id:"basic",name:"Default Look",description:"This is you. You look great!",effect:null,flag:null,head:{name:"Default Head",description:"Your beautiful face.",effect:null,flag:null},torso:{name:"Default Body",description:"Your heart is in here somewhere.",effect:null,flag:null},legs:{name:"Default Legs",description:"These legs are made for walking.",effect:null,flag:null}},tuxedo:{id:"tuxedo",name:"Tuxedo",description:"",effect:"",flag:"",head:{name:"Tuxedo Mask",description:"",effect:"",flag:""},torso:{name:"Tuxedo Jacket",description:"",effect:"",flag:""},legs:{name:"Tuxedo Pants",description:"",effect:"",flag:""}},lion:{id:"lion",name:"Lion",description:"",effect:"",flag:"",head:{name:"Lion Head",description:"",effect:"",flag:""},torso:{name:"Lion Body",description:"",effect:"",flag:""},legs:{name:"Lion Legs",description:"",effect:"",flag:""}},cactus:{id:"cactus",name:"Cactus",description:"",effect:"",flag:"",head:{name:"Cactus Head",description:"",effect:"",flag:""},torso:{name:"Cactus Body",description:"",effect:"",flag:""},legs:{name:"Cactus Legs",description:"",effect:"",flag:""}},cone:{id:"cone",name:"Ice Cream Cone",description:"You look delicious.",effect:"",flag:"",head:{name:"Strawberry Scoop",description:"",effect:"",flag:""},torso:{name:"Sugar Cone Top",description:"",effect:"",flag:""},legs:{name:"Sugar Cone Bottom",description:"",effect:"",flag:""}},astronaut:{id:"astronaut",name:"Astronaut",description:"This allows you to explore in space.",effect:"",flag:"",head:{name:"Space Helmet",description:"",effect:"",flag:""},torso:{name:"Space Suit",description:"",effect:"",flag:""},legs:{name:"Space Pants",description:"",effect:"",flag:""}},ninja:{id:"ninja",name:"Ninja",description:"A shady ninja costume.",effect:"",flag:"",head:{name:"Ninja Mask",description:"",effect:"",flag:""},torso:{name:"Ninja Gi",description:"",effect:"",flag:""},legs:{name:"Ninja Pants",description:"",effect:"",flag:""}},horse:{id:"horse",name:"Horse",description:"Youre a horse!",effect:"You walk a lot faster!",flag:"",head:{name:"Horse Head",description:"",effect:"You walk slightly faster.",flag:"horse-head"},torso:{name:"Horse Body",description:"",effect:"You walk slightly faster.",flag:""},legs:{name:"Horse Legs",description:"",effect:"You walk slightly faster.",flag:""}},penguin:{id:"penguin",name:"Penguin",description:"",effect:"",flag:"",head:{name:"Penguin Head",description:"",effect:"",flag:""},torso:{name:"Penguin Suit",description:"",effect:"",flag:""},legs:{name:"Penguin Feet",description:"",effect:"",flag:""}},dinosaur:{id:"dinosaur",name:"Dinosaur",description:"",effect:"",flag:"",head:{name:"Dinosaur Head",description:"",effect:"",flag:""},torso:{name:"Dinosaur Body",description:"",effect:"",flag:""},legs:{name:"Dinosaur Legs",description:"",effect:"",flag:""}},octopus:{id:"octopus",name:"Octopus",description:"",effect:"Your paint radius goes up by three.",flag:"",head:{name:"Octopus Head",description:"",effect:"Your paint radius goes up by one.",flag:""},torso:{name:"Octopus Body",description:"",effect:"Your paint radius goes up by one.",flag:""},legs:{name:"Eight Legs",description:"",effect:"Your paint radius goes up by one.",flag:""}},hunter:{id:"hunter",name:"Forest Hunter",description:"You stalk the forest like the lion ninja you are.",effect:"You can teleport to the forest! Just chat FOREST (all caps)",flag:"teleport-forest",parts:{head:"lion",torso:"ninja",legs:"ninja"}},mariner:{id:"mariner",name:"Sub-Mariner",description:"You are at home in aquatic environments.",effect:"You can teleport to the port! Just chat PORT (all caps)",flag:"teleport-port",parts:{head:"penguin",torso:"ninja",legs:"ninja"}},rancher:{id:"rancher",name:"Ranch Ronin",description:"The stealth cactus could be anywhere.",effect:"You can teleport to the ranch! Just chat RANCH (all caps)",flag:"teleport-ranch",parts:{head:"cactus",torso:"ninja",legs:"ninja"}},mayor:{id:"mayor",name:"Ninja Mayor",description:"Youre the king or queen of town.",effect:"You can teleport to Calliope Town Square! Just chat TOWN (all caps)",flag:"teleport-town",parts:{head:"tuxedo",torso:"ninja",legs:"ninja"}},sprinkle:{id:"sprinkle",name:"Sprinklesaurus Rex",description:"A cold-blooded cone with extra sprinkles.",effect:"You gain 10 paintbrush seeds every time you click Seed it! on a friends response.",flag:"pledge-reward",parts:{head:"dinosaur",torso:"cone",legs:"cone"}}}},init:function(){},resetInit:function(){},getSetsList:function(){var e=s.data.outfits,t=[];for(var n in e)e[n].parts||t.push(e[n].id);return t},getSets:function(){var e=s.data.outfits;return _.filter(e,function(e){return!e.parts})},getSkin:function(e){return _.find($game.$skins.getSets(),function(t){return t.id===e})},unlockSkin:function(e,t){var n=$game.$player.getSkinSuit();t!==undefined?(n.unlocked[t].push(e),$game.addBadgeCount(".skinventoryButton",1)):(n.unlocked.head.push(e),n.unlocked.torso.push(e),n.unlocked.legs.push(e),$game.addBadgeCount(".skinventoryButton",3)),s.updateSkinventory(e),o.updatePlayer(n)},updateSkinventory:function(e){var t=$('.head [data-name="'+e+'"]'),n=$('.torso [data-name="'+e+'"]'),r=$('.legs [data-name="'+e+'"]');o.renderUnlockedPart(t,e,"head",!0),o.renderUnlockedPart(n,e,"torso",!0),o.renderUnlockedPart(r,e,"legs",!0)},resetSkinventory:function(){var e=$game.$player.getSkinSuit();e.unlocked.head=["basic"],e.unlocked.torso=["basic"],e.unlocked.legs=["basic"],$game.$player.setSkinSuit("basic"),s.renderSkinventory(),s.updateSkinventory("basic"),o.updatePlayer(e)},renderSkinventory:function(){function r(n,r){var i='<div class="outer locked" data-name="'+n.id+'" title="(locked)" data-placement="bottom"><div class="inner"><i class="fa fa-lock"></i></div><div class="badge-new"><i class="fa fa-star"></i></div></div>',s=$("."+r),u=$(i);s.append(u),n.id===e[r]&&u.addClass("equipped");for(var a=0;a<t[r].length;a++)if(t[r][a]===n.id){o.renderUnlockedPart(u,n,r);break}u.on("mouseenter",function(){$(this).tooltip("show")}),u.on("click",function(){$(this).find(".badge-new:visible").hide()})}var e=$game.$player.getSkinSuit(),t=e.unlocked,n=this.getSets();$(".skinventory .head").empty(),$(".skinventory .torso").empty(),$(".skinventory .legs").empty();for(var i in n)r(n[i],"head"),r(n[i],"torso"),r(n[i],"legs");s.renderSkinformation()},renderSkinformation:function(){function a(e,n){var r="<strong>"+t[e][n].name+".</strong>";return t[e][n].description&&(r+=" "+t[e][n].description),t[e][n].effect&&(r+=' <span class="color-orange">Effect:</span> <span class="color-blue">'+t[e][n].effect+"</span>"),t[e][n].flag&&$game.$player.setFlag(t[e][n].flag),r}var e=$game.$player.getSkinSuit(),t=s.data.outfits,n=e.head,r=e.torso,i=e.legs,u="",f=o.getOutfit(n,r,i);o.clearSkinFlags(),f?(u+="<strong>"+f.name+"</strong><br>"+f.description,f.effect&&(u+='<br><strong><span class="color-orange">Outfit bonus:</span> <span class="color-blue">'+f.effect+"</span></strong>"),f.flag&&$game.$player.setFlag(f.flag)):(u+=a(n,"head"),u+="<br>"+a(r,"torso"),u+="<br>"+a(i,"legs")),$(".skinformation p").html(u)}},o={clearSkinFlags:function(){var e=s.data.outfits,t=_.pluck(e,"flag"),n=_.chain(e).map(function(e,t,n){if(n[t].head)return[n[t].head.flag,n[t].torso.flag,n[t].legs.flag]}).flatten().compact().value(),r=_.compact(_.union(t,n));_.each(r,$game.$player.removeFlag)},getOutfit:function(e,t,n){var r=s.data.outfits;if(e===t&&t===n)return r[e];var i={head:e,torso:t,legs:n};return _.find(r,function(e){return _.isEqual(e.parts,i)})},renderUnlockedPart:function(e,t,n,r){typeof t=="string"&&(t=s.data.outfits[t]);var i=e.find(".inner"),o=CivicSeed.CLOUD_PATH+"/img/game/skins/"+t.id+".png";e.removeClass("locked"),e.attr("title",t[n].name),i.css("backgroundImage","url("+o+")"),i.find("i").remove(),i.html(""),r===!0&&e.find(".badge-new").show()},updatePlayer:function(e){ss.rpc("game.player.updateGameInfo",{id:$game.$player.id,skinSuit:e})}}});require.define("/civicseed-engine.js",function(e,t,n,r,i){var s=t.exports={init:function(){CivicSeed.initialized||(window.$WINDOW=$(window),window.$HTML=$("html"),window.$BODY=$(document.body),window.$CONTAINER=$("#container"),window.$game=e("/game"),s.setupRouter(),e("/account").accountHandlers(),CivicSeed.initialized=!0)},setupRouter:function(){var t;Davis(function(){t=this,e("/routes-middleware.js").loadMiddleware(t),e("/routes-main").loadRoutes(t),e("/routes-account").loadRoutes(t),e("/routes-admin").loadRoutes(t),e("/routes-profile").loadRoutes(t),e("/routes-errors").loadRoutes(t),t.configure(function(e){e.generateRequestOnPageLoad=!0}),t.start()})}}});require.define("/entry.js",function(e,t,n,r,i){window.ss=e("socketstream"),ss.server.on("ready",function(){$(function(){e("/civicseed-engine").init()})}),ss.server.on("disconnect",function(){CivicSeed.ENVIRONMENT==="production"?CivicSeed.CONNECTED&&sessionStorage.getItem("userId")&&(CivicSeed.CONNECTED=!1,$game.running=!1,$game.$audio&&$game.$audio.stopAll(),sessionStorage.clear(),Davis.location.assign("/"),$(".appriseOverlay").remove(),$(".appriseOuter").remove(),apprise("The server is experiencing connection problems, 				which means this session needs to be restarted. 				We are very sorry for the inconvenience. 				Please try reauthenticating the game in a few minutes. 				If you continue to experience problems, 				please contact the site administrator and report the problem.")):console.log("Lost connection to server...")}),ss.server.on("reconnect",function(){CivicSeed.ENVIRONMENT==="production"?(CivicSeed.CONNECTED=!0,sessionStorage.clear(),Davis.location.assign("/"),$(".appriseOverlay").remove(),$(".appriseOuter").remove(),apprise("The Server has been restarted. 			We are very sorry for the inconvenience. 			Please try reauthenticating. 			If you continue to experience problems, 			please contact the site administrator and report the problem.")):console.log("Connection to server...")})});require('events-responder')(0, {}, require('socketstream').send(0)); require('socketstream-rpc')(1, {}, require('socketstream').send(1)); require('socketstream').assignTransport({}); require('/entry');